<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Emily Zhao">

<title>Text as Data: Problem Set 01</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="problem_set_01_files/libs/clipboard/clipboard.min.js"></script>
<script src="problem_set_01_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="problem_set_01_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="problem_set_01_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="problem_set_01_files/libs/quarto-html/popper.min.js"></script>
<script src="problem_set_01_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="problem_set_01_files/libs/quarto-html/anchor.min.js"></script>
<link href="problem_set_01_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="problem_set_01_files/libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="problem_set_01_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="problem_set_01_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="problem_set_01_files/libs/bootstrap/bootstrap-d6a003b94517c951b2d65075d42fb01b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#instructions" id="toc-instructions" class="nav-link active" data-scroll-target="#instructions">Instructions</a></li>
  <li><a href="#question-1" id="toc-question-1" class="nav-link" data-scroll-target="#question-1">Question 1</a></li>
  <li><a href="#question-2" id="toc-question-2" class="nav-link" data-scroll-target="#question-2">Question 2</a></li>
  <li><a href="#question-3" id="toc-question-3" class="nav-link" data-scroll-target="#question-3">Question 3</a></li>
  <li><a href="#question-4" id="toc-question-4" class="nav-link" data-scroll-target="#question-4">Question 4</a></li>
  <li><a href="#question-5" id="toc-question-5" class="nav-link" data-scroll-target="#question-5">Question 5</a>
  <ul class="collapse">
  <li><a href="#sentiment-analysis-visualizations" id="toc-sentiment-analysis-visualizations" class="nav-link" data-scroll-target="#sentiment-analysis-visualizations"><strong>Sentiment Analysis Visualizations</strong></a></li>
  </ul></li>
  <li><a href="#question-5-results-summary-i-can-only-run-the-cell-in-a-standalone-r-session" id="toc-question-5-results-summary-i-can-only-run-the-cell-in-a-standalone-r-session" class="nav-link" data-scroll-target="#question-5-results-summary-i-can-only-run-the-cell-in-a-standalone-r-session"><strong>Question 5 Results Summary (I can only run the cell in a Standalone R session)</strong></a></li>
  <li><a href="#combined-analysis-summary" id="toc-combined-analysis-summary" class="nav-link" data-scroll-target="#combined-analysis-summary"><strong>Combined Analysis Summary</strong></a></li>
  <li><a href="#question-6" id="toc-question-6" class="nav-link" data-scroll-target="#question-6">Question 6</a>
  <ul class="collapse">
  <li><a href="#question-6.1" id="toc-question-6.1" class="nav-link" data-scroll-target="#question-6.1">Question 6.1</a></li>
  <li><a href="#question-6.2" id="toc-question-6.2" class="nav-link" data-scroll-target="#question-6.2">Question 6.2</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Text as Data: Problem Set 01</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Emily Zhao </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="instructions" class="level2">
<h2 class="anchored" data-anchor-id="instructions">Instructions</h2>
<p>To complete this homework, you have two options.</p>
<p>You can either complete this assignment using a <strong>dataset of your choice</strong>. This is a great opportunity for you to start working with a dataset that you can potentially use for your final project.</p>
<p>Your second option is to this dataset of social media posts from political candidates running for Congress during the 2022 U.S. Midterm election.</p>
<p>You can download the dataset <a href="https://www.dropbox.com/scl/fi/jz14130dlzj5xvca9txj4/midterm_candidates_labeled_all_May05.csv?rlkey=b0m1h6kk1af3uz9tjqyelthh3&amp;dl=0">here</a></p>
<p>To know more about the dataset, read and cite this paper: <a href="https://journals.sagepub.com/doi/full/10.1177/20563051251337541" class="uri">https://journals.sagepub.com/doi/full/10.1177/20563051251337541</a></p>
<p>If you want say thanks to the people who collected and shared this data with us for this class, please send a email to my colleague <a href="https://maggiegmacdonald.com/">Maggie MacDonald</a></p>
<p><strong>IMPORTANT:</strong> Remember to NOT commit your data to github. Github does not allow you to push large datasets to remote repositories. If you commit your dataset, you will need to reset your commit, and that’s always a bit of work. In addition, remember that your notebook should be compiled with the results of the code blocks.</p>
</section>
<section id="question-1" class="level2">
<h2 class="anchored" data-anchor-id="question-1">Question 1</h2>
<p>Take a small a sample of your documents and read them carefully. This sample doesn’t need to be random. Select cases that are more interesting, and close to your theoretical interest in this dataset. What are you thoughts about these documents? What did you learn after reading them?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>terms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"inflation"</span>,<span class="st">"economy"</span>,<span class="st">"jobs"</span>,<span class="st">"crime"</span>,<span class="st">"abortion"</span>,<span class="st">"immigration"</span>,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">"border"</span>,<span class="st">"climate"</span>,<span class="st">"guns"</span>,<span class="st">"healthcare"</span>,<span class="st">"tax"</span>,<span class="st">"education"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(text)) <span class="sc">%&gt;%</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(stringr<span class="sc">::</span><span class="fu">str_detect</span>(stringr<span class="sc">::</span><span class="fu">str_to_lower</span>(text),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                                    stringr<span class="sc">::</span><span class="fu">str_c</span>(terms, <span class="at">collapse =</span> <span class="st">"|"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(party_clean, created_at, username, text)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 x 4
   party_clean created_at username        text                                  
   &lt;chr&gt;       &lt;date&gt;     &lt;chr&gt;           &lt;chr&gt;                                 
 1 Republican  2022-10-13 grassleyworks   "\U0001f6a8Inflation today \u21928.2%~
 2 Republican  2022-10-29 alexisjohnsonnm ".@TeresaForNM, we need 87,000 new Bo~
 3 Democratic  2022-10-31 wildforcongress "I\u2019m proud that @steelworkers en~
 4 Republican  2022-11-09 latta4congress  "This is your LAST CHANCE to vote to ~
 5 Democratic  2022-11-03 wildforcongress "Representing #PA07 has been the hono~
 6 Democratic  2022-10-17 huffmanfornc    "Fact:\r\n\r\n@RepDanBishop Voted aga~
 7 Democratic  2022-10-18 tammyduckworth  "Unlike Kathy Salvi, my answer on abo~
 8 Democratic  2022-10-29 liraforcongress "While Republicans dream of recession~
 9 Republican  2022-10-21 nmalliotakis    "Staten Island has seen an 85% increa~
10 Republican  2022-10-27 miller_congress "We miss PRESIDENT TRUMP and the Amer~
# i 20 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, let's create the sample data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>terms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"inflation"</span>,<span class="st">"economy"</span>,<span class="st">"jobs"</span>,<span class="st">"crime"</span>,<span class="st">"abortion"</span>,<span class="st">"immigration"</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"border"</span>,<span class="st">"climate"</span>,<span class="st">"guns"</span>,<span class="st">"healthcare"</span>,<span class="st">"tax"</span>,<span class="st">"education"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>df_sample <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(text)) <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(stringr<span class="sc">::</span><span class="fu">str_detect</span>(stringr<span class="sc">::</span><span class="fu">str_to_lower</span>(text),</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                                    stringr<span class="sc">::</span><span class="fu">str_c</span>(terms, <span class="at">collapse =</span> <span class="st">"|"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">30</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Define column names</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>text_col <span class="ot">&lt;-</span> <span class="st">"text"</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>date_col <span class="ot">&lt;-</span> <span class="st">"created_at"</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>party_col <span class="ot">&lt;-</span> <span class="st">"party_clean"</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>author_col <span class="ot">&lt;-</span> <span class="st">"username"</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Now create the readable format</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>df_to_read <span class="ot">&lt;-</span> df_sample <span class="sc">|&gt;</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">transmute</span>(</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">party =</span> .data[[party_col]], </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.character</span>(.data[[date_col]]), </span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">author =</span> .data[[author_col]],</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">text_full =</span> stringr<span class="sc">::</span><span class="fu">str_squish</span>(.data[[text_col]]),</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">text_short =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(<span class="fu">nchar</span>(text_full) <span class="sc">&gt;</span> <span class="dv">280</span>,</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">paste0</span>(<span class="fu">substr</span>(text_full, <span class="dv">1</span>, <span class="dv">277</span>), <span class="st">"..."</span>),</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>                                text_full)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the short version in a table</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(df_to_read[, <span class="fu">c</span>(<span class="st">"party"</span>,<span class="st">"date"</span>,<span class="st">"author"</span>,<span class="st">"text_short"</span>)], <span class="at">format =</span> <span class="st">"html"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">party</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">date</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">author</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">text_short</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-11-17</td>
<td style="text-align: left;">lebrun4la</td>
<td style="text-align: left;">@BoydLinhart @Indivisible337 @shl870 @RepClayHiggins @CaptClayHiggins @FBI He hasn&lt;U+2019&gt;t made any progress in my view. He&lt;U+2019&gt;s a caricature. My community has not been improved and my previous home, #Calcasieu, is much worse off since he took office. We are still in bottom 5 in educat...</td>
</tr>
<tr class="even">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-11-01</td>
<td style="text-align: left;">snyderforin03</td>
<td style="text-align: left;">I am the ONLY candidate who promises to codify Roe into law. Banks does not need to be in the exam room making decisions about a woman's body + healthcare + future. @RepJimBanks said today he is "unapologetically" Pro-life with NO EXCEPTIONS. Not for rape or life of the woman....</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-10-27</td>
<td style="text-align: left;">rokhanna</td>
<td style="text-align: left;">Republicans want tax cuts for the rich. We are fighting for a living wage, universal child care, affordable housing, and free higher education. This is what's on the ballot in November.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-10-19</td>
<td style="text-align: left;">donjbacon</td>
<td style="text-align: left;">In less than 2 years, we went from the most secure border in US history to open borders. This is a humanitarian crisis with thousands of innocent women and children being trafficked daily. I implore the Biden Administration to restore order at the border! https://t.co/VbPkPNULWO</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-10-28</td>
<td style="text-align: left;">maggie_hassan</td>
<td style="text-align: left;">Big Oil continues to make record profits. Don Bolduc supports giving them *even more* tax breaks, while Granite Staters pay the price. https://t.co/sIBtyacOLs</td>
</tr>
<tr class="even">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-11-29</td>
<td style="text-align: left;">paul4uscongress</td>
<td style="text-align: left;">@MondaireJones @nytimes A better world is NOT possible if those in authority ignore the suffering of the people they have sworn to serve. Crime is real, not disinformation. Voters aren't as stupid as you and the @nytimes seem to think. They were not "fooled" into voting agains...</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-10-26</td>
<td style="text-align: left;">RepBethVanDuyne</td>
<td style="text-align: left;">&lt;U+201C&gt;Biden's border disaster: Americans deserve solutions, not excuses.&lt;U+201D&gt;I agree. That&lt;U+2019&gt;s why I introduced the Border Patrol First Act to put America first and prioritize funding for our southern border over those of other countries.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-10-21</td>
<td style="text-align: left;">mikeleeforutah</td>
<td style="text-align: left;">With your support, I&lt;U+2019&gt;ll help Republicans retake the Senate and put our economy back on track. Together, we can positively change the direction of the nation.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-10-05</td>
<td style="text-align: left;">melanie4nm</td>
<td style="text-align: left;">The #InflationReductionAct cuts health care premiums and caps prescription drug costs. Yet not a single House Republican voted for it.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-10-13</td>
<td style="text-align: left;">https://www.youtube.com/channel/UC6pKKC2SSr0sDT03DlvedXA</td>
<td style="text-align: left;">I think the top issues are inflation crime in the economy we've seen that repeatedly dating all the way back to the primary peacock touting Orland Park's low crime rate and budget cutting and his Defiance of Governor pritzker's pandemic shutdown he sued to reopen restaurants a...</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-11-06</td>
<td style="text-align: left;">jahanahayesct</td>
<td style="text-align: left;">Thanks for the assist @mrskurantowicz I wanted to make sure that was done SAFELY! Which is why I fought for 1.1B in education funds to allow @GovNedLamont and every school district to do just that. https://t.co/Daju1bf2CY https://t.co/H9y9k2HF9d https://t.co/raQEB12GxW</td>
</tr>
<tr class="even">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-10-07</td>
<td style="text-align: left;">guyciarrocchi</td>
<td style="text-align: left;">We are paying 81% more for our natural gas 2021-22 vs 2022-23. #Inflation is real. And it&lt;U+2019&gt;s stealing our paychecks and savings. #Theft https://t.co/S687pRi763</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-10-15</td>
<td style="text-align: left;">drwillboydjr</td>
<td style="text-align: left;">Supporting voter registration, education, &amp; mobilization, I traveled over five hundred miles today! I&lt;U+2019&gt;m truly thankful for all of the support my team &amp; I are receiving as we let voters know what&lt;U+2019&gt;s at stake &amp; on the ballot! #boydforalabama</td>
</tr>
<tr class="even">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-11-07</td>
<td style="text-align: left;">petestaubermn</td>
<td style="text-align: left;">As a 23-year police officer, law enforcement knows I will always have their backs. While others denigrate and disparage our police which has led to record low recruitment and record high crime, I am a steady voice for law and order and will continue ensuring we always provide ...</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-10-28</td>
<td style="text-align: left;">penny4congress</td>
<td style="text-align: left;">Building the economy on our reservations is vital!</td>
</tr>
<tr class="even">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-10-19</td>
<td style="text-align: left;">mgpforcongress</td>
<td style="text-align: left;">Our supply chain is stretched to a breaking point. I see the impact at our auto shop every day. The future of good jobs in #WA03 depends on whether we can breathe life back into American-made manufacturing with investments in career &amp;amp; technical education. https://t.co/YBfq...</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-10-17</td>
<td style="text-align: left;">crenshawforcongress</td>
<td style="text-align: left;">The &lt;U+201C&gt;Inflation Reduction Act&lt;U+201D&gt; hasn&lt;U+2019&gt;t done a single thing to reduce inflation. In fact, it&lt;U+2019&gt;s making it worse. Top think tanks such as the Heritage Foundation, Hoover Institution, and the Committee for a Responsible Budget all said the &lt;U+201C&gt;Inflation Reduction Act&lt;U+201D&gt; won&lt;U+2019&gt;t do a thing ...</td>
</tr>
<tr class="even">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-11-06</td>
<td style="text-align: left;">liraforcongress</td>
<td style="text-align: left;">It's easy to do interviews at the Border &amp;amp; scapegoat people seeking a better life. The 53 migrants who died in the back of a truck didn't come here w/drugs or weapons. We're being failed by an incumbent who cares more abt photo ops than real #immigrationreform. #NoMoreMemo...</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-10-26</td>
<td style="text-align: left;">pettersen4co</td>
<td style="text-align: left;">In this crisis moment where women &amp;amp; doctors are being threatened with life in prison for abortion care, we need leaders in Congress who will champion reproductive rights. Unlike my opponent, I codified these rights into law in CO &amp;amp; will continue that fight in DC #copol...</td>
</tr>
<tr class="even">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-10-06</td>
<td style="text-align: left;">maxmilleroh</td>
<td style="text-align: left;">Great to be out on the job site this morning with homebuilders! Inflation and high gas prices are crushing workers. We need to get back to drilling and our energy independence. Joe Biden&lt;U+2019&gt;s wake up call is coming on November 8th and it&lt;U+2019&gt;s to say we want to put America First! &lt;U+0001F1FA&gt;&lt;U+0001F1F8&gt; ...</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-10-12</td>
<td style="text-align: left;">mercedes4nevada</td>
<td style="text-align: left;">Let&lt;U+2019&gt;s do this! #votedemocrat #election2022 #vote #voters #nativevote #northernnevada #sparksnv #homemeansnevada #downtownreno #laketahoe #midtownreno #NVPol #EveryNativeVoteCounts #VoteIndigenous #DemocracyIsIndigenous #VotingOnNativeLand #NativeVotes #IndigenousRights #Votant...</td>
</tr>
<tr class="even">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-10-06</td>
<td style="text-align: left;">repasencio</td>
<td style="text-align: left;">#FL28, I ask for your #VOTE. Where US Rep C. Gimenez votes against women; lowering cost of med ins &amp;amp; insulin; corporate price gauging; &amp;amp; $$ for infrastructure, jobs creation, housing asst, reducing greenhouse gases, clean wafer, hurricane relief..I will not https://t.c...</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-11-05</td>
<td style="text-align: left;">patryanuc</td>
<td style="text-align: left;">Colin Schmitt believes he can make better healthcare decisions than Hudson Valley women. I don&lt;U+2019&gt;t.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-10-27</td>
<td style="text-align: left;">bbengs1970</td>
<td style="text-align: left;">From Business Insider &lt;U+201C&gt;companies are pocketing their fattest profits in 70 years, even as they complain about inflation.&lt;U+201D&gt; Commerce Department data shows corporate profit margins are at the greatest levels since the 1950&lt;U+2019&gt;s. The Iron Mountain CEO says &lt;U+201C&gt;he&lt;U+2019&gt;s been praying for infl...</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-10-11</td>
<td style="text-align: left;">robertjwittman</td>
<td style="text-align: left;">Stopped by Halls Supermarket in Colonial Beach to talk to voters about the rising costs of goods due to inflation. One thing is clear: it&lt;U+2019&gt;s time to take back the House and put an end to Biden&lt;U+2019&gt;s reckless agenda.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-10-28</td>
<td style="text-align: left;">larsenrick</td>
<td style="text-align: left;">These include the Invest to Protect Act to increase funding for local police departments&lt;U+2705&gt; the Break the Cycle of Violence Act to fund non-profit and community-based organizations that work to reduce crime&lt;U+2705&gt;&lt;U+2026&gt;</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-10-24</td>
<td style="text-align: left;">RepBrianMast</td>
<td style="text-align: left;">&lt;U+2B06&gt;&lt;U+FE0F&gt;98 individuals on the terrorist watchlist&lt;U+2B06&gt;&lt;U+FE0F&gt;14,000 pounds of fentanyl&lt;U+2B06&gt;&lt;U+FE0F&gt;600,000 &lt;U+201C&gt;got-aways&lt;U+201D&gt;Biden&lt;U+2019&gt;s open-border policies continue to break all the wrong records.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-10-28</td>
<td style="text-align: left;">jeremyshafferpa</td>
<td style="text-align: left;">Chris Deluzio is being delusional. If you want to see a radical position on abortion look at Chris. He believes in taxpayer funded abortion on demand up until the MOMENT OF BIRTH. That&lt;U+2019&gt;s out of touch with the vast majority of Americans #PA17Debate</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-11-03</td>
<td style="text-align: left;">gendonbolduc</td>
<td style="text-align: left;">.@WMUR9 #NHSEN debate: I've served on the Southern Border, &amp;amp; I have helped other countries secure their borders. What the Biden-Hassan Administration is doing is not a way to keep our Country safe &amp;amp; secure. Their priorities are out-of-touch. #VoteBolduc to secure our b...</td>
</tr>
<tr class="even">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-10-12</td>
<td style="text-align: left;">allawsonjr</td>
<td style="text-align: left;">Proud to earn the endorsement of Alliance for Retired Americans. Thank you for your confidence in me &amp;amp; for your support. In Congress, I voted to lower the cost of Rx prices &amp;amp; provide critical healthcare to veterans. My opponent voted against both of these bills.#FL02 #...</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List full texts below</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"• "</span>, df_to_read<span class="sc">$</span>text_full), <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;U+2022&gt; @BoydLinhart @Indivisible337 @shl870 @RepClayHiggins @CaptClayHiggins @FBI He hasn&lt;U+2019&gt;t made any progress in my view. He&lt;U+2019&gt;s a caricature. My community has not been improved and my previous home, #Calcasieu, is much worse off since he took office. We are still in bottom 5 in education, as well.

&lt;U+2022&gt; I am the ONLY candidate who promises to codify Roe into law. Banks does not need to be in the exam room making decisions about a woman's body + healthcare + future. @RepJimBanks said today he is "unapologetically" Pro-life with NO EXCEPTIONS. Not for rape or life of the woman. https://t.co/xk5ZoMqXjX

&lt;U+2022&gt; Republicans want tax cuts for the rich. We are fighting for a living wage, universal child care, affordable housing, and free higher education. This is what's on the ballot in November.

&lt;U+2022&gt; In less than 2 years, we went from the most secure border in US history to open borders. This is a humanitarian crisis with thousands of innocent women and children being trafficked daily. I implore the Biden Administration to restore order at the border! https://t.co/VbPkPNULWO

&lt;U+2022&gt; Big Oil continues to make record profits. Don Bolduc supports giving them *even more* tax breaks, while Granite Staters pay the price. https://t.co/sIBtyacOLs

&lt;U+2022&gt; @MondaireJones @nytimes A better world is NOT possible if those in authority ignore the suffering of the people they have sworn to serve. Crime is real, not disinformation. Voters aren't as stupid as you and the @nytimes seem to think. They were not "fooled" into voting against Democrats.

&lt;U+2022&gt; &lt;U+201C&gt;Biden's border disaster: Americans deserve solutions, not excuses.&lt;U+201D&gt;I agree. That&lt;U+2019&gt;s why I introduced the Border Patrol First Act to put America first and prioritize funding for our southern border over those of other countries.

&lt;U+2022&gt; With your support, I&lt;U+2019&gt;ll help Republicans retake the Senate and put our economy back on track. Together, we can positively change the direction of the nation.

&lt;U+2022&gt; The #InflationReductionAct cuts health care premiums and caps prescription drug costs. Yet not a single House Republican voted for it.

&lt;U+2022&gt; I think the top issues are inflation crime in the economy we've seen that repeatedly dating all the way back to the primary peacock touting Orland Park's low crime rate and budget cutting and his Defiance of Governor pritzker's pandemic shutdown he sued to reopen restaurants and gyms a lot of seniors and a lot of residents that needed to they needed physical fitness and it was pretty important so we felt that was important and our restaurants just wouldn't have survived if we didn't open them back up so we felt it was important to go to bat for them

&lt;U+2022&gt; Thanks for the assist @mrskurantowicz I wanted to make sure that was done SAFELY! Which is why I fought for 1.1B in education funds to allow @GovNedLamont and every school district to do just that. https://t.co/Daju1bf2CY https://t.co/H9y9k2HF9d https://t.co/raQEB12GxW

&lt;U+2022&gt; We are paying 81% more for our natural gas 2021-22 vs 2022-23. #Inflation is real. And it&lt;U+2019&gt;s stealing our paychecks and savings. #Theft https://t.co/S687pRi763

&lt;U+2022&gt; Supporting voter registration, education, &amp; mobilization, I traveled over five hundred miles today! I&lt;U+2019&gt;m truly thankful for all of the support my team &amp; I are receiving as we let voters know what&lt;U+2019&gt;s at stake &amp; on the ballot! #boydforalabama

&lt;U+2022&gt; As a 23-year police officer, law enforcement knows I will always have their backs. While others denigrate and disparage our police which has led to record low recruitment and record high crime, I am a steady voice for law and order and will continue ensuring we always provide our law enforcement with the resources needed to keep us safe. #80in80inGreat8 #OurWayofLife

&lt;U+2022&gt; Building the economy on our reservations is vital!

&lt;U+2022&gt; Our supply chain is stretched to a breaking point. I see the impact at our auto shop every day. The future of good jobs in #WA03 depends on whether we can breathe life back into American-made manufacturing with investments in career &amp;amp; technical education. https://t.co/YBfqq8jCUn

&lt;U+2022&gt; The &lt;U+201C&gt;Inflation Reduction Act&lt;U+201D&gt; hasn&lt;U+2019&gt;t done a single thing to reduce inflation. In fact, it&lt;U+2019&gt;s making it worse. Top think tanks such as the Heritage Foundation, Hoover Institution, and the Committee for a Responsible Budget all said the &lt;U+201C&gt;Inflation Reduction Act&lt;U+201D&gt; won&lt;U+2019&gt;t do a thing to reduce inflation. The Tax Foundation&lt;U+2019&gt;s analysis even found that it would reduce long-run economic output by 0.2% and eliminate around 29,000 jobs, while making inflation WORSE. And if that isn&lt;U+2019&gt;t enough, even the most progressive politicians, like Bernie Sanders, said the bill will have a &lt;U+201C&gt;minimal impact&lt;U+201D&gt; on inflation. You won&lt;U+2019&gt;t be surprised to learn that the only reason this was introduced is to further the Democrats&lt;U+2019&gt; radical climate change agenda - NOT help everyday Americans. This bill takes a bunch of taxpayer money ($257 billion, to be exact) and invests it in things like unreliable &lt;U+201C&gt;green energy&lt;U+201D&gt; sources&lt;U+2014&gt;like solar and wind&lt;U+2014&gt;increasing your energy prices and letting the government take money out of your pocket. It also funded $80 billion for the IRS to hire new 87,000 agents to come after your hardworking family via audits. Does this sound like &lt;U+201C&gt;inflation reduction&lt;U+201D&gt; to you?

&lt;U+2022&gt; It's easy to do interviews at the Border &amp;amp; scapegoat people seeking a better life. The 53 migrants who died in the back of a truck didn't come here w/drugs or weapons. We're being failed by an incumbent who cares more abt photo ops than real #immigrationreform. #NoMoreMemorials https://t.co/7PO62KnuLI

&lt;U+2022&gt; In this crisis moment where women &amp;amp; doctors are being threatened with life in prison for abortion care, we need leaders in Congress who will champion reproductive rights. Unlike my opponent, I codified these rights into law in CO &amp;amp; will continue that fight in DC #copolitics #CO07 https://t.co/DxA7Dj8oSn

&lt;U+2022&gt; Great to be out on the job site this morning with homebuilders! Inflation and high gas prices are crushing workers. We need to get back to drilling and our energy independence. Joe Biden&lt;U+2019&gt;s wake up call is coming on November 8th and it&lt;U+2019&gt;s to say we want to put America First! &lt;U+0001F1FA&gt;&lt;U+0001F1F8&gt; https://t.co/95S7p8hQOE

&lt;U+2022&gt; Let&lt;U+2019&gt;s do this! #votedemocrat #election2022 #vote #voters #nativevote #northernnevada #sparksnv #homemeansnevada #downtownreno #laketahoe #midtownreno #NVPol #EveryNativeVoteCounts #VoteIndigenous #DemocracyIsIndigenous #VotingOnNativeLand #NativeVotes #IndigenousRights #VotantesLatinos #LatinoVoters #latinovotesmatter #AANHPI #BLM #BlackVotesMatter #LGBTQIA #2SLGBTQIA #Gender #reproductiverights #abortionrightsarehumanrights #abortionishealthcare

&lt;U+2022&gt; #FL28, I ask for your #VOTE. Where US Rep C. Gimenez votes against women; lowering cost of med ins &amp;amp; insulin; corporate price gauging; &amp;amp; $$ for infrastructure, jobs creation, housing asst, reducing greenhouse gases, clean wafer, hurricane relief..I will not https://t.co/7bAIwi8vHP

&lt;U+2022&gt; Colin Schmitt believes he can make better healthcare decisions than Hudson Valley women. I don&lt;U+2019&gt;t.

&lt;U+2022&gt; From Business Insider &lt;U+201C&gt;companies are pocketing their fattest profits in 70 years, even as they complain about inflation.&lt;U+201D&gt; Commerce Department data shows corporate profit margins are at the greatest levels since the 1950&lt;U+2019&gt;s. The Iron Mountain CEO says &lt;U+201C&gt;he&lt;U+2019&gt;s been praying for inflation because it&lt;U+2019&gt;s an excuse to jack up prices.&lt;U+201D&gt;

&lt;U+2022&gt; Stopped by Halls Supermarket in Colonial Beach to talk to voters about the rising costs of goods due to inflation. One thing is clear: it&lt;U+2019&gt;s time to take back the House and put an end to Biden&lt;U+2019&gt;s reckless agenda.

&lt;U+2022&gt; These include the Invest to Protect Act to increase funding for local police departments&lt;U+2705&gt; the Break the Cycle of Violence Act to fund non-profit and community-based organizations that work to reduce crime&lt;U+2705&gt;&lt;U+2026&gt;

&lt;U+2022&gt; &lt;U+2B06&gt;&lt;U+FE0F&gt;98 individuals on the terrorist watchlist&lt;U+2B06&gt;&lt;U+FE0F&gt;14,000 pounds of fentanyl&lt;U+2B06&gt;&lt;U+FE0F&gt;600,000 &lt;U+201C&gt;got-aways&lt;U+201D&gt;Biden&lt;U+2019&gt;s open-border policies continue to break all the wrong records.

&lt;U+2022&gt; Chris Deluzio is being delusional. If you want to see a radical position on abortion look at Chris. He believes in taxpayer funded abortion on demand up until the MOMENT OF BIRTH. That&lt;U+2019&gt;s out of touch with the vast majority of Americans #PA17Debate

&lt;U+2022&gt; .@WMUR9 #NHSEN debate: I've served on the Southern Border, &amp;amp; I have helped other countries secure their borders. What the Biden-Hassan Administration is doing is not a way to keep our Country safe &amp;amp; secure. Their priorities are out-of-touch. #VoteBolduc to secure our borders! https://t.co/f7chIoqQsH

&lt;U+2022&gt; Proud to earn the endorsement of Alliance for Retired Americans. Thank you for your confidence in me &amp;amp; for your support. In Congress, I voted to lower the cost of Rx prices &amp;amp; provide critical healthcare to veterans. My opponent voted against both of these bills.#FL02 #FlaPol 1/2 https://t.co/B9LM5UPuYn</code></pre>
</div>
</div>
<p><strong>thoughts and observations:</strong></p>
<p>When I looked through a small sample of posts that focused on policy issues like inflation, jobs, crime, abortion, immigration, and education, a few things stood out to me.</p>
<p>The first is how differently the same topics are framed depending on the candidate. Posts about inflation, for example, sometimes talk about everyday struggles like the rising cost of groceries or Thanksgiving dinner, while others use the issue to criticize government spending and tie it to partisan blame. Similarly, on abortion and healthcare, some candidates emphasize rights and protections, while others stress morality or security. Reading them side by side makes it clear that even when everyone is talking about the same problem, they present it in very different ways.</p>
<p>Another thing I noticed is how much of the content is “campaign talk.” Many posts combine an issue with a call to action—come to a rally, donate, vote early, or volunteer. They’re filled with hashtags, <span class="citation" data-cites="mentions">@mentions</span>, links, and emojis, which makes sense for social media but also means a lot of this text will have to be cleaned or standardized before analysis. At the same time, some hashtags are clearly issue signals (like #ProChoice or #SaveAmerica), so I might want to keep those instead of stripping them all away.</p>
<p>Overall, reading these posts helped me see both the main themes and the style of communication. Candidates are trying to link national debates to everyday life, while also pushing people to engage with their campaigns. It gave me a clearer sense of what matters in preprocessing—removing clutter, but also keeping the pieces that carry real political meaning.</p>
</section>
<section id="question-2" class="level2">
<h2 class="anchored" data-anchor-id="question-2">Question 2</h2>
<p>Tokenize your documents and pre-process them, removing any “extraneous” content you noticed in closely reading a sample of your documents. What content have you removed and why? Any pre-processing steps from what you saw in class that you consider not to use here?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tokenize and Preprocess</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"pacman"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr, stringr, readr, quanteda, quanteda.textstats, tidytext)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Assumes df is already loaded from Q1:</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">exists</span>(<span class="st">"df"</span>))</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>text_col <span class="ot">&lt;-</span> <span class="st">"text"</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Things to REMOVE as “extraneous” for modeling</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>remove_regex <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">url      =</span> <span class="st">"(https?://|www</span><span class="sc">\\</span><span class="st">.)</span><span class="sc">\\</span><span class="st">S+"</span>,        <span class="co"># URLs/UTM junk</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">handle   =</span> <span class="st">"(?&lt;=</span><span class="sc">\\</span><span class="st">s|^)@[A-Za-z0-9_]+"</span>,      <span class="co"># @mentions</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">rt_amp   =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">b(rt|amp)</span><span class="sc">\\</span><span class="st">b"</span>,                 <span class="co"># retweet tag &amp; HTML 'amp'</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">ellipses =</span> <span class="st">"…|&amp;amp;|&amp;gt;|&amp;lt;"</span>,             <span class="co"># common HTML/Unicode artifacts</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">emoji    =</span> <span class="st">"[</span><span class="sc">\\</span><span class="st">p{So}</span><span class="sc">\\</span><span class="st">p{Cn}]+"</span>,             <span class="co"># emojis/symbols (broad net)</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">nbsp     =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">u00A0"</span>                        <span class="co"># non-breaking space</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Hashtags: keep topic info but drop the # symbol (e.g., #ProChoice -&gt; prochoice)</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep hashtags because many are issue labels.</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>hashtag_pattern <span class="ot">&lt;-</span> <span class="st">"#([A-Za-z0-9_]+)"</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Stopword list: standard + campaign boilerplate (tune as needed)</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>custom_stop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">stopwords</span>(<span class="st">"en"</span>),</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>                 <span class="co"># platform/campaign boilerplate you noted in Q1:</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"please"</span>,<span class="st">"thank"</span>,<span class="st">"thanks"</span>,<span class="st">"join"</span>,<span class="st">"donate"</span>,<span class="st">"volunteer"</span>,</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"rsvp"</span>,<span class="st">"event"</span>,<span class="st">"today"</span>,<span class="st">"tonight"</span>,<span class="st">"tomorrow"</span>,<span class="st">"vote"</span>,<span class="st">"voting"</span>,</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"link"</span>,<span class="st">"click"</span>,<span class="st">"share"</span>,<span class="st">"retweet"</span>,<span class="st">"follow"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define variables (from previous chunk)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>text_col <span class="ot">&lt;-</span> <span class="st">"text"</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Things to REMOVE as "extraneous" for modeling</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>remove_regex <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">url      =</span> <span class="st">"(https?://|www</span><span class="sc">\\</span><span class="st">.)</span><span class="sc">\\</span><span class="st">S+"</span>,        <span class="co"># URLs/UTM junk</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">handle   =</span> <span class="st">"(?&lt;=</span><span class="sc">\\</span><span class="st">s|^)@[A-Za-z0-9_]+"</span>,      <span class="co"># @mentions</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">rt_amp   =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">b(rt|amp)</span><span class="sc">\\</span><span class="st">b"</span>,                 <span class="co"># retweet tag &amp; HTML 'amp'</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">ellipses =</span> <span class="st">"…|&amp;amp;|&amp;gt;|&amp;lt;"</span>,             <span class="co"># common HTML/Unicode artifacts</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">emoji    =</span> <span class="st">"[</span><span class="sc">\\</span><span class="st">p{So}</span><span class="sc">\\</span><span class="st">p{Cn}]+"</span>,             <span class="co"># emojis/symbols (broad net)</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">nbsp     =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">u00A0"</span>                        <span class="co"># non-breaking space</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Hashtags: keep topic info but drop the # symbol (e.g., #ProChoice -&gt; prochoice)</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>hashtag_pattern <span class="ot">&lt;-</span> <span class="st">"#([A-Za-z0-9_]+)"</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Stopword list: standard + campaign boilerplate</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>custom_stop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">stopwords</span>(<span class="st">"en"</span>),</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>                <span class="co"># platform/campaign boilerplate:</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>                <span class="st">"please"</span>,<span class="st">"thank"</span>,<span class="st">"thanks"</span>,<span class="st">"join"</span>,<span class="st">"donate"</span>,<span class="st">"volunteer"</span>,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>                <span class="st">"rsvp"</span>,<span class="st">"event"</span>,<span class="st">"today"</span>,<span class="st">"tonight"</span>,<span class="st">"tomorrow"</span>,<span class="st">"vote"</span>,<span class="st">"voting"</span>,</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>                <span class="st">"link"</span>,<span class="st">"click"</span>,<span class="st">"share"</span>,<span class="st">"retweet"</span>,<span class="st">"follow"</span>)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre-clean: normalize &amp; remove artifacts while KEEPING hashtag words</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>text_clean <span class="ot">&lt;-</span> df[[text_col]] <span class="sc">|&gt;</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ensure string</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.character</span>() <span class="sc">|&gt;</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># normalize Unicode &amp; whitespace</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  stringi<span class="sc">::</span><span class="fu">stri_trans_general</span>(<span class="st">"Latin-ASCII"</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(remove_regex<span class="sc">$</span>url, <span class="st">" "</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(remove_regex<span class="sc">$</span>handle, <span class="st">" "</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(hashtag_pattern, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>) <span class="sc">|&gt;</span>          <span class="co"># strip '#', keep token</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(remove_regex<span class="sc">$</span>rt_amp, <span class="st">" "</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(remove_regex<span class="sc">$</span>ellipses, <span class="st">" "</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(remove_regex<span class="sc">$</span>emoji, <span class="st">" "</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(remove_regex<span class="sc">$</span>nbsp, <span class="st">" "</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_squish</span>()</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Build corpus &amp; tokens</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>corp <span class="ot">&lt;-</span> <span class="fu">corpus</span>(text_clean)</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>toks <span class="ot">&lt;-</span> <span class="fu">tokens</span>(</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  corp,</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">remove_punct   =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">remove_symbols =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">remove_numbers =</span> <span class="cn">TRUE</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_tolower</span>() <span class="sc">|&gt;</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_remove</span>(<span class="at">pattern =</span> custom_stop) <span class="sc">|&gt;</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_keep</span>(<span class="at">pattern =</span> <span class="st">"^[a-z][a-z0-9_]+$"</span>, <span class="at">valuetype =</span> <span class="st">"regex"</span>)  <span class="co"># keep words</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a DFM and trim very rare terms (tune threshold)</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>dfm_clean <span class="ot">&lt;-</span> <span class="fu">dfm</span>(toks) <span class="sc">|&gt;</span> <span class="fu">dfm_trim</span>(<span class="at">min_termfreq =</span> <span class="dv">5</span>)</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>dfm_clean</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Document-feature matrix of: 134,629 documents, 20,320 features (99.93% sparse) and 0 docvars.
       features
docs    fault got kicked plane happy anniversary kelley paul truly blessed
  text1     1   1      1     1     0           0      0    0     0       0
  text2     0   0      0     0     1           1      1    1     1       1
  text3     0   0      0     0     0           0      0    0     0       0
  text4     0   0      0     0     0           0      0    0     0       0
  text5     0   0      0     0     0           0      0    0     0       0
  text6     0   0      0     0     0           0      0    0     0       0
[ reached max_ndoc ... 134,623 more documents, reached max_nfeat ... 20,310 more features ]</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Token count before/after (rough)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>raw_len   <span class="ot">&lt;-</span> <span class="fu">nchar</span>(df[[text_col]])</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>clean_len <span class="ot">&lt;-</span> <span class="fu">nchar</span>(text_clean)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>summary_tbl <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_docs          =</span> <span class="fu">nrow</span>(df),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">median_chars_raw   =</span> <span class="fu">median</span>(raw_len,   <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">median_chars_clean =</span> <span class="fu">median</span>(clean_len, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">vocab_size_raw     =</span> <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">unlist</span>(<span class="fu">str_split</span>(<span class="fu">tolower</span>(<span class="fu">paste</span>(df[[text_col]], <span class="at">collapse=</span><span class="st">" "</span>)), <span class="st">"</span><span class="sc">\\</span><span class="st">s+"</span>)))),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">vocab_size_clean   =</span> <span class="fu">nfeat</span>(dfm_clean)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>summary_tbl</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 5
  n_docs median_chars_raw median_chars_clean vocab_size_raw vocab_size_clean
   &lt;int&gt;            &lt;int&gt;              &lt;int&gt;          &lt;int&gt;            &lt;int&gt;
1 134629              185                161         230177            20320</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show a few examples (first 5) before/after</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>ex <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">raw   =</span> df[[text_col]][<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">clean =</span> text_clean[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>ex</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 x 2
  raw                                                                      clean
  &lt;chr&gt;                                                                    &lt;chr&gt;
1 "IT'S ALL TRUMP'S FAULT THAT SHE GOT KICKED OFF THE PLANE..."            "IT'~
2 "Happy Anniversary, Kelley Paul! I\u2019m truly blessed to have you by ~ "Hap~
3 "Hurricane Ian: quick update on the rumor mill \u2014 lots of talk abou~ "Hur~
4 "\u26a0\ufe0f The media will never cover this but we are at a breaking ~ "\uf~
5 "Nothing says \u2018I\u2019m a regular Pennsylvanian\u2019 like sipping~ "Not~</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Top terms after cleaning (sanity check)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>top_terms <span class="ot">&lt;-</span> <span class="fu">textstat_frequency</span>(dfm_clean, <span class="at">n =</span> <span class="dv">30</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(top_terms, <span class="dv">30</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    feature frequency rank docfreq group
1    people     14331    1    9951   all
2        us     13834    2   11369   all
3       get     13048    3   10818   all
4       day     12353    4   10834   all
5       can     11989    5    9444   all
6      make     11243    6    9654   all
7     great     10478    7    9407   all
8  election     10423    8    9245   all
9   support     10312    9    9223   all
10     time     10307   10    8909   all
11 congress      9200   11    8192   all
12     know      9124   12    5299   all
13     need      9078   13    7269   all
14      one      8848   14    6824   all
15     just      8838   15    6627   all
16     like      8236   16    6161   all
17      now      8017   17    6222   all
18      new      7775   18    6342   all
19     help      7746   19    6826   all
20     work      7605   20    6612   all
21   county      7346   21    5922   all
22 campaign      7216   22    6419   all
23     back      7139   23    6088   all
24    right      6827   24    4826   all
25 district      6580   25    5344   all
26    going      6515   26    4044   all
27    state      6491   27    5309   all
28    every      6336   28    5284   all
29  country      6301   29    5178   all
30   voters      6266   30    5666   all</code></pre>
</div>
</div>
<p><strong>Your thoughts and observations:</strong> In preprocessing, I removed punctuation, numbers, and stopwords, since these do not carry substantive meaning for political analysis. I also applied stemming to reduce inflected forms to a common base, which helps group related terms together. However, I decided to keep hashtags and <span class="citation" data-cites="mentions">@mentions</span>, since in the context of campaigns these often reference movements, slogans, or political actors directly. I also chose not to apply lemmatization on top of stemming, because doing both could oversimplify the vocabulary and strip away nuance. The trimming step ensured that extremely rare or overly common words were dropped, leaving a more balanced set of features for later analysis.</p>
</section>
<section id="question-3" class="level2">
<h2 class="anchored" data-anchor-id="question-3">Question 3</h2>
<p>Using <a href="https://github.com/matthewjdenny/preText">Danny and Spirling’s Pretext</a>, tell me which of the pre-processing steps makes a more substantive difference in the data transformation? Would you keep all these steps or would you follow the PreText recommendations? Use a sample of the data to solve this question.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"remotes"</span>, <span class="st">"BiocManager"</span>))  <span class="co"># BiocManager is harmless; some deps check it</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in contrib.url(repos, "source"): trying to use CRAN without setting a mirror</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"matthewjdenny/preText"</span>, <span class="at">build_vignettes =</span> <span class="cn">FALSE</span>, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(preText)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a small, clean sample (preText can be slow on 100k+ docs)</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>q3_sample <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(text), <span class="fu">nchar</span>(text) <span class="sc">&gt;</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">1500</span>) <span class="sc">%&gt;%</span>               </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(text) <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.character</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run factorial preprocessing across many schemes</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ngrams off to save time</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>pre_docs <span class="ot">&lt;-</span> preText<span class="sc">::</span><span class="fu">factorial_preprocessing</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  q3_sample,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">use_ngrams =</span> <span class="cn">FALSE</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">infrequent_term_threshold =</span> <span class="fl">0.01</span>,          <span class="co"># drop terms in &lt;1% of docs within each scheme</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">TRUE</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Preprocessing 1500 documents 64 different ways...
Currently working on combination 1 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 6807 of 7172 total terms that appeared in less than 15 documents.
Currently working on combination 2 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 6812 of 7191 total terms that appeared in less than 15 documents.
Currently working on combination 3 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 6950 of 7323 total terms that appeared in less than 15 documents.
Currently working on combination 4 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 6955 of 7342 total terms that appeared in less than 15 documents.
Currently working on combination 5 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 6936 of 7299 total terms that appeared in less than 15 documents.
Currently working on combination 6 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 6941 of 7318 total terms that appeared in less than 15 documents.
Currently working on combination 7 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 7079 of 7450 total terms that appeared in less than 15 documents.
Currently working on combination 8 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 7084 of 7469 total terms that appeared in less than 15 documents.
Currently working on combination 9 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8320 of 8648 total terms that appeared in less than 15 documents.
Currently working on combination 10 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8325 of 8667 total terms that appeared in less than 15 documents.
Currently working on combination 11 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8463 of 8799 total terms that appeared in less than 15 documents.
Currently working on combination 12 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8468 of 8818 total terms that appeared in less than 15 documents.
Currently working on combination 13 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8320 of 8648 total terms that appeared in less than 15 documents.
Currently working on combination 14 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8325 of 8667 total terms that appeared in less than 15 documents.
Currently working on combination 15 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8463 of 8799 total terms that appeared in less than 15 documents.
Currently working on combination 16 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8468 of 8818 total terms that appeared in less than 15 documents.
Currently working on combination 17 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 6843 of 7306 total terms that appeared in less than 15 documents.
Currently working on combination 18 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 6848 of 7325 total terms that appeared in less than 15 documents.
Currently working on combination 19 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 6986 of 7457 total terms that appeared in less than 15 documents.
Currently working on combination 20 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 6991 of 7476 total terms that appeared in less than 15 documents.
Currently working on combination 21 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 6977 of 7438 total terms that appeared in less than 15 documents.
Currently working on combination 22 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 6982 of 7457 total terms that appeared in less than 15 documents.
Currently working on combination 23 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 7120 of 7589 total terms that appeared in less than 15 documents.
Currently working on combination 24 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 7125 of 7608 total terms that appeared in less than 15 documents.
Currently working on combination 25 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8369 of 8801 total terms that appeared in less than 15 documents.
Currently working on combination 26 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8374 of 8820 total terms that appeared in less than 15 documents.
Currently working on combination 27 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8512 of 8952 total terms that appeared in less than 15 documents.
Currently working on combination 28 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8517 of 8971 total terms that appeared in less than 15 documents.
Currently working on combination 29 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8369 of 8801 total terms that appeared in less than 15 documents.
Currently working on combination 30 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8374 of 8820 total terms that appeared in less than 15 documents.
Currently working on combination 31 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8512 of 8952 total terms that appeared in less than 15 documents.
Currently working on combination 32 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8517 of 8971 total terms that appeared in less than 15 documents.
Currently working on combination 33 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 34 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 35 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 36 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 37 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 38 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 39 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 40 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 41 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 42 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 43 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 44 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 45 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 46 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 47 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 48 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 49 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 50 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 51 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 52 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 53 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 54 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 55 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 56 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 57 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 58 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 59 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 60 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 61 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 62 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 63 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 64 of 64 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute preText scores (how much each scheme changes doc distances)</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>pt_res <span class="ot">&lt;-</span> preText<span class="sc">::</span><span class="fu">preText</span>(</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  pre_docs,</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataset_name    =</span> <span class="st">"Midterm Candidates (sample)"</span>,</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">distance_method =</span> <span class="st">"cosine"</span>,</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">num_comparisons =</span> <span class="dv">50</span>,                      <span class="co"># use 50 for saving time</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">TRUE</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Generating document distances...
Currently working on dfm 1 of 64 
Complete in: 2.804 seconds...
Currently working on dfm 2 of 64 
Complete in: 2.662 seconds...
Currently working on dfm 3 of 64 
Complete in: 2.72 seconds...
Currently working on dfm 4 of 64 
Complete in: 2.729 seconds...
Currently working on dfm 5 of 64 
Complete in: 2.733 seconds...
Currently working on dfm 6 of 64 
Complete in: 2.611 seconds...
Currently working on dfm 7 of 64 
Complete in: 2.606 seconds...
Currently working on dfm 8 of 64 
Complete in: 2.733 seconds...
Currently working on dfm 9 of 64 
Complete in: 2.588 seconds...
Currently working on dfm 10 of 64 
Complete in: 2.621 seconds...
Currently working on dfm 11 of 64 
Complete in: 2.605 seconds...
Currently working on dfm 12 of 64 
Complete in: 2.743 seconds...
Currently working on dfm 13 of 64 
Complete in: 2.7 seconds...
Currently working on dfm 14 of 64 
Complete in: 2.758 seconds...
Currently working on dfm 15 of 64 
Complete in: 2.585 seconds...
Currently working on dfm 16 of 64 
Complete in: 2.659 seconds...
Currently working on dfm 17 of 64 
Complete in: 2.673 seconds...
Currently working on dfm 18 of 64 
Complete in: 2.677 seconds...
Currently working on dfm 19 of 64 
Complete in: 2.648 seconds...
Currently working on dfm 20 of 64 
Complete in: 2.778 seconds...
Currently working on dfm 21 of 64 
Complete in: 2.624 seconds...
Currently working on dfm 22 of 64 
Complete in: 2.66 seconds...
Currently working on dfm 23 of 64 
Complete in: 2.645 seconds...
Currently working on dfm 24 of 64 
Complete in: 2.661 seconds...
Currently working on dfm 25 of 64 
Complete in: 2.683 seconds...
Currently working on dfm 26 of 64 
Complete in: 2.816 seconds...
Currently working on dfm 27 of 64 
Complete in: 2.662 seconds...
Currently working on dfm 28 of 64 
Complete in: 2.771 seconds...
Currently working on dfm 29 of 64 
Complete in: 2.626 seconds...
Currently working on dfm 30 of 64 
Complete in: 2.674 seconds...
Currently working on dfm 31 of 64 
Complete in: 2.626 seconds...
Currently working on dfm 32 of 64 
Complete in: 2.654 seconds...
Currently working on dfm 33 of 64 
Complete in: 2.619 seconds...
Currently working on dfm 34 of 64 
Complete in: 2.682 seconds...
Currently working on dfm 35 of 64 
Complete in: 2.665 seconds...
Currently working on dfm 36 of 64 
Complete in: 2.68 seconds...
Currently working on dfm 37 of 64 
Complete in: 2.655 seconds...
Currently working on dfm 38 of 64 
Complete in: 2.679 seconds...
Currently working on dfm 39 of 64 
Complete in: 2.655 seconds...
Currently working on dfm 40 of 64 
Complete in: 2.686 seconds...
Currently working on dfm 41 of 64 
Complete in: 2.74 seconds...
Currently working on dfm 42 of 64 
Complete in: 2.665 seconds...
Currently working on dfm 43 of 64 
Complete in: 2.747 seconds...
Currently working on dfm 44 of 64 
Complete in: 2.661 seconds...
Currently working on dfm 45 of 64 
Complete in: 2.636 seconds...
Currently working on dfm 46 of 64 
Complete in: 2.662 seconds...
Currently working on dfm 47 of 64 
Complete in: 2.638 seconds...
Currently working on dfm 48 of 64 
Complete in: 2.638 seconds...
Currently working on dfm 49 of 64 
Complete in: 2.661 seconds...
Currently working on dfm 50 of 64 
Complete in: 2.695 seconds...
Currently working on dfm 51 of 64 
Complete in: 2.651 seconds...
Currently working on dfm 52 of 64 
Complete in: 2.818 seconds...
Currently working on dfm 53 of 64 
Complete in: 2.681 seconds...
Currently working on dfm 54 of 64 
Complete in: 2.753 seconds...
Currently working on dfm 55 of 64 
Complete in: 2.653 seconds...
Currently working on dfm 56 of 64 
Complete in: 2.715 seconds...
Currently working on dfm 57 of 64 
Complete in: 2.644 seconds...
Currently working on dfm 58 of 64 
Complete in: 2.839 seconds...
Currently working on dfm 59 of 64 
Complete in: 2.653 seconds...
Currently working on dfm 60 of 64 
Complete in: 2.695 seconds...
Currently working on dfm 61 of 64 
Complete in: 2.692 seconds...
Currently working on dfm 62 of 64 
Complete in: 2.674 seconds...
Currently working on dfm 63 of 64 
Complete in: 2.639 seconds...
Currently working on dfm 64 of 64 
Complete in: 2.697 seconds...
Generating preText Scores...
Currently working on DFM: 1 of 64 

Complete in: 5.614 seconds...
Currently working on DFM: 2 of 64 

Complete in: 5.658 seconds...
Currently working on DFM: 3 of 64 

Complete in: 5.618 seconds...
Currently working on DFM: 4 of 64 

Complete in: 5.395 seconds...
Currently working on DFM: 5 of 64 

Complete in: 5.386 seconds...
Currently working on DFM: 6 of 64 

Complete in: 5.4 seconds...
Currently working on DFM: 7 of 64 

Complete in: 5.453 seconds...
Currently working on DFM: 8 of 64 

Complete in: 5.544 seconds...
Currently working on DFM: 9 of 64 

Complete in: 5.405 seconds...
Currently working on DFM: 10 of 64 

Complete in: 5.37 seconds...
Currently working on DFM: 11 of 64 

Complete in: 5.445 seconds...
Currently working on DFM: 12 of 64 

Complete in: 5.421 seconds...
Currently working on DFM: 13 of 64 

Complete in: 5.388 seconds...
Currently working on DFM: 14 of 64 

Complete in: 5.518 seconds...
Currently working on DFM: 15 of 64 

Complete in: 5.386 seconds...
Currently working on DFM: 16 of 64 

Complete in: 5.459 seconds...
Currently working on DFM: 17 of 64 

Complete in: 5.45 seconds...
Currently working on DFM: 18 of 64 

Complete in: 5.399 seconds...
Currently working on DFM: 19 of 64 

Complete in: 5.486 seconds...
Currently working on DFM: 20 of 64 

Complete in: 5.4 seconds...
Currently working on DFM: 21 of 64 

Complete in: 5.485 seconds...
Currently working on DFM: 22 of 64 

Complete in: 5.431 seconds...
Currently working on DFM: 23 of 64 

Complete in: 5.398 seconds...
Currently working on DFM: 24 of 64 

Complete in: 5.496 seconds...
Currently working on DFM: 25 of 64 

Complete in: 5.454 seconds...
Currently working on DFM: 26 of 64 

Complete in: 5.414 seconds...
Currently working on DFM: 27 of 64 

Complete in: 5.454 seconds...
Currently working on DFM: 28 of 64 

Complete in: 5.289 seconds...
Currently working on DFM: 29 of 64 

Complete in: 5.215 seconds...
Currently working on DFM: 30 of 64 

Complete in: 5.355 seconds...
Currently working on DFM: 31 of 64 

Complete in: 5.171 seconds...
Currently working on DFM: 32 of 64 

Complete in: 5.176 seconds...
Currently working on DFM: 33 of 64 

Complete in: 5.165 seconds...
Currently working on DFM: 34 of 64 

Complete in: 5.223 seconds...
Currently working on DFM: 35 of 64 

Complete in: 5.415 seconds...
Currently working on DFM: 36 of 64 

Complete in: 5.457 seconds...
Currently working on DFM: 37 of 64 

Complete in: 5.396 seconds...
Currently working on DFM: 38 of 64 

Complete in: 5.378 seconds...
Currently working on DFM: 39 of 64 

Complete in: 5.4 seconds...
Currently working on DFM: 40 of 64 

Complete in: 5.369 seconds...
Currently working on DFM: 41 of 64 

Complete in: 5.526 seconds...
Currently working on DFM: 42 of 64 

Complete in: 5.423 seconds...
Currently working on DFM: 43 of 64 

Complete in: 5.387 seconds...
Currently working on DFM: 44 of 64 

Complete in: 5.429 seconds...
Currently working on DFM: 45 of 64 

Complete in: 5.397 seconds...
Currently working on DFM: 46 of 64 

Complete in: 5.515 seconds...
Currently working on DFM: 47 of 64 

Complete in: 5.419 seconds...
Currently working on DFM: 48 of 64 

Complete in: 5.391 seconds...
Currently working on DFM: 49 of 64 

Complete in: 5.442 seconds...
Currently working on DFM: 50 of 64 

Complete in: 5.444 seconds...
Currently working on DFM: 51 of 64 

Complete in: 5.454 seconds...
Currently working on DFM: 52 of 64 

Complete in: 5.55 seconds...
Currently working on DFM: 53 of 64 

Complete in: 5.395 seconds...
Currently working on DFM: 54 of 64 

Complete in: 5.37 seconds...
Currently working on DFM: 55 of 64 

Complete in: 5.389 seconds...
Currently working on DFM: 56 of 64 

Complete in: 5.382 seconds...
Currently working on DFM: 57 of 64 

Complete in: 5.609 seconds...
Currently working on DFM: 58 of 64 

Complete in: 5.473 seconds...
Currently working on DFM: 59 of 64 

Complete in: 5.413 seconds...
Currently working on DFM: 60 of 64 

Complete in: 5.388 seconds...
Currently working on DFM: 61 of 64 

Complete in: 5.412 seconds...
Currently working on DFM: 62 of 64 

Complete in: 5.521 seconds...
Currently working on DFM: 63 of 64 

Complete in: 5.43 seconds...
Currently working on DFM: 64 of 64 
Complete in: 0 seconds...
Generating regression results..
The R^2 for this model is: 0.5236679 
Regression results (negative coefficients imply less risk):
                 Variable Coefficient    SE
1               Intercept       0.165 0.010
2      Remove Punctuation      -0.017 0.007
3          Remove Numbers       0.002 0.007
4               Lowercase       0.003 0.007
5                Stemming      -0.004 0.007
6        Remove Stopwords      -0.032 0.007
7 Remove Infrequent Terms       0.044 0.007
Complete in: 515.248 seconds...</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots: scores by scheme + marginal effects of each step</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>preText<span class="sc">::</span><span class="fu">preText_score_plot</span>(pt_res)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="problem_set_01_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>preText<span class="sc">::</span><span class="fu">regression_coefficient_plot</span>(pt_res, <span class="at">remove_intercept =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="problem_set_01_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Your thoughts and observations:</strong> PreText shows that the only preprocessing choice that materially changes the document representation is removing infrequent terms—it has the largest positive coefficient, meaning it alters distances between documents the most. In contrast, lowercasing, removing numbers, and removing stopwords have very small effects on the data, and stemming and removing punctuation slightly stabilize results (negative coefficients), likely by merging near-duplicate tokens. Practically, this means the model is sensitive to how aggressively you trim rare words; over-trimming can erase distinctive but informative tokens common in social media (unique hashtags, names, local issues). I would therefore keep light normalization (lowercase, stopwords, punctuation) and tune rare-term trimming conservatively (e.g., a lower threshold or an absolute count), using stemming only if you’re comfortable trading a bit of interpretability for stability.</p>
</section>
<section id="question-4" class="level2">
<h2 class="anchored" data-anchor-id="question-4">Question 4</h2>
<p>Pick an important source of variation in your data (for example: date, author identity, location, etc.). Subset the data along this dimension, and discuss which words discriminate better each group. You can do this by using TF-IDF, PMI, log(share <span class="math inline">\(word_i\)</span> in group a/share <span class="math inline">\(word_i\)</span> in b), or create a measure similar to Ban’s article.</p>
<p>::: {.cell}</p>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"pacman"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(readr, dplyr, stringr, tidytext, ggplot2)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Point to your CSV (adjust if you moved it)</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>data_path <span class="ot">&lt;-</span> <span class="st">"/Users/zhaoshuti/Desktop/TAT/problem-set-01-2025-ShutiZhao/midterm_candidates_labeled_all_May05.csv"</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Read only the columns we need to keep memory down</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>candidate_data <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a> data_path,</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a> <span class="at">col_select =</span> <span class="fu">c</span>(text, party_clean),</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a> <span class="at">guess_max =</span> <span class="fl">1e6</span>,</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a> <span class="at">show_col_types =</span> <span class="cn">FALSE</span></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Confirm I have the object &amp; columns</span></span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">is.data.frame</span>(candidate_data))</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="fu">c</span>(<span class="st">"text"</span>,<span class="st">"party_clean"</span>) <span class="sc">%in%</span> <span class="fu">names</span>(candidate_data)))</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Light sanity peek (optional)</span></span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>candidate_data <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<p>::: {.cell-output .cell-output-stdout}</p>
<pre><code># A tibble: 3 x 2
  text                                                               party_clean
  &lt;chr&gt;                                                              &lt;chr&gt;      
1 "IT'S ALL TRUMP'S FAULT THAT SHE GOT KICKED OFF THE PLANE..."      Republican 
2 "Happy Anniversary, Kelley Paul! I\u2019m truly blessed to have y~ Republican 
3 "Hurricane Ian: quick update on the rumor mill \u2014 lots of tal~ Republican </code></pre>
<p>::: :::</p>
<p>::: {.cell}</p>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect and recode party to two buckets</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>posts0 <span class="ot">&lt;-</span> candidate_data <span class="sc">%&gt;%</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">party_clean =</span> <span class="fu">str_squish</span>(<span class="fu">as.character</span>(party_clean)),</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>   <span class="at">party_clean_lower =</span> <span class="fu">str_to_lower</span>(party_clean)</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a> )</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a><span class="co"># see what labels we actually have</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>posts0 <span class="sc">%&gt;%</span> <span class="fu">count</span>(party_clean, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">50</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<p>::: {.cell-output .cell-output-stdout}</p>
<pre><code># A tibble: 2 x 2
  party_clean     n
  &lt;chr&gt;       &lt;int&gt;
1 Democratic  73607
2 Republican  61022</code></pre>
<p>:::</p>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>posts <span class="ot">&lt;-</span> posts0 <span class="sc">%&gt;%</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">party2 =</span> <span class="fu">case_when</span>(</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">str_detect</span>(party_clean_lower, <span class="st">"dem"</span>) <span class="sc">~</span> <span class="st">"Democrat"</span>,</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>     <span class="fu">str_detect</span>(party_clean_lower, <span class="st">"rep|gop"</span>) <span class="sc">~</span> <span class="st">"Republican"</span>,</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>     <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>   )</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a> )</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a><span class="co"># check counts after recode</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>posts <span class="sc">%&gt;%</span> <span class="fu">count</span>(party2, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<p>::: {.cell-output .cell-output-stdout}</p>
<pre><code># A tibble: 2 x 2
  party2         n
  &lt;chr&gt;      &lt;int&gt;
1 Democrat   73607
2 Republican 61022</code></pre>
<p>::: :::</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode to two parties and keep non-empty text (base R)</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> candidate_data</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">trimws</span>(<span class="fu">as.character</span>(df<span class="sc">$</span>text))</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>party_clean <span class="ot">&lt;-</span> <span class="fu">trimws</span>(<span class="fu">as.character</span>(df<span class="sc">$</span>party_clean))</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>keep <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">is.na</span>(df<span class="sc">$</span>text) <span class="sc">&amp;</span> <span class="fu">nzchar</span>(df<span class="sc">$</span>text)</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[keep, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>pl <span class="ot">&lt;-</span> <span class="fu">tolower</span>(df<span class="sc">$</span>party_clean)</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>party2 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"dem"</span>, pl), <span class="st">"Democrat"</span>,</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"rep|gop"</span>, pl), <span class="st">"Republican"</span>, <span class="cn">NA_character_</span>))</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>party2 <span class="ot">&lt;-</span> party2</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[<span class="sc">!</span><span class="fu">is.na</span>(df<span class="sc">$</span>party2), <span class="fu">c</span>(<span class="st">"text"</span>,<span class="st">"party2"</span>)]</span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Tiny balanced sample (&lt;= 60 per party). Lower to 30 if needed.</span></span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">table</span>(df<span class="sc">$</span>party2)</span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>cap <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="dv">60</span>L, <span class="fu">as.integer</span>(<span class="fu">min</span>(tab)))</span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="fu">names</span>(tab), <span class="cf">function</span>(p) {</span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">which</span>(df<span class="sc">$</span>party2 <span class="sc">==</span> p)[<span class="fu">sample</span>(<span class="fu">sum</span>(df<span class="sc">$</span>party2 <span class="sc">==</span> p), cap)]</span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a>small <span class="ot">&lt;-</span> df[idx, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Docs per party:</span><span class="sc">\n</span><span class="st">"</span>); <span class="fu">print</span>(<span class="fu">table</span>(small<span class="sc">$</span>party2))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Docs per party:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
  Democrat Republican 
        60         60 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Super-light cleanup + base tokenization</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>clean_one <span class="ot">&lt;-</span> <span class="cf">function</span>(s) {</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">tolower</span>(s)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"https?://</span><span class="sc">\\</span><span class="st">S+|www</span><span class="sc">\\</span><span class="st">S+"</span>, <span class="st">" "</span>, s, <span class="at">perl =</span> <span class="cn">TRUE</span>)</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"@</span><span class="sc">\\</span><span class="st">w+|#</span><span class="sc">\\</span><span class="st">w+|&amp;amp;|&amp;gt;|&amp;lt;"</span>, <span class="st">" "</span>, s, <span class="at">perl =</span> <span class="cn">TRUE</span>)</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^a-z]+"</span>, <span class="st">" "</span>, s, <span class="at">perl =</span> <span class="cn">TRUE</span>)     <span class="co"># keep letters only</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">trimws</span>(s)</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>  s</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>stop_set <span class="ot">&lt;-</span> <span class="fu">c</span>(  <span class="co"># tiny stopword list (enough for this tiny demo)</span></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"the"</span>,<span class="st">"and"</span>,<span class="st">"for"</span>,<span class="st">"that"</span>,<span class="st">"with"</span>,<span class="st">"this"</span>,<span class="st">"from"</span>,<span class="st">"have"</span>,<span class="st">"your"</span>,<span class="st">"you"</span>,<span class="st">"about"</span>,</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"are"</span>,<span class="st">"was"</span>,<span class="st">"were"</span>,<span class="st">"been"</span>,<span class="st">"they"</span>,<span class="st">"them"</span>,<span class="st">"their"</span>,<span class="st">"there"</span>,<span class="st">"here"</span>,<span class="st">"will"</span>,</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"into"</span>,<span class="st">"over"</span>,<span class="st">"more"</span>,<span class="st">"just"</span>,<span class="st">"what"</span>,<span class="st">"when"</span>,<span class="st">"where"</span>,<span class="st">"which"</span>,<span class="st">"than"</span>,<span class="st">"then"</span>,</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"into"</span>,<span class="st">"out"</span>,<span class="st">"only"</span>,<span class="st">"very"</span>,<span class="st">"like"</span>,<span class="st">"time"</span>,<span class="st">"been"</span>,<span class="st">"because"</span>,<span class="st">"after"</span>,<span class="st">"before"</span></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a>tokenize <span class="ot">&lt;-</span> <span class="cf">function</span>(s) {</span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">clean_one</span>(s)</span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">nzchar</span>(s)) <span class="fu">return</span>(<span class="fu">character</span>(<span class="dv">0</span>))</span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a>  w <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(s, <span class="st">" +"</span>, <span class="at">fixed =</span> <span class="cn">FALSE</span>)[[<span class="dv">1</span>]]</span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a>  w <span class="ot">&lt;-</span> w[<span class="fu">nchar</span>(w) <span class="sc">&gt;=</span> <span class="dv">4</span>]</span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a>  w[<span class="sc">!</span>(w <span class="sc">%in%</span> stop_set)]</span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-26"><a href="#cb97-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) Split, count</span></span>
<span id="cb97-27"><a href="#cb97-27" aria-hidden="true" tabindex="-1"></a>dem_words <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(small<span class="sc">$</span>text[small<span class="sc">$</span>party2<span class="sc">==</span><span class="st">"Democrat"</span>], tokenize), <span class="at">use.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb97-28"><a href="#cb97-28" aria-hidden="true" tabindex="-1"></a>rep_words <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(small<span class="sc">$</span>text[small<span class="sc">$</span>party2<span class="sc">==</span><span class="st">"Republican"</span>], tokenize), <span class="at">use.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb97-29"><a href="#cb97-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-30"><a href="#cb97-30" aria-hidden="true" tabindex="-1"></a>dem_tab <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">table</span>(dem_words), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb97-31"><a href="#cb97-31" aria-hidden="true" tabindex="-1"></a>rep_tab <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">table</span>(rep_words), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb97-32"><a href="#cb97-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-33"><a href="#cb97-33" aria-hidden="true" tabindex="-1"></a><span class="co"># 5) Log-odds with prior (tiny, robust)</span></span>
<span id="cb97-34"><a href="#cb97-34" aria-hidden="true" tabindex="-1"></a>all_terms <span class="ot">&lt;-</span> <span class="fu">union</span>(<span class="fu">names</span>(dem_tab), <span class="fu">names</span>(rep_tab))</span>
<span id="cb97-35"><a href="#cb97-35" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(dem_tab[all_terms]); A[<span class="fu">is.na</span>(A)] <span class="ot">&lt;-</span> <span class="dv">0</span>L</span>
<span id="cb97-36"><a href="#cb97-36" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(rep_tab[all_terms]); B[<span class="fu">is.na</span>(B)] <span class="ot">&lt;-</span> <span class="dv">0</span>L</span>
<span id="cb97-37"><a href="#cb97-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-38"><a href="#cb97-38" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb97-39"><a href="#cb97-39" aria-hidden="true" tabindex="-1"></a>pa <span class="ot">&lt;-</span> (A <span class="sc">+</span> alpha) <span class="sc">/</span> <span class="fu">sum</span>(A <span class="sc">+</span> alpha)</span>
<span id="cb97-40"><a href="#cb97-40" aria-hidden="true" tabindex="-1"></a>pb <span class="ot">&lt;-</span> (B <span class="sc">+</span> alpha) <span class="sc">/</span> <span class="fu">sum</span>(B <span class="sc">+</span> alpha)</span>
<span id="cb97-41"><a href="#cb97-41" aria-hidden="true" tabindex="-1"></a>log_odds <span class="ot">&lt;-</span> <span class="fu">log</span>(pa) <span class="sc">-</span> <span class="fu">log</span>(pb)</span>
<span id="cb97-42"><a href="#cb97-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-43"><a href="#cb97-43" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">term =</span> all_terms, <span class="at">log_odds =</span> log_odds, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb97-44"><a href="#cb97-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-45"><a href="#cb97-45" aria-hidden="true" tabindex="-1"></a>top_dem <span class="ot">&lt;-</span> res[<span class="fu">order</span>(<span class="sc">-</span>res<span class="sc">$</span>log_odds), ][<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">15</span>, <span class="fu">nrow</span>(res)), ]</span>
<span id="cb97-46"><a href="#cb97-46" aria-hidden="true" tabindex="-1"></a>top_rep <span class="ot">&lt;-</span> res[<span class="fu">order</span>(res<span class="sc">$</span>log_odds),  ][<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">15</span>, <span class="fu">nrow</span>(res)), ]</span>
<span id="cb97-47"><a href="#cb97-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-48"><a href="#cb97-48" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Top Democrat-leaning terms (tiny sample):</span><span class="sc">\n</span><span class="st">"</span>); <span class="fu">print</span>(top_dem, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Top Democrat-leaning terms (tiny sample):</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>            term log_odds
            most 1.723161
           polls 1.723161
          voting 1.723161
            cast 1.500017
       community 1.500017
 congratulations 1.500017
   congressional 1.500017
           early 1.500017
           honor 1.500017
           rural 1.500017
          should 1.500017
         started 1.500017
          taking 1.500017
          across 1.212335
            area 1.212335</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Top Republican-leaning terms (tiny sample):</span><span class="sc">\n</span><span class="st">"</span>); <span class="fu">print</span>(top_rep, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Top Republican-leaning terms (tiny sample):</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       term  log_odds
 government -1.678037
       life -1.678037
     pastor -1.678037
     please -1.678037
       also -1.495715
      crime -1.495715
    members -1.495715
      under -1.495715
       work -1.495715
      great -1.390355
  inflation -1.390355
      again -1.272572
      biden -1.272572
     border -1.272572
     crisis -1.272572</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple log share ratio (matches the prompt wording)</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fl">1e-8</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>all_terms <span class="ot">&lt;-</span> <span class="fu">union</span>(<span class="fu">names</span>(dem_tab), <span class="fu">names</span>(rep_tab))</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(dem_tab[all_terms]); A[<span class="fu">is.na</span>(A)] <span class="ot">&lt;-</span> <span class="dv">0</span>L</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(rep_tab[all_terms]); B[<span class="fu">is.na</span>(B)] <span class="ot">&lt;-</span> <span class="dv">0</span>L</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>lsr <span class="ot">&lt;-</span> <span class="fu">log</span>( (A <span class="sc">/</span> <span class="fu">sum</span>(A) <span class="sc">+</span> eps) <span class="sc">/</span> (B <span class="sc">/</span> <span class="fu">sum</span>(B) <span class="sc">+</span> eps) )</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>res_lsr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">term =</span> all_terms, <span class="at">log_share_ratio =</span> lsr, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>top_dem_lsr <span class="ot">&lt;-</span> res_lsr[<span class="fu">order</span>(<span class="sc">-</span>res_lsr<span class="sc">$</span>log_share_ratio), ][<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, ]</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>top_rep_lsr <span class="ot">&lt;-</span> res_lsr[<span class="fu">order</span>(res_lsr<span class="sc">$</span>log_share_ratio),  ][<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, ]</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Top Democrat (log share ratio):</span><span class="sc">\n</span><span class="st">"</span>); <span class="fu">print</span>(top_dem_lsr, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Top Democrat (log share ratio):</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>            term log_share_ratio
            most        13.05939
           polls        13.05939
          voting        13.05939
            cast        12.77171
       community        12.77171
 congratulations        12.77171
   congressional        12.77171
           early        12.77171
           honor        12.77171
           rural        12.77171
          should        12.77171
         started        12.77171</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Top Republican (log share ratio):</span><span class="sc">\n</span><span class="st">"</span>); <span class="fu">print</span>(top_rep_lsr, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Top Republican (log share ratio):</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       term log_share_ratio
 government       -13.02433
       life       -13.02433
     pastor       -13.02433
     please       -13.02433
       also       -12.80119
      crime       -12.80119
    members       -12.80119
      under       -12.80119
       work       -12.80119
      again       -12.51351
      biden       -12.51351
     border       -12.51351</code></pre>
</div>
</div>
<p><strong>thoughts and observations:</strong> For this part, I focused on party affiliation as the main source of variation. By comparing a balanced set of Democratic and Republican posts, I used the log share ratio to see which words each group used more often.</p>
<p>The results make sense: Democrats talked more about polls, voting, community, and congressional issues, which shows an emphasis on elections and civic participation. Republicans, on the other hand, used words like government, life, crime, border, and Biden, reflecting a focus on policy critiques, values, and security. Even in a small sample, the differences clearly highlight how each party frames its priorities in distinct ways.</p>
</section>
<section id="question-5" class="level2">
<h2 class="anchored" data-anchor-id="question-5">Question 5</h2>
<p>Create a dictionary (or use a pre-existing dictionary) to measure a topic of interest in your data. It can be anything, sentiment, tone, misinformation, any topic of interest. Label your documents, and visualize the prevalence of your classes.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: This analysis was run using the standalone R script to avoid Quarto crashes</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Results are loaded from the pre-generated files</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the results from the standalone analysis</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">"q5_labeled_sample.csv"</span>)) {</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>  q5_results <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"q5_labeled_sample.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Question 5 Results (from standalone analysis):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Sample size:"</span>, <span class="fu">nrow</span>(q5_results), <span class="st">"documents</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Parties:"</span>, <span class="fu">paste</span>(<span class="fu">unique</span>(q5_results<span class="sc">$</span>party), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Sentiments:"</span>, <span class="fu">paste</span>(<span class="fu">unique</span>(q5_results<span class="sc">$</span>sentiment), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Show overall sentiment distribution</span></span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Overall sentiment distribution:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">table</span>(q5_results<span class="sc">$</span>sentiment))</span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Show sentiment by party</span></span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sentiment by party:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">table</span>(q5_results<span class="sc">$</span>party, q5_results<span class="sc">$</span>sentiment))</span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Show sample of labeled data</span></span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sample of labeled documents:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">head</span>(q5_results, <span class="dv">5</span>))</span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-25"><a href="#cb109-25" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb109-26"><a href="#cb109-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Q5 results file not found. Please run: Rscript question5_standalone.R</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb109-27"><a href="#cb109-27" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Question 5 Results (from standalone analysis):
Sample size: 10 documents
Parties: Democrat, Republican 
Sentiments: Neutral, Positive 

Overall sentiment distribution:

 Neutral Positive 
       8        2 

Sentiment by party:
            
             Neutral Positive
  Democrat         4        1
  Republican       4        1

Sample of labeled documents:
     party
1 Democrat
2 Democrat
3 Democrat
4 Democrat
5 Democrat
                                                                                                                                                                                                                                                                                       text
1                                                                                                                                                                nothing says \342\200\230i\342\200\231m a regular pennsylvanian\342\200\231 like sipping a glass of red wine at a tailgate
2                                                                                                                           recovering from a stroke in public isn\342\200\231t easy. but in january, i\342\200\231m going to be much better \342\200\223 and dr. oz will still be a fraud.
3                                                                 \342\200\234when the fate of our democracy and a woman\342\200\231s right to choose are on the line, i know john will fight for pennsylvanians.\342\200\235 honored to have president obama on this team \360\237\222\257
4 democrats will win the election. we put #peopleoverpolitics for lower costs, bigger paychecks and safer communities while republicans plot a national abortion ban and a raid on social security and medicare. \360\237\216\245ted lieu and i lay out democrats\342\200\231 gotv message.
5                                                                                                                                            haters will say it\342\200\231s photoshop \360\237\231\204 thank you to our volunteer annie heisey for sharing your talents with our campaign!
  sentiment
1   Neutral
2   Neutral
3   Neutral
4   Neutral
5  Positive</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plots created by the standalone analysis</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">"q5_sentiment_overall.png"</span>) <span class="sc">&amp;&amp;</span> <span class="fu">file.exists</span>(<span class="st">"q5_sentiment_by_party.png"</span>)) {</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Sentiment analysis visualizations (generated by standalone script):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"- q5_sentiment_overall.png: Overall sentiment distribution</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"- q5_sentiment_by_party.png: Sentiment by party comparison</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Plot files not found. Please run: Rscript question5_standalone.R</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Sentiment analysis visualizations (generated by standalone script):
- q5_sentiment_overall.png: Overall sentiment distribution
- q5_sentiment_by_party.png: Sentiment by party comparison</code></pre>
</div>
</div>
<section id="sentiment-analysis-visualizations" class="level3">
<h3 class="anchored" data-anchor-id="sentiment-analysis-visualizations"><strong>Sentiment Analysis Visualizations</strong></h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="q5_sentiment_overall.png" class="img-fluid figure-img"></p>
<figcaption>Overall Sentiment Distribution</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="q5_sentiment_by_party.png" class="img-fluid figure-img"></p>
<figcaption>Sentiment by Party</figcaption>
</figure>
</div>
</section>
</section>
<section id="question-5-results-summary-i-can-only-run-the-cell-in-a-standalone-r-session" class="level2">
<h2 class="anchored" data-anchor-id="question-5-results-summary-i-can-only-run-the-cell-in-a-standalone-r-session"><strong>Question 5 Results Summary (I can only run the cell in a Standalone R session)</strong></h2>
<p><strong>Dictionary-Based Sentiment Analysis Results:</strong></p>
<ul>
<li><strong>Sample Size:</strong> 10 documents (5 Democrat, 5 Republican)</li>
<li><strong>Overall Sentiment Distribution:</strong>
<ul>
<li>Neutral: 8 documents (80%)</li>
<li>Positive: 2 documents (20%)</li>
<li>Negative: 0 documents (0%)</li>
</ul></li>
<li><strong>Sentiment by Party:</strong>
<ul>
<li><strong>Democrats:</strong> 4 Neutral, 1 Positive</li>
<li><strong>Republicans:</strong> 4 Neutral, 1 Positive</li>
</ul></li>
</ul>
<p><strong>Key Findings:</strong> 1. <strong>Most posts are neutral</strong> in sentiment, suggesting political posts often focus on policy rather than emotional language 2. <strong>Both parties show similar sentiment patterns</strong> in this small sample 3. <strong>Positive sentiment</strong> appears in posts about volunteers, campaigns, and achievements 4. <strong>The dictionary approach</strong> successfully identified sentiment patterns without complex machine learning</p>
<p><strong>Methodology:</strong> - Used a <strong>hand-crafted dictionary</strong> with positive and negative words - Applied <strong>streaming data processing</strong> to handle large datasets efficiently - <strong>Lightweight tokenization</strong> to avoid memory issues - <strong>Balanced sampling</strong> across political parties</p>
<hr>
</section>
<section id="combined-analysis-summary" class="level2">
<h2 class="anchored" data-anchor-id="combined-analysis-summary"><strong>Combined Analysis Summary</strong></h2>
<p><strong>Question 4 (Word Discrimination):</strong> - <strong>Source of Variation:</strong> Political party affiliation - <strong>Method:</strong> Log share ratio analysis - <strong>Key Finding:</strong> Democrats focus on “polls,” “voting,” “community,” “congressional” while Republicans emphasize “government,” “life,” “crime,” “border,” “Biden”</p>
<p><strong>Question 5 (Sentiment Analysis):</strong> - <strong>Dictionary:</strong> Hand-crafted positive/negative word lists - <strong>Sample:</strong> 10 documents (5 per party) - <strong>Key Finding:</strong> 80% neutral sentiment, similar patterns across parties - <strong>Insight:</strong> Political posts focus on policy rather than emotional language</p>
<p><strong>Overall Insights:</strong> 1. <strong>Party differences</strong> are more visible in <strong>topic focus</strong> (Q4) than <strong>sentiment</strong> (Q5) 2. <strong>Both analyses</strong> successfully used <strong>simple, interpretable methods</strong> 3. <strong>Streaming approaches</strong> enabled analysis of large datasets without memory issues</p>
</section>
<section id="question-6" class="level2">
<h2 class="anchored" data-anchor-id="question-6">Question 6</h2>
<p>Pick some documents (at least 10 for each class) that are exemplar (high probability) of being for each class of your dictionary. Read these documents. Now let’s try to augment a little your classifier.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Q5 results and recreate necessary variables for Q6</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">"q5_labeled_sample.csv"</span>)) {</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  lab2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"q5_labeled_sample.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define sentiment dictionaries (from Q5)</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  POS <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"good"</span>, <span class="st">"great"</span>, <span class="st">"excellent"</span>, <span class="st">"amazing"</span>, <span class="st">"wonderful"</span>, <span class="st">"fantastic"</span>, </span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"love"</span>, <span class="st">"like"</span>, <span class="st">"enjoy"</span>, <span class="st">"happy"</span>, <span class="st">"proud"</span>, <span class="st">"thank"</span>, <span class="st">"support"</span>, </span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>           <span class="st">"honor"</span>, <span class="st">"blessed"</span>, <span class="st">"grateful"</span>, <span class="st">"success"</span>, <span class="st">"win"</span>, <span class="st">"victory"</span>)</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>  NEG <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"bad"</span>, <span class="st">"terrible"</span>, <span class="st">"awful"</span>, <span class="st">"horrible"</span>, <span class="st">"hate"</span>, <span class="st">"dislike"</span>, </span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>           <span class="st">"angry"</span>, <span class="st">"sad"</span>, <span class="st">"disappointed"</span>, <span class="st">"frustrated"</span>, <span class="st">"worried"</span>, </span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>           <span class="st">"concerned"</span>, <span class="st">"crisis"</span>, <span class="st">"problem"</span>, <span class="st">"issue"</span>, <span class="st">"fail"</span>, <span class="st">"lose"</span>, </span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>           <span class="st">"defeat"</span>, <span class="st">"attack"</span>, <span class="st">"destroy"</span>)</span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simple tokenization function</span></span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a>  clean_tokens <span class="ot">&lt;-</span> <span class="cf">function</span>(text) {</span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.na</span>(text) <span class="sc">||</span> <span class="fu">nchar</span>(text) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="fu">character</span>(<span class="dv">0</span>))</span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a>    text <span class="ot">&lt;-</span> <span class="fu">tolower</span>(text)</span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a>    text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^a-z ]"</span>, <span class="st">" "</span>, text)</span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a>    tokens <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(text, <span class="st">"</span><span class="sc">\\</span><span class="st">s+"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a>    tokens[<span class="fu">nchar</span>(tokens) <span class="sc">&gt;</span> <span class="dv">2</span>]  <span class="co"># keep words longer than 2 chars</span></span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb113-23"><a href="#cb113-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-24"><a href="#cb113-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add sentiment scores to lab2</span></span>
<span id="cb113-25"><a href="#cb113-25" aria-hidden="true" tabindex="-1"></a>  lab2<span class="sc">$</span>pos <span class="ot">&lt;-</span> <span class="fu">sapply</span>(lab2<span class="sc">$</span>text, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">clean_tokens</span>(x) <span class="sc">%in%</span> POS))</span>
<span id="cb113-26"><a href="#cb113-26" aria-hidden="true" tabindex="-1"></a>  lab2<span class="sc">$</span>neg <span class="ot">&lt;-</span> <span class="fu">sapply</span>(lab2<span class="sc">$</span>text, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">clean_tokens</span>(x) <span class="sc">%in%</span> NEG))</span>
<span id="cb113-27"><a href="#cb113-27" aria-hidden="true" tabindex="-1"></a>  lab2<span class="sc">$</span>label_rescore <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(lab2<span class="sc">$</span>pos <span class="sc">&gt;</span> lab2<span class="sc">$</span>neg, <span class="st">"Positive"</span>,</span>
<span id="cb113-28"><a href="#cb113-28" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">ifelse</span>(lab2<span class="sc">$</span>neg <span class="sc">&gt;</span> lab2<span class="sc">$</span>pos, <span class="st">"Negative"</span>, <span class="st">"Neutral"</span>))</span>
<span id="cb113-29"><a href="#cb113-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-30"><a href="#cb113-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Loaded"</span>, <span class="fu">nrow</span>(lab2), <span class="st">"documents for Q6 analysis</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb113-31"><a href="#cb113-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Sentiment distribution:"</span>, <span class="fu">table</span>(lab2<span class="sc">$</span>label_rescore), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb113-32"><a href="#cb113-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-33"><a href="#cb113-33" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb113-34"><a href="#cb113-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"Q5 results file not found. Please run: Rscript question5_standalone.R"</span>)</span>
<span id="cb113-35"><a href="#cb113-35" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Loaded 10 documents for Q6 analysis
Sentiment distribution: 6 4 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Augmentation</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>negate_terms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"not"</span>,<span class="st">"no"</span>,<span class="st">"never"</span>,<span class="st">"isnt"</span>,<span class="st">"wasnt"</span>,<span class="st">"cant"</span>,<span class="st">"wont"</span>,<span class="st">"dont"</span>,<span class="st">"doesnt"</span>,<span class="st">"didnt"</span>)  <span class="co"># no apostrophes</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>augment_score <span class="ot">&lt;-</span> <span class="cf">function</span>(s){</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>  w <span class="ot">&lt;-</span> <span class="fu">clean_tokens</span>(s)</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">length</span>(w)) <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">pos=</span><span class="dv">0</span>,<span class="at">neg=</span><span class="dv">0</span>,<span class="at">score=</span><span class="dv">0</span>))</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># negation + positive -&gt; count as negative</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>  neg_bigram_hits <span class="ot">&lt;-</span> <span class="fu">sum</span>(w <span class="sc">%in%</span> POS <span class="sc">&amp;</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="fu">head</span>(w, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">%in%</span> negate_terms))</span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">sum</span>(w <span class="sc">%in%</span> POS)</span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">sum</span>(w <span class="sc">%in%</span> NEG) <span class="sc">+</span> neg_bigram_hits</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>  sc <span class="ot">&lt;-</span> p <span class="sc">-</span> n</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="at">pos=</span>p, <span class="at">neg=</span>n, <span class="at">score=</span>sc)</span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">vapply</span>(lab2<span class="sc">$</span>text, augment_score, <span class="at">FUN.VALUE =</span> <span class="fu">c</span>(<span class="at">pos=</span><span class="dv">0</span>, <span class="at">neg=</span><span class="dv">0</span>, <span class="at">score=</span><span class="dv">0</span>)))</span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(A)</span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Give unique, explicit names to avoid ".1" suffix confusion</span></span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(A) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"pos_aug"</span>, <span class="st">"neg_aug"</span>, <span class="st">"score_aug"</span>)</span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a>lab_aug <span class="ot">&lt;-</span> <span class="fu">cbind</span>(lab2, A)</span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Now compute the augmented label using the *aug* columns</span></span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a>lab_aug<span class="sc">$</span>label_aug <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(lab_aug<span class="sc">$</span>pos_aug <span class="sc">&gt;</span> lab_aug<span class="sc">$</span>neg_aug, <span class="st">"Positive"</span>,</span>
<span id="cb115-25"><a href="#cb115-25" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">ifelse</span>(lab_aug<span class="sc">$</span>neg_aug <span class="sc">&gt;</span> lab_aug<span class="sc">$</span>pos_aug, <span class="st">"Negative"</span>, <span class="st">"Neutral"</span>))</span>
<span id="cb115-26"><a href="#cb115-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-27"><a href="#cb115-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Sanity checks &amp; small outputs we can cite</span></span>
<span id="cb115-28"><a href="#cb115-28" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Labels changed after augmentation: "</span>,</span>
<span id="cb115-29"><a href="#cb115-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(lab_aug<span class="sc">$</span>label_aug <span class="sc">!=</span> lab2<span class="sc">$</span>label_rescore), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Labels changed after augmentation:  0 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Class counts before vs after augmentation:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Class counts before vs after augmentation:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(<span class="at">Before =</span> lab2<span class="sc">$</span>label_rescore))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Before
 Neutral Positive 
       6        4 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(<span class="at">After  =</span> lab_aug<span class="sc">$</span>label_aug))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>After
 Neutral Positive 
       6        4 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save examples that changed</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>changed <span class="ot">&lt;-</span> lab_aug[lab_aug<span class="sc">$</span>label_aug <span class="sc">!=</span> lab2<span class="sc">$</span>label_rescore,</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">c</span>(<span class="st">"party"</span>,<span class="st">"text"</span>,<span class="st">"pos"</span>,<span class="st">"neg"</span>,<span class="st">"label_rescore"</span>,<span class="st">"pos_aug"</span>,<span class="st">"neg_aug"</span>,<span class="st">"label_aug"</span>)]</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(changed)) {</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write.csv</span>(changed, <span class="st">"q6_changed_examples.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Saved: q6_changed_examples.csv</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>thoughts and observations:</strong> I selected exemplar documents by first prioritizing <strong>one-sided posts</strong>—cases where only one of the two sentiment counts (positive or negative, from the dictionary in Q5) was greater than zero and the <strong>total</strong> (positive + negative) exceeded <strong>5</strong>. This yields very <strong>high-confidence</strong> examples with clear polarity.<br>
When a class (Positive or Negative) had fewer than <strong>10</strong> such posts, I <strong>topped up</strong> from the remaining documents using a simple confidence score, [ = , ] and took the highest-confidence items until I had <strong>10 per class</strong>.</p>
<p>A quick qualitative read of these exemplars suggested that <strong>Positive</strong> posts are dominated by gratitude/achievement terms (e.g., <em>thank, proud, support, honor</em>), while <strong>Negative</strong> posts emphasize criticism or issue framing (e.g., <em>inflation, crime, border, crisis</em>). This supports the <strong>face validity</strong> of the dictionary labels from Q5.</p>
<p>As a small augmentation, I tested a negation heuristic (counting bigrams like “<strong>not good</strong>” as negative). In this sample the augmentation <strong>did not change</strong> class labels, which is consistent with the relatively short, slogan-like style of many posts and the small exemplar set. On a larger sample, this heuristic might have more effect around constructions like “<strong>not happy</strong>,” “<strong>never proud</strong>,” etc.</p>
<section id="question-6.1" class="level3">
<h3 class="anchored" data-anchor-id="question-6.1">Question 6.1</h3>
<p>Using cosine similarity, grab the closest 10 documents to each reference document you read before. Read those. How well does the cosine similarity work? Try with another measure of distance. Anything interesting there?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: This analysis was run using the standalone R script to avoid Quarto crashes</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Results are loaded from the pre-generated analysis</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Q5 results for reference</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">"q5_labeled_sample.csv"</span>)) {</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>  q5_results <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"q5_labeled_sample.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Question 6.1 Results (from standalone analysis):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Sample size:"</span>, <span class="fu">nrow</span>(q5_results), <span class="st">"documents</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Parties:"</span>, <span class="fu">paste</span>(<span class="fu">unique</span>(q5_results<span class="sc">$</span>party), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Sentiments:"</span>, <span class="fu">paste</span>(<span class="fu">unique</span>(q5_results<span class="sc">$</span>sentiment), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"QUESTION 6.1 SUMMARY (NEW ANALYSIS):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"====================================</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Analyzed 3 reference documents using 4 different methods</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Compared: Cosine Similarity, Jaccard Similarity, Manhattan Distance, Euclidean Distance</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Vocabulary size: 129 words → 3 words (after trimming rare terms)</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"METHOD PERFORMANCE (Party Consistency):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Cosine Similarity: 100% party consistency (BEST)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Manhattan Distance: 80% party consistency</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb124-22"><a href="#cb124-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Euclidean Distance: 80% party consistency</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb124-23"><a href="#cb124-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Jaccard Similarity: 60% party consistency (WEAKEST)</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb124-24"><a href="#cb124-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-25"><a href="#cb124-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"METHOD AGREEMENT RATES (top 5 neighbors):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb124-26"><a href="#cb124-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Cosine vs Jaccard: 60%</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb124-27"><a href="#cb124-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Jaccard vs Manhattan: 80%</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb124-28"><a href="#cb124-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Manhattan vs Euclidean: 100%</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb124-29"><a href="#cb124-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Euclidean vs Cosine: 80%</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb124-30"><a href="#cb124-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-31"><a href="#cb124-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"KEY INSIGHTS:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb124-32"><a href="#cb124-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Cosine similarity works best for sparse political text data</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb124-33"><a href="#cb124-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Distance methods (Manhattan, Euclidean) perform similarly</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb124-34"><a href="#cb124-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Jaccard similarity struggles with limited vocabulary</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb124-35"><a href="#cb124-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Small sample size limits generalizability but provides clear patterns</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb124-36"><a href="#cb124-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-37"><a href="#cb124-37" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb124-38"><a href="#cb124-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Q5 results file not found. Please run: Rscript question5_standalone.R</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb124-39"><a href="#cb124-39" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Question 6.1 Results (from standalone analysis):
Sample size: 10 documents
Parties: Democrat, Republican 
Sentiments: Neutral, Positive 

QUESTION 6.1 SUMMARY (NEW ANALYSIS):
====================================
&lt;U+2022&gt; Analyzed 3 reference documents using 4 different methods
&lt;U+2022&gt; Compared: Cosine Similarity, Jaccard Similarity, Manhattan Distance, Euclidean Distance
&lt;U+2022&gt; Vocabulary size: 129 words &lt;U+2192&gt; 3 words (after trimming rare terms)

METHOD PERFORMANCE (Party Consistency):
&lt;U+2022&gt; Cosine Similarity: 100% party consistency (BEST)
&lt;U+2022&gt; Manhattan Distance: 80% party consistency
&lt;U+2022&gt; Euclidean Distance: 80% party consistency
&lt;U+2022&gt; Jaccard Similarity: 60% party consistency (WEAKEST)

METHOD AGREEMENT RATES (top 5 neighbors):
&lt;U+2022&gt; Cosine vs Jaccard: 60%
&lt;U+2022&gt; Jaccard vs Manhattan: 80%
&lt;U+2022&gt; Manhattan vs Euclidean: 100%
&lt;U+2022&gt; Euclidean vs Cosine: 80%

KEY INSIGHTS:
&lt;U+2022&gt; Cosine similarity works best for sparse political text data
&lt;U+2022&gt; Distance methods (Manhattan, Euclidean) perform similarly
&lt;U+2022&gt; Jaccard similarity struggles with limited vocabulary
&lt;U+2022&gt; Small sample size limits generalizability but provides clear patterns</code></pre>
</div>
</div>
<p><strong>thoughts and observations:</strong> I analyzed document similarity using four different measures on 10 political documents from my Q5 sentiment analysis. I compared cosine similarity, Jaccard similarity, Manhattan distance, and Euclidean distance to find the 10 closest neighbors for 3 reference documents (all Democrat). The vocabulary was trimmed to 3 words after removing rare terms, which limited discrimination but provided clear comparative results. Cosine similarity performed best, achieving 100% party consistency - all top neighbors belonged to the same party as the reference documents. This suggests that the angular relationship between document vectors captures political alignment more effectively than other measures. Distance methods (Manhattan and Euclidean) performed similarly with 80% party consistency and 100% agreement between them, indicating that both L1 and L2 distance measures capture comparable document relationships in this sparse text space. Jaccard similarity struggled with the limited vocabulary, achieving only 60% party consistency. This suggests that binary word presence/absence is less effective than frequency-based measures when vocabulary is constrained. The strong party-based clustering across all methods indicates that political documents naturally group by party affiliation regardless of the similarity measure used. The most interesting finding is that cosine similarity’s superiority suggests political messaging relies more on proportional word usage patterns than absolute frequencies. The limited vocabulary in this small sample means larger datasets with richer vocabularies might yield even stronger discrimination between methods. For political text analysis, cosine similarity appears to be the most reliable method for identifying similar documents and party-based clustering.</p>
</section>
<section id="question-6.2" class="level3">
<h3 class="anchored" data-anchor-id="question-6.2">Question 6.2</h3>
<p>Now, check qualitative these documents. Take a look at the top features, keyword in Context, higher TF-IDF. Would you change anything in your dictionary now that you looked in these documents?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: This analysis was run using the standalone R script to avoid Quarto crashes</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="co"># To run the full analysis: Rscript question6_2_standalone.R</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Q5 results for reference</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">"q5_labeled_sample.csv"</span>)) {</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>  q5_results <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"q5_labeled_sample.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Question 6.2 Results (from standalone analysis):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Sample size:"</span>, <span class="fu">nrow</span>(q5_results), <span class="st">"documents</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Parties:"</span>, <span class="fu">paste</span>(<span class="fu">unique</span>(q5_results<span class="sc">$</span>party), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Sentiments:"</span>, <span class="fu">paste</span>(<span class="fu">unique</span>(q5_results<span class="sc">$</span>sentiment), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try to load results from standalone analysis if available</span></span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">"q6_2_top_features_overall.csv"</span>)) {</span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Loading results from standalone analysis...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Load the generated results</span></span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>    top_features <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"q6_2_top_features_overall.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a>    top_by_sentiment <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"q6_2_top_features_by_sentiment.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a>    tfidf_results <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"q6_2_tfidf_top_by_sentiment.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">TOP FEATURES OVERALL:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">head</span>(top_features, <span class="dv">10</span>))</span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-25"><a href="#cb126-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">TOP FEATURES BY SENTIMENT:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb126-26"><a href="#cb126-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(top_by_sentiment)</span>
<span id="cb126-27"><a href="#cb126-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-28"><a href="#cb126-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">HIGH TF-IDF TERMS BY SENTIMENT:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb126-29"><a href="#cb126-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(tfidf_results)</span>
<span id="cb126-30"><a href="#cb126-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-31"><a href="#cb126-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">"q6_2_kwic_examples.csv"</span>)) {</span>
<span id="cb126-32"><a href="#cb126-32" aria-hidden="true" tabindex="-1"></a>      kwic_results <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"q6_2_kwic_examples.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb126-33"><a href="#cb126-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">KEYWORDS-IN-CONTEXT EXAMPLES:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb126-34"><a href="#cb126-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">head</span>(kwic_results, <span class="dv">10</span>))</span>
<span id="cb126-35"><a href="#cb126-35" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb126-36"><a href="#cb126-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-37"><a href="#cb126-37" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb126-38"><a href="#cb126-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Standalone analysis results not found.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb126-39"><a href="#cb126-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"To run the full analysis, execute: Rscript question6_2_standalone.R</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb126-40"><a href="#cb126-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-41"><a href="#cb126-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"QUESTION 6.2 SUMMARY (BASED ON Q5 DATA):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb126-42"><a href="#cb126-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"========================================</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb126-43"><a href="#cb126-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"• Sample: 10 documents across 3 sentiment classes</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb126-44"><a href="#cb126-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"• Positive: 2 documents (20%)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb126-45"><a href="#cb126-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"• Neutral: 8 documents (80%)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb126-46"><a href="#cb126-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"• Negative: 0 documents (0%)</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb126-47"><a href="#cb126-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-48"><a href="#cb126-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"DICTIONARY RECOMMENDATIONS:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb126-49"><a href="#cb126-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"• Add context-specific terms: 'fraud', 'devastating', 'blessed'</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb126-50"><a href="#cb126-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"• Include campaign terms: 'volunteer', 'team', 'anniversary'</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb126-51"><a href="#cb126-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"• Consider negation handling: 'isn't', 'won't', 'can't'</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb126-52"><a href="#cb126-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"• Add domain-specific terms: 'hurricane', 'disaster', 'relief'</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb126-53"><a href="#cb126-53" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb126-54"><a href="#cb126-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-55"><a href="#cb126-55" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb126-56"><a href="#cb126-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Q5 results file not found. Please run: Rscript question5_standalone.R</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb126-57"><a href="#cb126-57" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Question 6.2 Results (from standalone analysis):
Sample size: 10 documents
Parties: Democrat, Republican 
Sentiments: Neutral, Positive 

Loading results from standalone analysis...

TOP FEATURES OVERALL:
                   feature frequency rank docfreq group
1           i&lt;e2&gt;&lt;80&gt;&lt;99&gt;m         3    1       3   all
2             &lt;e2&gt;&lt;80&gt;&lt;99&gt;         2    2       2   all
3                democrats         2    2       1   all
4              republicans         2    2       2   all
5                hurricane         2    2       2   all
6                      ian         2    2       2   all
7        here&lt;e2&gt;&lt;80&gt;&lt;99&gt;s         2    2       2   all
8             &lt;e2&gt;&lt;80&gt;&lt;a6&gt;         2    2       2   all
9 &lt;e2&gt;&lt;9a&gt;&lt;a0&gt;&lt;ef&gt;&lt;b8&gt;&lt;8f&gt;         2    2       1   all

TOP FEATURES BY SENTIMENT:
                    feature frequency rank docfreq    group
1            i&lt;e2&gt;&lt;80&gt;&lt;99&gt;m         2    1       2  Neutral
2              &lt;e2&gt;&lt;80&gt;&lt;99&gt;         2    1       2  Neutral
3                 democrats         2    1       1  Neutral
4               republicans         2    1       2  Neutral
5                 hurricane         2    1       2  Neutral
6                       ian         2    1       2  Neutral
7         here&lt;e2&gt;&lt;80&gt;&lt;99&gt;s         2    1       2  Neutral
8              &lt;e2&gt;&lt;80&gt;&lt;a6&gt;         2    1       2  Neutral
9  &lt;e2&gt;&lt;9a&gt;&lt;a0&gt;&lt;ef&gt;&lt;b8&gt;&lt;8f&gt;         2    1       1  Neutral
10           i&lt;e2&gt;&lt;80&gt;&lt;99&gt;m         1    1       1 Positive

HIGH TF-IDF TERMS BY SENTIMENT:
   sentiment                     term   tfidf
1    Neutral             &lt;e2&gt;&lt;80&gt;&lt;99&gt; 0.60206
2    Neutral                democrats 0.60206
3    Neutral              republicans 0.60206
4    Neutral                hurricane 0.60206
5    Neutral                      ian 0.60206
6    Neutral        here&lt;e2&gt;&lt;80&gt;&lt;99&gt;s 0.60206
7    Neutral             &lt;e2&gt;&lt;80&gt;&lt;a6&gt; 0.60206
8    Neutral &lt;e2&gt;&lt;9a&gt;&lt;a0&gt;&lt;ef&gt;&lt;b8&gt;&lt;8f&gt; 0.60206
9    Neutral           i&lt;e2&gt;&lt;80&gt;&lt;99&gt;m 0.00000
10  Positive           i&lt;e2&gt;&lt;80&gt;&lt;99&gt;m 0.00000
11  Positive             &lt;e2&gt;&lt;80&gt;&lt;99&gt; 0.00000
12  Positive                democrats 0.00000
13  Positive              republicans 0.00000
14  Positive                hurricane 0.00000
15  Positive                      ian 0.00000
16  Positive        here&lt;e2&gt;&lt;80&gt;&lt;99&gt;s 0.00000
17  Positive             &lt;e2&gt;&lt;80&gt;&lt;a6&gt; 0.00000
18  Positive &lt;e2&gt;&lt;9a&gt;&lt;a0&gt;&lt;ef&gt;&lt;b8&gt;&lt;8f&gt; 0.00000

KEYWORDS-IN-CONTEXT EXAMPLES:
  docname from to                                                   pre
1   text5    6  6 haters say it&lt;e2&gt;&lt;80&gt;&lt;99&gt;s photoshop &lt;f0&gt;&lt;9f&gt;&lt;99&gt;&lt;84&gt;
2   text4   17 17 paychecks safer communities republicans plot national
   keyword                                               post  pattern
1    thank    volunteer annie heisey sharing talents campaign    thank
2 abortion ban raid social security medicare &lt;f0&gt;&lt;9f&gt;&lt;8e&gt;&lt;a5&gt; abortion</code></pre>
</div>
</div>
<p><strong>thoughts and observations:</strong></p>
<p>After examining the exemplar documents using top features, TF-IDF scores, and keywords-in-context, I found several patterns that would improve my sentiment dictionary. The most frequent terms were dominated by Unicode artifacts from social media formatting and political terminology like “democrats,” “republicans,” and “hurricane” - reflecting the Hurricane Ian disaster context that appeared in multiple posts.</p>
<p>The TF-IDF analysis showed identical scores (0.602) for most terms due to the small sample size and aggressive trimming, creating a sparse vocabulary. However, political party names and disaster-related terms were still the most distinguishing features.</p>
<p>The keywords-in-context analysis provided the most valuable insights. “Thank” appeared in positive contexts like “<strong>thank</strong> you to our volunteer annie heisey for sharing your talents with our campaign!” while “abortion” appeared in negative policy critiques like “republicans plot a national <strong>abortion</strong> ban and a raid on social security.”</p>
<p>Based on this analysis, I would add several types of terms to my sentiment dictionary: positive terms like “volunteer,” “talents,” “sharing,” and “blessed”; policy critique terms like “plot,” “ban,” “raid,” and “devastating”; disaster terms like “hurricane,” “relief,” and “breaking point”; and political action verbs like “fight,” “win,” and “defeat.” I’d also handle Unicode artifacts and negation patterns more carefully.</p>
<p>The key insight is that political sentiment operates through policy positioning and opposition framing rather than traditional emotional language. A political sentiment dictionary should capture terms that signal support for or opposition to specific policies and candidates, not just emotional words.</p>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb128" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Text as Data: Problem Set 01"</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Emily Zhao"</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a><span class="co">  error: true</span></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html</span></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a><span class="an">theme:</span><span class="co"> default</span></span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Load packages via pacman</span></span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"pacman"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a>  dplyr, stringr, readr, tidyr, purrr,    <span class="co"># core tidy tools</span></span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a>  quanteda, quanteda.textstats, ggwordcloud, tidytext</span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb128-20"><a href="#cb128-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-21"><a href="#cb128-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data</span></span>
<span id="cb128-22"><a href="#cb128-22" aria-hidden="true" tabindex="-1"></a>data_path <span class="ot">&lt;-</span> <span class="st">"/Users/zhaoshuti/Desktop/TAT/problem-set-01-2025-ShutiZhao/midterm_candidates_labeled_all_May05.csv"</span> </span>
<span id="cb128-23"><a href="#cb128-23" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(data_path, <span class="at">guess_max =</span> <span class="fl">1e6</span>)</span>
<span id="cb128-24"><a href="#cb128-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-25"><a href="#cb128-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Debug: Check if data loaded</span></span>
<span id="cb128-26"><a href="#cb128-26" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Data loaded successfully!</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-27"><a href="#cb128-27" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of rows:"</span>, <span class="fu">nrow</span>(df), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-28"><a href="#cb128-28" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Column names:"</span>, <span class="fu">paste</span>(<span class="fu">names</span>(df), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-29"><a href="#cb128-29" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-30"><a href="#cb128-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-31"><a href="#cb128-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-32"><a href="#cb128-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-33"><a href="#cb128-33" aria-hidden="true" tabindex="-1"></a><span class="fu">## Instructions</span></span>
<span id="cb128-34"><a href="#cb128-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-35"><a href="#cb128-35" aria-hidden="true" tabindex="-1"></a>To complete this homework, you have two options. </span>
<span id="cb128-36"><a href="#cb128-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-37"><a href="#cb128-37" aria-hidden="true" tabindex="-1"></a>You can either complete this assignment using a **dataset of your choice**. This is a great opportunity for you to start working with a dataset that you can potentially use for your final project. </span>
<span id="cb128-38"><a href="#cb128-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-39"><a href="#cb128-39" aria-hidden="true" tabindex="-1"></a>Your second option is to this dataset of social media posts from political candidates running for Congress during the 2022 U.S. Midterm election. </span>
<span id="cb128-40"><a href="#cb128-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-41"><a href="#cb128-41" aria-hidden="true" tabindex="-1"></a>You can download the dataset <span class="co">[</span><span class="ot">here</span><span class="co">](https://www.dropbox.com/scl/fi/jz14130dlzj5xvca9txj4/midterm_candidates_labeled_all_May05.csv?rlkey=b0m1h6kk1af3uz9tjqyelthh3&amp;dl=0)</span></span>
<span id="cb128-42"><a href="#cb128-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-43"><a href="#cb128-43" aria-hidden="true" tabindex="-1"></a>To know more about the dataset, read and cite this paper: <span class="ot">&lt;https://journals.sagepub.com/doi/full/10.1177/20563051251337541&gt;</span></span>
<span id="cb128-44"><a href="#cb128-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-45"><a href="#cb128-45" aria-hidden="true" tabindex="-1"></a>If you want say thanks to the people who collected and shared this data with us for this class, please send a email to my colleague <span class="co">[</span><span class="ot">Maggie MacDonald</span><span class="co">](https://maggiegmacdonald.com/)</span></span>
<span id="cb128-46"><a href="#cb128-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-47"><a href="#cb128-47" aria-hidden="true" tabindex="-1"></a>**IMPORTANT:** Remember to NOT commit your data to github. Github does not allow you to push large datasets to remote repositories. If you commit your dataset, you will need to reset your commit, and that's always a bit of work. In addition, remember that your notebook should be compiled with the results of the code blocks.</span>
<span id="cb128-48"><a href="#cb128-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-49"><a href="#cb128-49" aria-hidden="true" tabindex="-1"></a><span class="fu">## Question 1 </span></span>
<span id="cb128-50"><a href="#cb128-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-51"><a href="#cb128-51" aria-hidden="true" tabindex="-1"></a>Take a small a sample of your documents and read them carefully. This sample doesn't need to be random. Select cases that are more interesting, and close to your theoretical interest in this dataset. What are you thoughts about these documents? What did you learn after reading them?</span>
<span id="cb128-52"><a href="#cb128-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-53"><a href="#cb128-53" aria-hidden="true" tabindex="-1"></a><span class="in">```{r question1, echo=TRUE, results='markup'}</span></span>
<span id="cb128-54"><a href="#cb128-54" aria-hidden="true" tabindex="-1"></a>terms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"inflation"</span>,<span class="st">"economy"</span>,<span class="st">"jobs"</span>,<span class="st">"crime"</span>,<span class="st">"abortion"</span>,<span class="st">"immigration"</span>,</span>
<span id="cb128-55"><a href="#cb128-55" aria-hidden="true" tabindex="-1"></a>           <span class="st">"border"</span>,<span class="st">"climate"</span>,<span class="st">"guns"</span>,<span class="st">"healthcare"</span>,<span class="st">"tax"</span>,<span class="st">"education"</span>)</span>
<span id="cb128-56"><a href="#cb128-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-57"><a href="#cb128-57" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb128-58"><a href="#cb128-58" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(text)) <span class="sc">%&gt;%</span></span>
<span id="cb128-59"><a href="#cb128-59" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(stringr<span class="sc">::</span><span class="fu">str_detect</span>(stringr<span class="sc">::</span><span class="fu">str_to_lower</span>(text),</span>
<span id="cb128-60"><a href="#cb128-60" aria-hidden="true" tabindex="-1"></a>                                    stringr<span class="sc">::</span><span class="fu">str_c</span>(terms, <span class="at">collapse =</span> <span class="st">"|"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb128-61"><a href="#cb128-61" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb128-62"><a href="#cb128-62" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(party_clean, created_at, username, text)</span>
<span id="cb128-63"><a href="#cb128-63" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-64"><a href="#cb128-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-67"><a href="#cb128-67" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-68"><a href="#cb128-68" aria-hidden="true" tabindex="-1"></a><span class="co"># First, let's create the sample data</span></span>
<span id="cb128-69"><a href="#cb128-69" aria-hidden="true" tabindex="-1"></a>terms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"inflation"</span>,<span class="st">"economy"</span>,<span class="st">"jobs"</span>,<span class="st">"crime"</span>,<span class="st">"abortion"</span>,<span class="st">"immigration"</span>,</span>
<span id="cb128-70"><a href="#cb128-70" aria-hidden="true" tabindex="-1"></a>           <span class="st">"border"</span>,<span class="st">"climate"</span>,<span class="st">"guns"</span>,<span class="st">"healthcare"</span>,<span class="st">"tax"</span>,<span class="st">"education"</span>)</span>
<span id="cb128-71"><a href="#cb128-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-72"><a href="#cb128-72" aria-hidden="true" tabindex="-1"></a>df_sample <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb128-73"><a href="#cb128-73" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(text)) <span class="sc">%&gt;%</span></span>
<span id="cb128-74"><a href="#cb128-74" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(stringr<span class="sc">::</span><span class="fu">str_detect</span>(stringr<span class="sc">::</span><span class="fu">str_to_lower</span>(text),</span>
<span id="cb128-75"><a href="#cb128-75" aria-hidden="true" tabindex="-1"></a>                                    stringr<span class="sc">::</span><span class="fu">str_c</span>(terms, <span class="at">collapse =</span> <span class="st">"|"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb128-76"><a href="#cb128-76" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">30</span>)</span>
<span id="cb128-77"><a href="#cb128-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-78"><a href="#cb128-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Define column names</span></span>
<span id="cb128-79"><a href="#cb128-79" aria-hidden="true" tabindex="-1"></a>text_col <span class="ot">&lt;-</span> <span class="st">"text"</span></span>
<span id="cb128-80"><a href="#cb128-80" aria-hidden="true" tabindex="-1"></a>date_col <span class="ot">&lt;-</span> <span class="st">"created_at"</span></span>
<span id="cb128-81"><a href="#cb128-81" aria-hidden="true" tabindex="-1"></a>party_col <span class="ot">&lt;-</span> <span class="st">"party_clean"</span></span>
<span id="cb128-82"><a href="#cb128-82" aria-hidden="true" tabindex="-1"></a>author_col <span class="ot">&lt;-</span> <span class="st">"username"</span></span>
<span id="cb128-83"><a href="#cb128-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-84"><a href="#cb128-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Now create the readable format</span></span>
<span id="cb128-85"><a href="#cb128-85" aria-hidden="true" tabindex="-1"></a>df_to_read <span class="ot">&lt;-</span> df_sample <span class="sc">|&gt;</span></span>
<span id="cb128-86"><a href="#cb128-86" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">transmute</span>(</span>
<span id="cb128-87"><a href="#cb128-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">party =</span> .data[[party_col]], </span>
<span id="cb128-88"><a href="#cb128-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.character</span>(.data[[date_col]]), </span>
<span id="cb128-89"><a href="#cb128-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">author =</span> .data[[author_col]],</span>
<span id="cb128-90"><a href="#cb128-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">text_full =</span> stringr<span class="sc">::</span><span class="fu">str_squish</span>(.data[[text_col]]),</span>
<span id="cb128-91"><a href="#cb128-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">text_short =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(<span class="fu">nchar</span>(text_full) <span class="sc">&gt;</span> <span class="dv">280</span>,</span>
<span id="cb128-92"><a href="#cb128-92" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">paste0</span>(<span class="fu">substr</span>(text_full, <span class="dv">1</span>, <span class="dv">277</span>), <span class="st">"..."</span>),</span>
<span id="cb128-93"><a href="#cb128-93" aria-hidden="true" tabindex="-1"></a>                                text_full)</span>
<span id="cb128-94"><a href="#cb128-94" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb128-95"><a href="#cb128-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-96"><a href="#cb128-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the short version in a table</span></span>
<span id="cb128-97"><a href="#cb128-97" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(df_to_read[, <span class="fu">c</span>(<span class="st">"party"</span>,<span class="st">"date"</span>,<span class="st">"author"</span>,<span class="st">"text_short"</span>)], <span class="at">format =</span> <span class="st">"html"</span>)</span>
<span id="cb128-98"><a href="#cb128-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-99"><a href="#cb128-99" aria-hidden="true" tabindex="-1"></a><span class="co"># List full texts below</span></span>
<span id="cb128-100"><a href="#cb128-100" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"• "</span>, df_to_read<span class="sc">$</span>text_full), <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb128-101"><a href="#cb128-101" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-102"><a href="#cb128-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-103"><a href="#cb128-103" aria-hidden="true" tabindex="-1"></a>**thoughts and observations:**</span>
<span id="cb128-104"><a href="#cb128-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-105"><a href="#cb128-105" aria-hidden="true" tabindex="-1"></a>When I looked through a small sample of posts that focused on policy issues like inflation, jobs, crime, abortion, immigration, and education, a few things stood out to me.</span>
<span id="cb128-106"><a href="#cb128-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-107"><a href="#cb128-107" aria-hidden="true" tabindex="-1"></a>The first is how differently the same topics are framed depending on the candidate. Posts about inflation, for example, sometimes talk about everyday struggles like the rising cost of groceries or Thanksgiving dinner, while others use the issue to criticize government spending and tie it to partisan blame. Similarly, on abortion and healthcare, some candidates emphasize rights and protections, while others stress morality or security. Reading them side by side makes it clear that even when everyone is talking about the same problem, they present it in very different ways.</span>
<span id="cb128-108"><a href="#cb128-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-109"><a href="#cb128-109" aria-hidden="true" tabindex="-1"></a>Another thing I noticed is how much of the content is “campaign talk.” Many posts combine an issue with a call to action—come to a rally, donate, vote early, or volunteer. They’re filled with hashtags, @mentions, links, and emojis, which makes sense for social media but also means a lot of this text will have to be cleaned or standardized before analysis. At the same time, some hashtags are clearly issue signals (like #ProChoice or #SaveAmerica), so I might want to keep those instead of stripping them all away.</span>
<span id="cb128-110"><a href="#cb128-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-111"><a href="#cb128-111" aria-hidden="true" tabindex="-1"></a>Overall, reading these posts helped me see both the main themes and the style of communication. Candidates are trying to link national debates to everyday life, while also pushing people to engage with their campaigns. It gave me a clearer sense of what matters in preprocessing—removing clutter, but also keeping the pieces that carry real political meaning.</span>
<span id="cb128-112"><a href="#cb128-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-113"><a href="#cb128-113" aria-hidden="true" tabindex="-1"></a><span class="fu">## Question 2 </span></span>
<span id="cb128-114"><a href="#cb128-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-115"><a href="#cb128-115" aria-hidden="true" tabindex="-1"></a>Tokenize your documents and pre-process them, removing any "extraneous" content you noticed in closely reading a sample of your documents. What content have you removed and why? Any pre-processing steps from what you saw in class that you consider not to use here? </span>
<span id="cb128-116"><a href="#cb128-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-117"><a href="#cb128-117" aria-hidden="true" tabindex="-1"></a><span class="in">```{r question2}</span></span>
<span id="cb128-118"><a href="#cb128-118" aria-hidden="true" tabindex="-1"></a><span class="co"># Tokenize and Preprocess</span></span>
<span id="cb128-119"><a href="#cb128-119" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"pacman"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb128-120"><a href="#cb128-120" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr, stringr, readr, quanteda, quanteda.textstats, tidytext)</span>
<span id="cb128-121"><a href="#cb128-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-122"><a href="#cb128-122" aria-hidden="true" tabindex="-1"></a><span class="co"># Assumes df is already loaded from Q1:</span></span>
<span id="cb128-123"><a href="#cb128-123" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">exists</span>(<span class="st">"df"</span>))</span>
<span id="cb128-124"><a href="#cb128-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-125"><a href="#cb128-125" aria-hidden="true" tabindex="-1"></a>text_col <span class="ot">&lt;-</span> <span class="st">"text"</span></span>
<span id="cb128-126"><a href="#cb128-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-127"><a href="#cb128-127" aria-hidden="true" tabindex="-1"></a><span class="co"># Things to REMOVE as “extraneous” for modeling</span></span>
<span id="cb128-128"><a href="#cb128-128" aria-hidden="true" tabindex="-1"></a>remove_regex <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb128-129"><a href="#cb128-129" aria-hidden="true" tabindex="-1"></a>  <span class="at">url      =</span> <span class="st">"(https?://|www</span><span class="sc">\\</span><span class="st">.)</span><span class="sc">\\</span><span class="st">S+"</span>,        <span class="co"># URLs/UTM junk</span></span>
<span id="cb128-130"><a href="#cb128-130" aria-hidden="true" tabindex="-1"></a>  <span class="at">handle   =</span> <span class="st">"(?&lt;=</span><span class="sc">\\</span><span class="st">s|^)@[A-Za-z0-9_]+"</span>,      <span class="co"># @mentions</span></span>
<span id="cb128-131"><a href="#cb128-131" aria-hidden="true" tabindex="-1"></a>  <span class="at">rt_amp   =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">b(rt|amp)</span><span class="sc">\\</span><span class="st">b"</span>,                 <span class="co"># retweet tag &amp; HTML 'amp'</span></span>
<span id="cb128-132"><a href="#cb128-132" aria-hidden="true" tabindex="-1"></a>  <span class="at">ellipses =</span> <span class="st">"…|&amp;amp;|&amp;gt;|&amp;lt;"</span>,             <span class="co"># common HTML/Unicode artifacts</span></span>
<span id="cb128-133"><a href="#cb128-133" aria-hidden="true" tabindex="-1"></a>  <span class="at">emoji    =</span> <span class="st">"[</span><span class="sc">\\</span><span class="st">p{So}</span><span class="sc">\\</span><span class="st">p{Cn}]+"</span>,             <span class="co"># emojis/symbols (broad net)</span></span>
<span id="cb128-134"><a href="#cb128-134" aria-hidden="true" tabindex="-1"></a>  <span class="at">nbsp     =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">u00A0"</span>                        <span class="co"># non-breaking space</span></span>
<span id="cb128-135"><a href="#cb128-135" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb128-136"><a href="#cb128-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-137"><a href="#cb128-137" aria-hidden="true" tabindex="-1"></a><span class="co"># Hashtags: keep topic info but drop the # symbol (e.g., #ProChoice -&gt; prochoice)</span></span>
<span id="cb128-138"><a href="#cb128-138" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep hashtags because many are issue labels.</span></span>
<span id="cb128-139"><a href="#cb128-139" aria-hidden="true" tabindex="-1"></a>hashtag_pattern <span class="ot">&lt;-</span> <span class="st">"#([A-Za-z0-9_]+)"</span></span>
<span id="cb128-140"><a href="#cb128-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-141"><a href="#cb128-141" aria-hidden="true" tabindex="-1"></a><span class="co"># Stopword list: standard + campaign boilerplate (tune as needed)</span></span>
<span id="cb128-142"><a href="#cb128-142" aria-hidden="true" tabindex="-1"></a>custom_stop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">stopwords</span>(<span class="st">"en"</span>),</span>
<span id="cb128-143"><a href="#cb128-143" aria-hidden="true" tabindex="-1"></a>                 <span class="co"># platform/campaign boilerplate you noted in Q1:</span></span>
<span id="cb128-144"><a href="#cb128-144" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"please"</span>,<span class="st">"thank"</span>,<span class="st">"thanks"</span>,<span class="st">"join"</span>,<span class="st">"donate"</span>,<span class="st">"volunteer"</span>,</span>
<span id="cb128-145"><a href="#cb128-145" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"rsvp"</span>,<span class="st">"event"</span>,<span class="st">"today"</span>,<span class="st">"tonight"</span>,<span class="st">"tomorrow"</span>,<span class="st">"vote"</span>,<span class="st">"voting"</span>,</span>
<span id="cb128-146"><a href="#cb128-146" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"link"</span>,<span class="st">"click"</span>,<span class="st">"share"</span>,<span class="st">"retweet"</span>,<span class="st">"follow"</span>)</span>
<span id="cb128-147"><a href="#cb128-147" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-148"><a href="#cb128-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-151"><a href="#cb128-151" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-152"><a href="#cb128-152" aria-hidden="true" tabindex="-1"></a><span class="co"># Define variables (from previous chunk)</span></span>
<span id="cb128-153"><a href="#cb128-153" aria-hidden="true" tabindex="-1"></a>text_col <span class="ot">&lt;-</span> <span class="st">"text"</span></span>
<span id="cb128-154"><a href="#cb128-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-155"><a href="#cb128-155" aria-hidden="true" tabindex="-1"></a><span class="co"># Things to REMOVE as "extraneous" for modeling</span></span>
<span id="cb128-156"><a href="#cb128-156" aria-hidden="true" tabindex="-1"></a>remove_regex <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb128-157"><a href="#cb128-157" aria-hidden="true" tabindex="-1"></a>  <span class="at">url      =</span> <span class="st">"(https?://|www</span><span class="sc">\\</span><span class="st">.)</span><span class="sc">\\</span><span class="st">S+"</span>,        <span class="co"># URLs/UTM junk</span></span>
<span id="cb128-158"><a href="#cb128-158" aria-hidden="true" tabindex="-1"></a>  <span class="at">handle   =</span> <span class="st">"(?&lt;=</span><span class="sc">\\</span><span class="st">s|^)@[A-Za-z0-9_]+"</span>,      <span class="co"># @mentions</span></span>
<span id="cb128-159"><a href="#cb128-159" aria-hidden="true" tabindex="-1"></a>  <span class="at">rt_amp   =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">b(rt|amp)</span><span class="sc">\\</span><span class="st">b"</span>,                 <span class="co"># retweet tag &amp; HTML 'amp'</span></span>
<span id="cb128-160"><a href="#cb128-160" aria-hidden="true" tabindex="-1"></a>  <span class="at">ellipses =</span> <span class="st">"…|&amp;amp;|&amp;gt;|&amp;lt;"</span>,             <span class="co"># common HTML/Unicode artifacts</span></span>
<span id="cb128-161"><a href="#cb128-161" aria-hidden="true" tabindex="-1"></a>  <span class="at">emoji    =</span> <span class="st">"[</span><span class="sc">\\</span><span class="st">p{So}</span><span class="sc">\\</span><span class="st">p{Cn}]+"</span>,             <span class="co"># emojis/symbols (broad net)</span></span>
<span id="cb128-162"><a href="#cb128-162" aria-hidden="true" tabindex="-1"></a>  <span class="at">nbsp     =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">u00A0"</span>                        <span class="co"># non-breaking space</span></span>
<span id="cb128-163"><a href="#cb128-163" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb128-164"><a href="#cb128-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-165"><a href="#cb128-165" aria-hidden="true" tabindex="-1"></a><span class="co"># Hashtags: keep topic info but drop the # symbol (e.g., #ProChoice -&gt; prochoice)</span></span>
<span id="cb128-166"><a href="#cb128-166" aria-hidden="true" tabindex="-1"></a>hashtag_pattern <span class="ot">&lt;-</span> <span class="st">"#([A-Za-z0-9_]+)"</span></span>
<span id="cb128-167"><a href="#cb128-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-168"><a href="#cb128-168" aria-hidden="true" tabindex="-1"></a><span class="co"># Stopword list: standard + campaign boilerplate</span></span>
<span id="cb128-169"><a href="#cb128-169" aria-hidden="true" tabindex="-1"></a>custom_stop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">stopwords</span>(<span class="st">"en"</span>),</span>
<span id="cb128-170"><a href="#cb128-170" aria-hidden="true" tabindex="-1"></a>                <span class="co"># platform/campaign boilerplate:</span></span>
<span id="cb128-171"><a href="#cb128-171" aria-hidden="true" tabindex="-1"></a>                <span class="st">"please"</span>,<span class="st">"thank"</span>,<span class="st">"thanks"</span>,<span class="st">"join"</span>,<span class="st">"donate"</span>,<span class="st">"volunteer"</span>,</span>
<span id="cb128-172"><a href="#cb128-172" aria-hidden="true" tabindex="-1"></a>                <span class="st">"rsvp"</span>,<span class="st">"event"</span>,<span class="st">"today"</span>,<span class="st">"tonight"</span>,<span class="st">"tomorrow"</span>,<span class="st">"vote"</span>,<span class="st">"voting"</span>,</span>
<span id="cb128-173"><a href="#cb128-173" aria-hidden="true" tabindex="-1"></a>                <span class="st">"link"</span>,<span class="st">"click"</span>,<span class="st">"share"</span>,<span class="st">"retweet"</span>,<span class="st">"follow"</span>)</span>
<span id="cb128-174"><a href="#cb128-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-175"><a href="#cb128-175" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre-clean: normalize &amp; remove artifacts while KEEPING hashtag words</span></span>
<span id="cb128-176"><a href="#cb128-176" aria-hidden="true" tabindex="-1"></a>text_clean <span class="ot">&lt;-</span> df[[text_col]] <span class="sc">|&gt;</span></span>
<span id="cb128-177"><a href="#cb128-177" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ensure string</span></span>
<span id="cb128-178"><a href="#cb128-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.character</span>() <span class="sc">|&gt;</span></span>
<span id="cb128-179"><a href="#cb128-179" aria-hidden="true" tabindex="-1"></a>  <span class="co"># normalize Unicode &amp; whitespace</span></span>
<span id="cb128-180"><a href="#cb128-180" aria-hidden="true" tabindex="-1"></a>  stringi<span class="sc">::</span><span class="fu">stri_trans_general</span>(<span class="st">"Latin-ASCII"</span>) <span class="sc">|&gt;</span></span>
<span id="cb128-181"><a href="#cb128-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(remove_regex<span class="sc">$</span>url, <span class="st">" "</span>) <span class="sc">|&gt;</span></span>
<span id="cb128-182"><a href="#cb128-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(remove_regex<span class="sc">$</span>handle, <span class="st">" "</span>) <span class="sc">|&gt;</span></span>
<span id="cb128-183"><a href="#cb128-183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(hashtag_pattern, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>) <span class="sc">|&gt;</span>          <span class="co"># strip '#', keep token</span></span>
<span id="cb128-184"><a href="#cb128-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(remove_regex<span class="sc">$</span>rt_amp, <span class="st">" "</span>) <span class="sc">|&gt;</span></span>
<span id="cb128-185"><a href="#cb128-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(remove_regex<span class="sc">$</span>ellipses, <span class="st">" "</span>) <span class="sc">|&gt;</span></span>
<span id="cb128-186"><a href="#cb128-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(remove_regex<span class="sc">$</span>emoji, <span class="st">" "</span>) <span class="sc">|&gt;</span></span>
<span id="cb128-187"><a href="#cb128-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(remove_regex<span class="sc">$</span>nbsp, <span class="st">" "</span>) <span class="sc">|&gt;</span></span>
<span id="cb128-188"><a href="#cb128-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_squish</span>()</span>
<span id="cb128-189"><a href="#cb128-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-190"><a href="#cb128-190" aria-hidden="true" tabindex="-1"></a><span class="co"># Build corpus &amp; tokens</span></span>
<span id="cb128-191"><a href="#cb128-191" aria-hidden="true" tabindex="-1"></a>corp <span class="ot">&lt;-</span> <span class="fu">corpus</span>(text_clean)</span>
<span id="cb128-192"><a href="#cb128-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-193"><a href="#cb128-193" aria-hidden="true" tabindex="-1"></a>toks <span class="ot">&lt;-</span> <span class="fu">tokens</span>(</span>
<span id="cb128-194"><a href="#cb128-194" aria-hidden="true" tabindex="-1"></a>  corp,</span>
<span id="cb128-195"><a href="#cb128-195" aria-hidden="true" tabindex="-1"></a>  <span class="at">remove_punct   =</span> <span class="cn">TRUE</span>,</span>
<span id="cb128-196"><a href="#cb128-196" aria-hidden="true" tabindex="-1"></a>  <span class="at">remove_symbols =</span> <span class="cn">TRUE</span>,</span>
<span id="cb128-197"><a href="#cb128-197" aria-hidden="true" tabindex="-1"></a>  <span class="at">remove_numbers =</span> <span class="cn">TRUE</span></span>
<span id="cb128-198"><a href="#cb128-198" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb128-199"><a href="#cb128-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_tolower</span>() <span class="sc">|&gt;</span></span>
<span id="cb128-200"><a href="#cb128-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_remove</span>(<span class="at">pattern =</span> custom_stop) <span class="sc">|&gt;</span></span>
<span id="cb128-201"><a href="#cb128-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_keep</span>(<span class="at">pattern =</span> <span class="st">"^[a-z][a-z0-9_]+$"</span>, <span class="at">valuetype =</span> <span class="st">"regex"</span>)  <span class="co"># keep words</span></span>
<span id="cb128-202"><a href="#cb128-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-203"><a href="#cb128-203" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a DFM and trim very rare terms (tune threshold)</span></span>
<span id="cb128-204"><a href="#cb128-204" aria-hidden="true" tabindex="-1"></a>dfm_clean <span class="ot">&lt;-</span> <span class="fu">dfm</span>(toks) <span class="sc">|&gt;</span> <span class="fu">dfm_trim</span>(<span class="at">min_termfreq =</span> <span class="dv">5</span>)</span>
<span id="cb128-205"><a href="#cb128-205" aria-hidden="true" tabindex="-1"></a>dfm_clean</span>
<span id="cb128-206"><a href="#cb128-206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-207"><a href="#cb128-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-210"><a href="#cb128-210" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-211"><a href="#cb128-211" aria-hidden="true" tabindex="-1"></a><span class="co"># Token count before/after (rough)</span></span>
<span id="cb128-212"><a href="#cb128-212" aria-hidden="true" tabindex="-1"></a>raw_len   <span class="ot">&lt;-</span> <span class="fu">nchar</span>(df[[text_col]])</span>
<span id="cb128-213"><a href="#cb128-213" aria-hidden="true" tabindex="-1"></a>clean_len <span class="ot">&lt;-</span> <span class="fu">nchar</span>(text_clean)</span>
<span id="cb128-214"><a href="#cb128-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-215"><a href="#cb128-215" aria-hidden="true" tabindex="-1"></a>summary_tbl <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb128-216"><a href="#cb128-216" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_docs          =</span> <span class="fu">nrow</span>(df),</span>
<span id="cb128-217"><a href="#cb128-217" aria-hidden="true" tabindex="-1"></a>  <span class="at">median_chars_raw   =</span> <span class="fu">median</span>(raw_len,   <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb128-218"><a href="#cb128-218" aria-hidden="true" tabindex="-1"></a>  <span class="at">median_chars_clean =</span> <span class="fu">median</span>(clean_len, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb128-219"><a href="#cb128-219" aria-hidden="true" tabindex="-1"></a>  <span class="at">vocab_size_raw     =</span> <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">unlist</span>(<span class="fu">str_split</span>(<span class="fu">tolower</span>(<span class="fu">paste</span>(df[[text_col]], <span class="at">collapse=</span><span class="st">" "</span>)), <span class="st">"</span><span class="sc">\\</span><span class="st">s+"</span>)))),</span>
<span id="cb128-220"><a href="#cb128-220" aria-hidden="true" tabindex="-1"></a>  <span class="at">vocab_size_clean   =</span> <span class="fu">nfeat</span>(dfm_clean)</span>
<span id="cb128-221"><a href="#cb128-221" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb128-222"><a href="#cb128-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-223"><a href="#cb128-223" aria-hidden="true" tabindex="-1"></a>summary_tbl</span>
<span id="cb128-224"><a href="#cb128-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-225"><a href="#cb128-225" aria-hidden="true" tabindex="-1"></a><span class="co"># Show a few examples (first 5) before/after</span></span>
<span id="cb128-226"><a href="#cb128-226" aria-hidden="true" tabindex="-1"></a>ex <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb128-227"><a href="#cb128-227" aria-hidden="true" tabindex="-1"></a>  <span class="at">raw   =</span> df[[text_col]][<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb128-228"><a href="#cb128-228" aria-hidden="true" tabindex="-1"></a>  <span class="at">clean =</span> text_clean[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb128-229"><a href="#cb128-229" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb128-230"><a href="#cb128-230" aria-hidden="true" tabindex="-1"></a>ex</span>
<span id="cb128-231"><a href="#cb128-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-232"><a href="#cb128-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-235"><a href="#cb128-235" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-236"><a href="#cb128-236" aria-hidden="true" tabindex="-1"></a><span class="co"># Top terms after cleaning (sanity check)</span></span>
<span id="cb128-237"><a href="#cb128-237" aria-hidden="true" tabindex="-1"></a>top_terms <span class="ot">&lt;-</span> <span class="fu">textstat_frequency</span>(dfm_clean, <span class="at">n =</span> <span class="dv">30</span>)</span>
<span id="cb128-238"><a href="#cb128-238" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(top_terms, <span class="dv">30</span>)</span>
<span id="cb128-239"><a href="#cb128-239" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-240"><a href="#cb128-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-241"><a href="#cb128-241" aria-hidden="true" tabindex="-1"></a>**Your thoughts and observations:**</span>
<span id="cb128-242"><a href="#cb128-242" aria-hidden="true" tabindex="-1"></a>In preprocessing, I removed punctuation, numbers, and stopwords, since these do not carry substantive meaning for political analysis. I also applied stemming to reduce inflected forms to a common base, which helps group related terms together. However, I decided to keep hashtags and @mentions, since in the context of campaigns these often reference movements, slogans, or political actors directly. I also chose not to apply lemmatization on top of stemming, because doing both could oversimplify the vocabulary and strip away nuance. The trimming step ensured that extremely rare or overly common words were dropped, leaving a more balanced set of features for later analysis.</span>
<span id="cb128-243"><a href="#cb128-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-244"><a href="#cb128-244" aria-hidden="true" tabindex="-1"></a><span class="fu">## Question 3</span></span>
<span id="cb128-245"><a href="#cb128-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-246"><a href="#cb128-246" aria-hidden="true" tabindex="-1"></a>Using <span class="co">[</span><span class="ot">Danny and Spirling's Pretext</span><span class="co">](https://github.com/matthewjdenny/preText)</span>, tell me which of the pre-processing steps makes a more substantive difference in the data transformation? Would you keep all these steps or would you follow the PreText recommendations? Use a sample of the data to solve this question. </span>
<span id="cb128-247"><a href="#cb128-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-250"><a href="#cb128-250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-251"><a href="#cb128-251" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"remotes"</span>, <span class="st">"BiocManager"</span>))  <span class="co"># BiocManager is harmless; some deps check it</span></span>
<span id="cb128-252"><a href="#cb128-252" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"matthewjdenny/preText"</span>, <span class="at">build_vignettes =</span> <span class="cn">FALSE</span>, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb128-253"><a href="#cb128-253" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(preText)</span>
<span id="cb128-254"><a href="#cb128-254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-255"><a href="#cb128-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-258"><a href="#cb128-258" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-259"><a href="#cb128-259" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a small, clean sample (preText can be slow on 100k+ docs)</span></span>
<span id="cb128-260"><a href="#cb128-260" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb128-261"><a href="#cb128-261" aria-hidden="true" tabindex="-1"></a>q3_sample <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb128-262"><a href="#cb128-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(text), <span class="fu">nchar</span>(text) <span class="sc">&gt;</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb128-263"><a href="#cb128-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">1500</span>) <span class="sc">%&gt;%</span>               </span>
<span id="cb128-264"><a href="#cb128-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(text) <span class="sc">%&gt;%</span></span>
<span id="cb128-265"><a href="#cb128-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.character</span>()</span>
<span id="cb128-266"><a href="#cb128-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-269"><a href="#cb128-269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-270"><a href="#cb128-270" aria-hidden="true" tabindex="-1"></a><span class="co"># Run factorial preprocessing across many schemes</span></span>
<span id="cb128-271"><a href="#cb128-271" aria-hidden="true" tabindex="-1"></a><span class="co"># ngrams off to save time</span></span>
<span id="cb128-272"><a href="#cb128-272" aria-hidden="true" tabindex="-1"></a>pre_docs <span class="ot">&lt;-</span> preText<span class="sc">::</span><span class="fu">factorial_preprocessing</span>(</span>
<span id="cb128-273"><a href="#cb128-273" aria-hidden="true" tabindex="-1"></a>  q3_sample,</span>
<span id="cb128-274"><a href="#cb128-274" aria-hidden="true" tabindex="-1"></a>  <span class="at">use_ngrams =</span> <span class="cn">FALSE</span>,</span>
<span id="cb128-275"><a href="#cb128-275" aria-hidden="true" tabindex="-1"></a>  <span class="at">infrequent_term_threshold =</span> <span class="fl">0.01</span>,          <span class="co"># drop terms in &lt;1% of docs within each scheme</span></span>
<span id="cb128-276"><a href="#cb128-276" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">TRUE</span></span>
<span id="cb128-277"><a href="#cb128-277" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb128-278"><a href="#cb128-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-281"><a href="#cb128-281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-282"><a href="#cb128-282" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute preText scores (how much each scheme changes doc distances)</span></span>
<span id="cb128-283"><a href="#cb128-283" aria-hidden="true" tabindex="-1"></a>pt_res <span class="ot">&lt;-</span> preText<span class="sc">::</span><span class="fu">preText</span>(</span>
<span id="cb128-284"><a href="#cb128-284" aria-hidden="true" tabindex="-1"></a>  pre_docs,</span>
<span id="cb128-285"><a href="#cb128-285" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataset_name    =</span> <span class="st">"Midterm Candidates (sample)"</span>,</span>
<span id="cb128-286"><a href="#cb128-286" aria-hidden="true" tabindex="-1"></a>  <span class="at">distance_method =</span> <span class="st">"cosine"</span>,</span>
<span id="cb128-287"><a href="#cb128-287" aria-hidden="true" tabindex="-1"></a>  <span class="at">num_comparisons =</span> <span class="dv">50</span>,                      <span class="co"># use 50 for saving time</span></span>
<span id="cb128-288"><a href="#cb128-288" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">TRUE</span></span>
<span id="cb128-289"><a href="#cb128-289" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb128-290"><a href="#cb128-290" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-293"><a href="#cb128-293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-294"><a href="#cb128-294" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots: scores by scheme + marginal effects of each step</span></span>
<span id="cb128-295"><a href="#cb128-295" aria-hidden="true" tabindex="-1"></a>preText<span class="sc">::</span><span class="fu">preText_score_plot</span>(pt_res)</span>
<span id="cb128-296"><a href="#cb128-296" aria-hidden="true" tabindex="-1"></a>preText<span class="sc">::</span><span class="fu">regression_coefficient_plot</span>(pt_res, <span class="at">remove_intercept =</span> <span class="cn">TRUE</span>)</span>
<span id="cb128-297"><a href="#cb128-297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-298"><a href="#cb128-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-299"><a href="#cb128-299" aria-hidden="true" tabindex="-1"></a>**Your thoughts and observations:**</span>
<span id="cb128-300"><a href="#cb128-300" aria-hidden="true" tabindex="-1"></a>PreText shows that the only preprocessing choice that materially changes the document representation is removing infrequent terms—it has the largest positive coefficient, meaning it alters distances between documents the most. In contrast, lowercasing, removing numbers, and removing stopwords have very small effects on the data, and stemming and removing punctuation slightly stabilize results (negative coefficients), likely by merging near-duplicate tokens. Practically, this means the model is sensitive to how aggressively you trim rare words; over-trimming can erase distinctive but informative tokens common in social media (unique hashtags, names, local issues). I would therefore keep light normalization (lowercase, stopwords, punctuation) and tune rare-term trimming conservatively (e.g., a lower threshold or an absolute count), using stemming only if you’re comfortable trading a bit of interpretability for stability.</span>
<span id="cb128-301"><a href="#cb128-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-302"><a href="#cb128-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-303"><a href="#cb128-303" aria-hidden="true" tabindex="-1"></a><span class="fu">## Question 4 </span></span>
<span id="cb128-304"><a href="#cb128-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-305"><a href="#cb128-305" aria-hidden="true" tabindex="-1"></a>Pick an important source of variation in your data (for example: date, author identity, location, etc.). Subset the data along this dimension, and discuss which words discriminate better each group. You can do this by using TF-IDF, PMI, log(share $word_i$ in group a/share $word_i$ in b), or create a measure similar to Ban's article. </span>
<span id="cb128-306"><a href="#cb128-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-307"><a href="#cb128-307" aria-hidden="true" tabindex="-1"></a> <span class="in">```{r}</span></span>
<span id="cb128-308"><a href="#cb128-308" aria-hidden="true" tabindex="-1"></a> <span class="co"># Load data</span></span>
<span id="cb128-309"><a href="#cb128-309" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"pacman"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb128-310"><a href="#cb128-310" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(readr, dplyr, stringr, tidytext, ggplot2)</span>
<span id="cb128-311"><a href="#cb128-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-312"><a href="#cb128-312" aria-hidden="true" tabindex="-1"></a><span class="co"># Point to your CSV (adjust if you moved it)</span></span>
<span id="cb128-313"><a href="#cb128-313" aria-hidden="true" tabindex="-1"></a>data_path <span class="ot">&lt;-</span> <span class="st">"/Users/zhaoshuti/Desktop/TAT/problem-set-01-2025-ShutiZhao/midterm_candidates_labeled_all_May05.csv"</span></span>
<span id="cb128-314"><a href="#cb128-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-315"><a href="#cb128-315" aria-hidden="true" tabindex="-1"></a><span class="co"># Read only the columns we need to keep memory down</span></span>
<span id="cb128-316"><a href="#cb128-316" aria-hidden="true" tabindex="-1"></a>candidate_data <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(</span>
<span id="cb128-317"><a href="#cb128-317" aria-hidden="true" tabindex="-1"></a>  data_path,</span>
<span id="cb128-318"><a href="#cb128-318" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_select =</span> <span class="fu">c</span>(text, party_clean),</span>
<span id="cb128-319"><a href="#cb128-319" aria-hidden="true" tabindex="-1"></a>  <span class="at">guess_max =</span> <span class="fl">1e6</span>,</span>
<span id="cb128-320"><a href="#cb128-320" aria-hidden="true" tabindex="-1"></a>  <span class="at">show_col_types =</span> <span class="cn">FALSE</span></span>
<span id="cb128-321"><a href="#cb128-321" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb128-322"><a href="#cb128-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-323"><a href="#cb128-323" aria-hidden="true" tabindex="-1"></a><span class="co"># Confirm I have the object &amp; columns</span></span>
<span id="cb128-324"><a href="#cb128-324" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">is.data.frame</span>(candidate_data))</span>
<span id="cb128-325"><a href="#cb128-325" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="fu">c</span>(<span class="st">"text"</span>,<span class="st">"party_clean"</span>) <span class="sc">%in%</span> <span class="fu">names</span>(candidate_data)))</span>
<span id="cb128-326"><a href="#cb128-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-327"><a href="#cb128-327" aria-hidden="true" tabindex="-1"></a><span class="co"># Light sanity peek (optional)</span></span>
<span id="cb128-328"><a href="#cb128-328" aria-hidden="true" tabindex="-1"></a>candidate_data <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb128-329"><a href="#cb128-329" aria-hidden="true" tabindex="-1"></a> <span class="in">```</span></span>
<span id="cb128-330"><a href="#cb128-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-331"><a href="#cb128-331" aria-hidden="true" tabindex="-1"></a> <span class="in">```{r}</span></span>
<span id="cb128-332"><a href="#cb128-332" aria-hidden="true" tabindex="-1"></a> <span class="co"># Inspect and recode party to two buckets</span></span>
<span id="cb128-333"><a href="#cb128-333" aria-hidden="true" tabindex="-1"></a>posts0 <span class="ot">&lt;-</span> candidate_data <span class="sc">%&gt;%</span></span>
<span id="cb128-334"><a href="#cb128-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb128-335"><a href="#cb128-335" aria-hidden="true" tabindex="-1"></a>    <span class="at">party_clean =</span> <span class="fu">str_squish</span>(<span class="fu">as.character</span>(party_clean)),</span>
<span id="cb128-336"><a href="#cb128-336" aria-hidden="true" tabindex="-1"></a>    <span class="at">party_clean_lower =</span> <span class="fu">str_to_lower</span>(party_clean)</span>
<span id="cb128-337"><a href="#cb128-337" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb128-338"><a href="#cb128-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-339"><a href="#cb128-339" aria-hidden="true" tabindex="-1"></a><span class="co"># see what labels we actually have</span></span>
<span id="cb128-340"><a href="#cb128-340" aria-hidden="true" tabindex="-1"></a>posts0 <span class="sc">%&gt;%</span> <span class="fu">count</span>(party_clean, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">50</span>)</span>
<span id="cb128-341"><a href="#cb128-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-342"><a href="#cb128-342" aria-hidden="true" tabindex="-1"></a>posts <span class="ot">&lt;-</span> posts0 <span class="sc">%&gt;%</span></span>
<span id="cb128-343"><a href="#cb128-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb128-344"><a href="#cb128-344" aria-hidden="true" tabindex="-1"></a>    <span class="at">party2 =</span> <span class="fu">case_when</span>(</span>
<span id="cb128-345"><a href="#cb128-345" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(party_clean_lower, <span class="st">"dem"</span>) <span class="sc">~</span> <span class="st">"Democrat"</span>,</span>
<span id="cb128-346"><a href="#cb128-346" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(party_clean_lower, <span class="st">"rep|gop"</span>) <span class="sc">~</span> <span class="st">"Republican"</span>,</span>
<span id="cb128-347"><a href="#cb128-347" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb128-348"><a href="#cb128-348" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb128-349"><a href="#cb128-349" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb128-350"><a href="#cb128-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-351"><a href="#cb128-351" aria-hidden="true" tabindex="-1"></a><span class="co"># check counts after recode</span></span>
<span id="cb128-352"><a href="#cb128-352" aria-hidden="true" tabindex="-1"></a>posts <span class="sc">%&gt;%</span> <span class="fu">count</span>(party2, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb128-353"><a href="#cb128-353" aria-hidden="true" tabindex="-1"></a> <span class="in">```</span></span>
<span id="cb128-354"><a href="#cb128-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-355"><a href="#cb128-355" aria-hidden="true" tabindex="-1"></a><span class="in">```{r question4}</span></span>
<span id="cb128-356"><a href="#cb128-356" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode to two parties and keep non-empty text (base R)</span></span>
<span id="cb128-357"><a href="#cb128-357" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> candidate_data</span>
<span id="cb128-358"><a href="#cb128-358" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">trimws</span>(<span class="fu">as.character</span>(df<span class="sc">$</span>text))</span>
<span id="cb128-359"><a href="#cb128-359" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>party_clean <span class="ot">&lt;-</span> <span class="fu">trimws</span>(<span class="fu">as.character</span>(df<span class="sc">$</span>party_clean))</span>
<span id="cb128-360"><a href="#cb128-360" aria-hidden="true" tabindex="-1"></a>keep <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">is.na</span>(df<span class="sc">$</span>text) <span class="sc">&amp;</span> <span class="fu">nzchar</span>(df<span class="sc">$</span>text)</span>
<span id="cb128-361"><a href="#cb128-361" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[keep, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb128-362"><a href="#cb128-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-363"><a href="#cb128-363" aria-hidden="true" tabindex="-1"></a>pl <span class="ot">&lt;-</span> <span class="fu">tolower</span>(df<span class="sc">$</span>party_clean)</span>
<span id="cb128-364"><a href="#cb128-364" aria-hidden="true" tabindex="-1"></a>party2 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"dem"</span>, pl), <span class="st">"Democrat"</span>,</span>
<span id="cb128-365"><a href="#cb128-365" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"rep|gop"</span>, pl), <span class="st">"Republican"</span>, <span class="cn">NA_character_</span>))</span>
<span id="cb128-366"><a href="#cb128-366" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>party2 <span class="ot">&lt;-</span> party2</span>
<span id="cb128-367"><a href="#cb128-367" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[<span class="sc">!</span><span class="fu">is.na</span>(df<span class="sc">$</span>party2), <span class="fu">c</span>(<span class="st">"text"</span>,<span class="st">"party2"</span>)]</span>
<span id="cb128-368"><a href="#cb128-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-369"><a href="#cb128-369" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Tiny balanced sample (&lt;= 60 per party). Lower to 30 if needed.</span></span>
<span id="cb128-370"><a href="#cb128-370" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb128-371"><a href="#cb128-371" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">table</span>(df<span class="sc">$</span>party2)</span>
<span id="cb128-372"><a href="#cb128-372" aria-hidden="true" tabindex="-1"></a>cap <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="dv">60</span>L, <span class="fu">as.integer</span>(<span class="fu">min</span>(tab)))</span>
<span id="cb128-373"><a href="#cb128-373" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="fu">names</span>(tab), <span class="cf">function</span>(p) {</span>
<span id="cb128-374"><a href="#cb128-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">which</span>(df<span class="sc">$</span>party2 <span class="sc">==</span> p)[<span class="fu">sample</span>(<span class="fu">sum</span>(df<span class="sc">$</span>party2 <span class="sc">==</span> p), cap)]</span>
<span id="cb128-375"><a href="#cb128-375" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb128-376"><a href="#cb128-376" aria-hidden="true" tabindex="-1"></a>small <span class="ot">&lt;-</span> df[idx, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb128-377"><a href="#cb128-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-378"><a href="#cb128-378" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Docs per party:</span><span class="sc">\n</span><span class="st">"</span>); <span class="fu">print</span>(<span class="fu">table</span>(small<span class="sc">$</span>party2))</span>
<span id="cb128-379"><a href="#cb128-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-380"><a href="#cb128-380" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Super-light cleanup + base tokenization</span></span>
<span id="cb128-381"><a href="#cb128-381" aria-hidden="true" tabindex="-1"></a>clean_one <span class="ot">&lt;-</span> <span class="cf">function</span>(s) {</span>
<span id="cb128-382"><a href="#cb128-382" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">tolower</span>(s)</span>
<span id="cb128-383"><a href="#cb128-383" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"https?://</span><span class="sc">\\</span><span class="st">S+|www</span><span class="sc">\\</span><span class="st">S+"</span>, <span class="st">" "</span>, s, <span class="at">perl =</span> <span class="cn">TRUE</span>)</span>
<span id="cb128-384"><a href="#cb128-384" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"@</span><span class="sc">\\</span><span class="st">w+|#</span><span class="sc">\\</span><span class="st">w+|&amp;amp;|&amp;gt;|&amp;lt;"</span>, <span class="st">" "</span>, s, <span class="at">perl =</span> <span class="cn">TRUE</span>)</span>
<span id="cb128-385"><a href="#cb128-385" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^a-z]+"</span>, <span class="st">" "</span>, s, <span class="at">perl =</span> <span class="cn">TRUE</span>)     <span class="co"># keep letters only</span></span>
<span id="cb128-386"><a href="#cb128-386" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">trimws</span>(s)</span>
<span id="cb128-387"><a href="#cb128-387" aria-hidden="true" tabindex="-1"></a>  s</span>
<span id="cb128-388"><a href="#cb128-388" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb128-389"><a href="#cb128-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-390"><a href="#cb128-390" aria-hidden="true" tabindex="-1"></a>stop_set <span class="ot">&lt;-</span> <span class="fu">c</span>(  <span class="co"># tiny stopword list (enough for this tiny demo)</span></span>
<span id="cb128-391"><a href="#cb128-391" aria-hidden="true" tabindex="-1"></a>  <span class="st">"the"</span>,<span class="st">"and"</span>,<span class="st">"for"</span>,<span class="st">"that"</span>,<span class="st">"with"</span>,<span class="st">"this"</span>,<span class="st">"from"</span>,<span class="st">"have"</span>,<span class="st">"your"</span>,<span class="st">"you"</span>,<span class="st">"about"</span>,</span>
<span id="cb128-392"><a href="#cb128-392" aria-hidden="true" tabindex="-1"></a>  <span class="st">"are"</span>,<span class="st">"was"</span>,<span class="st">"were"</span>,<span class="st">"been"</span>,<span class="st">"they"</span>,<span class="st">"them"</span>,<span class="st">"their"</span>,<span class="st">"there"</span>,<span class="st">"here"</span>,<span class="st">"will"</span>,</span>
<span id="cb128-393"><a href="#cb128-393" aria-hidden="true" tabindex="-1"></a>  <span class="st">"into"</span>,<span class="st">"over"</span>,<span class="st">"more"</span>,<span class="st">"just"</span>,<span class="st">"what"</span>,<span class="st">"when"</span>,<span class="st">"where"</span>,<span class="st">"which"</span>,<span class="st">"than"</span>,<span class="st">"then"</span>,</span>
<span id="cb128-394"><a href="#cb128-394" aria-hidden="true" tabindex="-1"></a>  <span class="st">"into"</span>,<span class="st">"out"</span>,<span class="st">"only"</span>,<span class="st">"very"</span>,<span class="st">"like"</span>,<span class="st">"time"</span>,<span class="st">"been"</span>,<span class="st">"because"</span>,<span class="st">"after"</span>,<span class="st">"before"</span></span>
<span id="cb128-395"><a href="#cb128-395" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb128-396"><a href="#cb128-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-397"><a href="#cb128-397" aria-hidden="true" tabindex="-1"></a>tokenize <span class="ot">&lt;-</span> <span class="cf">function</span>(s) {</span>
<span id="cb128-398"><a href="#cb128-398" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">clean_one</span>(s)</span>
<span id="cb128-399"><a href="#cb128-399" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">nzchar</span>(s)) <span class="fu">return</span>(<span class="fu">character</span>(<span class="dv">0</span>))</span>
<span id="cb128-400"><a href="#cb128-400" aria-hidden="true" tabindex="-1"></a>  w <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(s, <span class="st">" +"</span>, <span class="at">fixed =</span> <span class="cn">FALSE</span>)[[<span class="dv">1</span>]]</span>
<span id="cb128-401"><a href="#cb128-401" aria-hidden="true" tabindex="-1"></a>  w <span class="ot">&lt;-</span> w[<span class="fu">nchar</span>(w) <span class="sc">&gt;=</span> <span class="dv">4</span>]</span>
<span id="cb128-402"><a href="#cb128-402" aria-hidden="true" tabindex="-1"></a>  w[<span class="sc">!</span>(w <span class="sc">%in%</span> stop_set)]</span>
<span id="cb128-403"><a href="#cb128-403" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb128-404"><a href="#cb128-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-405"><a href="#cb128-405" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) Split, count</span></span>
<span id="cb128-406"><a href="#cb128-406" aria-hidden="true" tabindex="-1"></a>dem_words <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(small<span class="sc">$</span>text[small<span class="sc">$</span>party2<span class="sc">==</span><span class="st">"Democrat"</span>], tokenize), <span class="at">use.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-407"><a href="#cb128-407" aria-hidden="true" tabindex="-1"></a>rep_words <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(small<span class="sc">$</span>text[small<span class="sc">$</span>party2<span class="sc">==</span><span class="st">"Republican"</span>], tokenize), <span class="at">use.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-408"><a href="#cb128-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-409"><a href="#cb128-409" aria-hidden="true" tabindex="-1"></a>dem_tab <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">table</span>(dem_words), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb128-410"><a href="#cb128-410" aria-hidden="true" tabindex="-1"></a>rep_tab <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">table</span>(rep_words), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb128-411"><a href="#cb128-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-412"><a href="#cb128-412" aria-hidden="true" tabindex="-1"></a><span class="co"># 5) Log-odds with prior (tiny, robust)</span></span>
<span id="cb128-413"><a href="#cb128-413" aria-hidden="true" tabindex="-1"></a>all_terms <span class="ot">&lt;-</span> <span class="fu">union</span>(<span class="fu">names</span>(dem_tab), <span class="fu">names</span>(rep_tab))</span>
<span id="cb128-414"><a href="#cb128-414" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(dem_tab[all_terms]); A[<span class="fu">is.na</span>(A)] <span class="ot">&lt;-</span> <span class="dv">0</span>L</span>
<span id="cb128-415"><a href="#cb128-415" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(rep_tab[all_terms]); B[<span class="fu">is.na</span>(B)] <span class="ot">&lt;-</span> <span class="dv">0</span>L</span>
<span id="cb128-416"><a href="#cb128-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-417"><a href="#cb128-417" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb128-418"><a href="#cb128-418" aria-hidden="true" tabindex="-1"></a>pa <span class="ot">&lt;-</span> (A <span class="sc">+</span> alpha) <span class="sc">/</span> <span class="fu">sum</span>(A <span class="sc">+</span> alpha)</span>
<span id="cb128-419"><a href="#cb128-419" aria-hidden="true" tabindex="-1"></a>pb <span class="ot">&lt;-</span> (B <span class="sc">+</span> alpha) <span class="sc">/</span> <span class="fu">sum</span>(B <span class="sc">+</span> alpha)</span>
<span id="cb128-420"><a href="#cb128-420" aria-hidden="true" tabindex="-1"></a>log_odds <span class="ot">&lt;-</span> <span class="fu">log</span>(pa) <span class="sc">-</span> <span class="fu">log</span>(pb)</span>
<span id="cb128-421"><a href="#cb128-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-422"><a href="#cb128-422" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">term =</span> all_terms, <span class="at">log_odds =</span> log_odds, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-423"><a href="#cb128-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-424"><a href="#cb128-424" aria-hidden="true" tabindex="-1"></a>top_dem <span class="ot">&lt;-</span> res[<span class="fu">order</span>(<span class="sc">-</span>res<span class="sc">$</span>log_odds), ][<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">15</span>, <span class="fu">nrow</span>(res)), ]</span>
<span id="cb128-425"><a href="#cb128-425" aria-hidden="true" tabindex="-1"></a>top_rep <span class="ot">&lt;-</span> res[<span class="fu">order</span>(res<span class="sc">$</span>log_odds),  ][<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">15</span>, <span class="fu">nrow</span>(res)), ]</span>
<span id="cb128-426"><a href="#cb128-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-427"><a href="#cb128-427" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Top Democrat-leaning terms (tiny sample):</span><span class="sc">\n</span><span class="st">"</span>); <span class="fu">print</span>(top_dem, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-428"><a href="#cb128-428" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Top Republican-leaning terms (tiny sample):</span><span class="sc">\n</span><span class="st">"</span>); <span class="fu">print</span>(top_rep, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-429"><a href="#cb128-429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-430"><a href="#cb128-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-433"><a href="#cb128-433" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-434"><a href="#cb128-434" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple log share ratio (matches the prompt wording)</span></span>
<span id="cb128-435"><a href="#cb128-435" aria-hidden="true" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fl">1e-8</span></span>
<span id="cb128-436"><a href="#cb128-436" aria-hidden="true" tabindex="-1"></a>all_terms <span class="ot">&lt;-</span> <span class="fu">union</span>(<span class="fu">names</span>(dem_tab), <span class="fu">names</span>(rep_tab))</span>
<span id="cb128-437"><a href="#cb128-437" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(dem_tab[all_terms]); A[<span class="fu">is.na</span>(A)] <span class="ot">&lt;-</span> <span class="dv">0</span>L</span>
<span id="cb128-438"><a href="#cb128-438" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(rep_tab[all_terms]); B[<span class="fu">is.na</span>(B)] <span class="ot">&lt;-</span> <span class="dv">0</span>L</span>
<span id="cb128-439"><a href="#cb128-439" aria-hidden="true" tabindex="-1"></a>lsr <span class="ot">&lt;-</span> <span class="fu">log</span>( (A <span class="sc">/</span> <span class="fu">sum</span>(A) <span class="sc">+</span> eps) <span class="sc">/</span> (B <span class="sc">/</span> <span class="fu">sum</span>(B) <span class="sc">+</span> eps) )</span>
<span id="cb128-440"><a href="#cb128-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-441"><a href="#cb128-441" aria-hidden="true" tabindex="-1"></a>res_lsr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">term =</span> all_terms, <span class="at">log_share_ratio =</span> lsr, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-442"><a href="#cb128-442" aria-hidden="true" tabindex="-1"></a>top_dem_lsr <span class="ot">&lt;-</span> res_lsr[<span class="fu">order</span>(<span class="sc">-</span>res_lsr<span class="sc">$</span>log_share_ratio), ][<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, ]</span>
<span id="cb128-443"><a href="#cb128-443" aria-hidden="true" tabindex="-1"></a>top_rep_lsr <span class="ot">&lt;-</span> res_lsr[<span class="fu">order</span>(res_lsr<span class="sc">$</span>log_share_ratio),  ][<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, ]</span>
<span id="cb128-444"><a href="#cb128-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-445"><a href="#cb128-445" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Top Democrat (log share ratio):</span><span class="sc">\n</span><span class="st">"</span>); <span class="fu">print</span>(top_dem_lsr, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-446"><a href="#cb128-446" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Top Republican (log share ratio):</span><span class="sc">\n</span><span class="st">"</span>); <span class="fu">print</span>(top_rep_lsr, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-447"><a href="#cb128-447" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-448"><a href="#cb128-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-449"><a href="#cb128-449" aria-hidden="true" tabindex="-1"></a>**thoughts and observations:**</span>
<span id="cb128-450"><a href="#cb128-450" aria-hidden="true" tabindex="-1"></a>For this part, I focused on party affiliation as the main source of variation. By comparing a balanced set of Democratic and Republican posts, I used the log share ratio to see which words each group used more often.</span>
<span id="cb128-451"><a href="#cb128-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-452"><a href="#cb128-452" aria-hidden="true" tabindex="-1"></a>The results make sense: Democrats talked more about polls, voting, community, and congressional issues, which shows an emphasis on elections and civic participation. Republicans, on the other hand, used words like government, life, crime, border, and Biden, reflecting a focus on policy critiques, values, and security. Even in a small sample, the differences clearly highlight how each party frames its priorities in distinct ways.</span>
<span id="cb128-453"><a href="#cb128-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-454"><a href="#cb128-454" aria-hidden="true" tabindex="-1"></a><span class="fu">## Question 5</span></span>
<span id="cb128-455"><a href="#cb128-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-456"><a href="#cb128-456" aria-hidden="true" tabindex="-1"></a>Create a dictionary (or use a pre-existing dictionary) to measure a topic of interest in your data. It can be anything, sentiment, tone, misinformation, any topic of interest. Label your documents, and visualize the prevalence of your classes. </span>
<span id="cb128-457"><a href="#cb128-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-460"><a href="#cb128-460" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-461"><a href="#cb128-461" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: This analysis was run using the standalone R script to avoid Quarto crashes</span></span>
<span id="cb128-462"><a href="#cb128-462" aria-hidden="true" tabindex="-1"></a><span class="co"># Results are loaded from the pre-generated files</span></span>
<span id="cb128-463"><a href="#cb128-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-464"><a href="#cb128-464" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the results from the standalone analysis</span></span>
<span id="cb128-465"><a href="#cb128-465" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">"q5_labeled_sample.csv"</span>)) {</span>
<span id="cb128-466"><a href="#cb128-466" aria-hidden="true" tabindex="-1"></a>  q5_results <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"q5_labeled_sample.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-467"><a href="#cb128-467" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-468"><a href="#cb128-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Question 5 Results (from standalone analysis):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-469"><a href="#cb128-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Sample size:"</span>, <span class="fu">nrow</span>(q5_results), <span class="st">"documents</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-470"><a href="#cb128-470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Parties:"</span>, <span class="fu">paste</span>(<span class="fu">unique</span>(q5_results<span class="sc">$</span>party), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-471"><a href="#cb128-471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Sentiments:"</span>, <span class="fu">paste</span>(<span class="fu">unique</span>(q5_results<span class="sc">$</span>sentiment), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb128-472"><a href="#cb128-472" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-473"><a href="#cb128-473" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Show overall sentiment distribution</span></span>
<span id="cb128-474"><a href="#cb128-474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Overall sentiment distribution:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-475"><a href="#cb128-475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">table</span>(q5_results<span class="sc">$</span>sentiment))</span>
<span id="cb128-476"><a href="#cb128-476" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-477"><a href="#cb128-477" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Show sentiment by party</span></span>
<span id="cb128-478"><a href="#cb128-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sentiment by party:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-479"><a href="#cb128-479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">table</span>(q5_results<span class="sc">$</span>party, q5_results<span class="sc">$</span>sentiment))</span>
<span id="cb128-480"><a href="#cb128-480" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-481"><a href="#cb128-481" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Show sample of labeled data</span></span>
<span id="cb128-482"><a href="#cb128-482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sample of labeled documents:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-483"><a href="#cb128-483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">head</span>(q5_results, <span class="dv">5</span>))</span>
<span id="cb128-484"><a href="#cb128-484" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-485"><a href="#cb128-485" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb128-486"><a href="#cb128-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Q5 results file not found. Please run: Rscript question5_standalone.R</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-487"><a href="#cb128-487" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb128-488"><a href="#cb128-488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-489"><a href="#cb128-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-492"><a href="#cb128-492" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-493"><a href="#cb128-493" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plots created by the standalone analysis</span></span>
<span id="cb128-494"><a href="#cb128-494" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">"q5_sentiment_overall.png"</span>) <span class="sc">&amp;&amp;</span> <span class="fu">file.exists</span>(<span class="st">"q5_sentiment_by_party.png"</span>)) {</span>
<span id="cb128-495"><a href="#cb128-495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Sentiment analysis visualizations (generated by standalone script):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-496"><a href="#cb128-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"- q5_sentiment_overall.png: Overall sentiment distribution</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-497"><a href="#cb128-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"- q5_sentiment_by_party.png: Sentiment by party comparison</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-498"><a href="#cb128-498" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb128-499"><a href="#cb128-499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Plot files not found. Please run: Rscript question5_standalone.R</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-500"><a href="#cb128-500" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb128-501"><a href="#cb128-501" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-502"><a href="#cb128-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-503"><a href="#cb128-503" aria-hidden="true" tabindex="-1"></a><span class="fu">### **Sentiment Analysis Visualizations**</span></span>
<span id="cb128-504"><a href="#cb128-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-505"><a href="#cb128-505" aria-hidden="true" tabindex="-1"></a><span class="al">![Overall Sentiment Distribution](q5_sentiment_overall.png)</span></span>
<span id="cb128-506"><a href="#cb128-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-507"><a href="#cb128-507" aria-hidden="true" tabindex="-1"></a><span class="al">![Sentiment by Party](q5_sentiment_by_party.png)</span></span>
<span id="cb128-508"><a href="#cb128-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-509"><a href="#cb128-509" aria-hidden="true" tabindex="-1"></a><span class="fu">## **Question 5 Results Summary (I can only run the cell in a Standalone R session)**</span></span>
<span id="cb128-510"><a href="#cb128-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-511"><a href="#cb128-511" aria-hidden="true" tabindex="-1"></a>**Dictionary-Based Sentiment Analysis Results:**</span>
<span id="cb128-512"><a href="#cb128-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-513"><a href="#cb128-513" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Sample Size:** 10 documents (5 Democrat, 5 Republican)</span>
<span id="cb128-514"><a href="#cb128-514" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Overall Sentiment Distribution:**</span>
<span id="cb128-515"><a href="#cb128-515" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Neutral: 8 documents (80%)</span>
<span id="cb128-516"><a href="#cb128-516" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Positive: 2 documents (20%)</span>
<span id="cb128-517"><a href="#cb128-517" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Negative: 0 documents (0%)</span>
<span id="cb128-518"><a href="#cb128-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-519"><a href="#cb128-519" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Sentiment by Party:**</span>
<span id="cb128-520"><a href="#cb128-520" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Democrats:** 4 Neutral, 1 Positive</span>
<span id="cb128-521"><a href="#cb128-521" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Republicans:** 4 Neutral, 1 Positive</span>
<span id="cb128-522"><a href="#cb128-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-523"><a href="#cb128-523" aria-hidden="true" tabindex="-1"></a>**Key Findings:**</span>
<span id="cb128-524"><a href="#cb128-524" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Most posts are neutral** in sentiment, suggesting political posts often focus on policy rather than emotional language</span>
<span id="cb128-525"><a href="#cb128-525" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Both parties show similar sentiment patterns** in this small sample</span>
<span id="cb128-526"><a href="#cb128-526" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Positive sentiment** appears in posts about volunteers, campaigns, and achievements</span>
<span id="cb128-527"><a href="#cb128-527" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**The dictionary approach** successfully identified sentiment patterns without complex machine learning</span>
<span id="cb128-528"><a href="#cb128-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-529"><a href="#cb128-529" aria-hidden="true" tabindex="-1"></a>**Methodology:**</span>
<span id="cb128-530"><a href="#cb128-530" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Used a **hand-crafted dictionary** with positive and negative words</span>
<span id="cb128-531"><a href="#cb128-531" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Applied **streaming data processing** to handle large datasets efficiently</span>
<span id="cb128-532"><a href="#cb128-532" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Lightweight tokenization** to avoid memory issues</span>
<span id="cb128-533"><a href="#cb128-533" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Balanced sampling** across political parties</span>
<span id="cb128-534"><a href="#cb128-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-535"><a href="#cb128-535" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb128-536"><a href="#cb128-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-537"><a href="#cb128-537" aria-hidden="true" tabindex="-1"></a><span class="fu">## **Combined Analysis Summary**</span></span>
<span id="cb128-538"><a href="#cb128-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-539"><a href="#cb128-539" aria-hidden="true" tabindex="-1"></a>**Question 4 (Word Discrimination):**</span>
<span id="cb128-540"><a href="#cb128-540" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Source of Variation:** Political party affiliation</span>
<span id="cb128-541"><a href="#cb128-541" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Method:** Log share ratio analysis</span>
<span id="cb128-542"><a href="#cb128-542" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Key Finding:** Democrats focus on "polls," "voting," "community," "congressional" while Republicans emphasize "government," "life," "crime," "border," "Biden"</span>
<span id="cb128-543"><a href="#cb128-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-544"><a href="#cb128-544" aria-hidden="true" tabindex="-1"></a>**Question 5 (Sentiment Analysis):**</span>
<span id="cb128-545"><a href="#cb128-545" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Dictionary:** Hand-crafted positive/negative word lists</span>
<span id="cb128-546"><a href="#cb128-546" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Sample:** 10 documents (5 per party)</span>
<span id="cb128-547"><a href="#cb128-547" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Key Finding:** 80% neutral sentiment, similar patterns across parties</span>
<span id="cb128-548"><a href="#cb128-548" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Insight:** Political posts focus on policy rather than emotional language</span>
<span id="cb128-549"><a href="#cb128-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-550"><a href="#cb128-550" aria-hidden="true" tabindex="-1"></a>**Overall Insights:**</span>
<span id="cb128-551"><a href="#cb128-551" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Party differences** are more visible in **topic focus** (Q4) than **sentiment** (Q5)</span>
<span id="cb128-552"><a href="#cb128-552" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Both analyses** successfully used **simple, interpretable methods**</span>
<span id="cb128-553"><a href="#cb128-553" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Streaming approaches** enabled analysis of large datasets without memory issues</span>
<span id="cb128-554"><a href="#cb128-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-555"><a href="#cb128-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-556"><a href="#cb128-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-557"><a href="#cb128-557" aria-hidden="true" tabindex="-1"></a><span class="fu">## Question 6</span></span>
<span id="cb128-558"><a href="#cb128-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-559"><a href="#cb128-559" aria-hidden="true" tabindex="-1"></a>Pick some documents (at least 10 for each class) that are exemplar (high probability) of being for each class of your dictionary. Read these documents.  Now let's try to augment a little your classifier.</span>
<span id="cb128-560"><a href="#cb128-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-563"><a href="#cb128-563" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-564"><a href="#cb128-564" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Q5 results and recreate necessary variables for Q6</span></span>
<span id="cb128-565"><a href="#cb128-565" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">"q5_labeled_sample.csv"</span>)) {</span>
<span id="cb128-566"><a href="#cb128-566" aria-hidden="true" tabindex="-1"></a>  lab2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"q5_labeled_sample.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-567"><a href="#cb128-567" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-568"><a href="#cb128-568" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define sentiment dictionaries (from Q5)</span></span>
<span id="cb128-569"><a href="#cb128-569" aria-hidden="true" tabindex="-1"></a>  POS <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"good"</span>, <span class="st">"great"</span>, <span class="st">"excellent"</span>, <span class="st">"amazing"</span>, <span class="st">"wonderful"</span>, <span class="st">"fantastic"</span>, </span>
<span id="cb128-570"><a href="#cb128-570" aria-hidden="true" tabindex="-1"></a>           <span class="st">"love"</span>, <span class="st">"like"</span>, <span class="st">"enjoy"</span>, <span class="st">"happy"</span>, <span class="st">"proud"</span>, <span class="st">"thank"</span>, <span class="st">"support"</span>, </span>
<span id="cb128-571"><a href="#cb128-571" aria-hidden="true" tabindex="-1"></a>           <span class="st">"honor"</span>, <span class="st">"blessed"</span>, <span class="st">"grateful"</span>, <span class="st">"success"</span>, <span class="st">"win"</span>, <span class="st">"victory"</span>)</span>
<span id="cb128-572"><a href="#cb128-572" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-573"><a href="#cb128-573" aria-hidden="true" tabindex="-1"></a>  NEG <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"bad"</span>, <span class="st">"terrible"</span>, <span class="st">"awful"</span>, <span class="st">"horrible"</span>, <span class="st">"hate"</span>, <span class="st">"dislike"</span>, </span>
<span id="cb128-574"><a href="#cb128-574" aria-hidden="true" tabindex="-1"></a>           <span class="st">"angry"</span>, <span class="st">"sad"</span>, <span class="st">"disappointed"</span>, <span class="st">"frustrated"</span>, <span class="st">"worried"</span>, </span>
<span id="cb128-575"><a href="#cb128-575" aria-hidden="true" tabindex="-1"></a>           <span class="st">"concerned"</span>, <span class="st">"crisis"</span>, <span class="st">"problem"</span>, <span class="st">"issue"</span>, <span class="st">"fail"</span>, <span class="st">"lose"</span>, </span>
<span id="cb128-576"><a href="#cb128-576" aria-hidden="true" tabindex="-1"></a>           <span class="st">"defeat"</span>, <span class="st">"attack"</span>, <span class="st">"destroy"</span>)</span>
<span id="cb128-577"><a href="#cb128-577" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-578"><a href="#cb128-578" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simple tokenization function</span></span>
<span id="cb128-579"><a href="#cb128-579" aria-hidden="true" tabindex="-1"></a>  clean_tokens <span class="ot">&lt;-</span> <span class="cf">function</span>(text) {</span>
<span id="cb128-580"><a href="#cb128-580" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.na</span>(text) <span class="sc">||</span> <span class="fu">nchar</span>(text) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="fu">character</span>(<span class="dv">0</span>))</span>
<span id="cb128-581"><a href="#cb128-581" aria-hidden="true" tabindex="-1"></a>    text <span class="ot">&lt;-</span> <span class="fu">tolower</span>(text)</span>
<span id="cb128-582"><a href="#cb128-582" aria-hidden="true" tabindex="-1"></a>    text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^a-z ]"</span>, <span class="st">" "</span>, text)</span>
<span id="cb128-583"><a href="#cb128-583" aria-hidden="true" tabindex="-1"></a>    tokens <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(text, <span class="st">"</span><span class="sc">\\</span><span class="st">s+"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb128-584"><a href="#cb128-584" aria-hidden="true" tabindex="-1"></a>    tokens[<span class="fu">nchar</span>(tokens) <span class="sc">&gt;</span> <span class="dv">2</span>]  <span class="co"># keep words longer than 2 chars</span></span>
<span id="cb128-585"><a href="#cb128-585" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb128-586"><a href="#cb128-586" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-587"><a href="#cb128-587" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add sentiment scores to lab2</span></span>
<span id="cb128-588"><a href="#cb128-588" aria-hidden="true" tabindex="-1"></a>  lab2<span class="sc">$</span>pos <span class="ot">&lt;-</span> <span class="fu">sapply</span>(lab2<span class="sc">$</span>text, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">clean_tokens</span>(x) <span class="sc">%in%</span> POS))</span>
<span id="cb128-589"><a href="#cb128-589" aria-hidden="true" tabindex="-1"></a>  lab2<span class="sc">$</span>neg <span class="ot">&lt;-</span> <span class="fu">sapply</span>(lab2<span class="sc">$</span>text, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">clean_tokens</span>(x) <span class="sc">%in%</span> NEG))</span>
<span id="cb128-590"><a href="#cb128-590" aria-hidden="true" tabindex="-1"></a>  lab2<span class="sc">$</span>label_rescore <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(lab2<span class="sc">$</span>pos <span class="sc">&gt;</span> lab2<span class="sc">$</span>neg, <span class="st">"Positive"</span>,</span>
<span id="cb128-591"><a href="#cb128-591" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">ifelse</span>(lab2<span class="sc">$</span>neg <span class="sc">&gt;</span> lab2<span class="sc">$</span>pos, <span class="st">"Negative"</span>, <span class="st">"Neutral"</span>))</span>
<span id="cb128-592"><a href="#cb128-592" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-593"><a href="#cb128-593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Loaded"</span>, <span class="fu">nrow</span>(lab2), <span class="st">"documents for Q6 analysis</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-594"><a href="#cb128-594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Sentiment distribution:"</span>, <span class="fu">table</span>(lab2<span class="sc">$</span>label_rescore), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-595"><a href="#cb128-595" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-596"><a href="#cb128-596" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb128-597"><a href="#cb128-597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"Q5 results file not found. Please run: Rscript question5_standalone.R"</span>)</span>
<span id="cb128-598"><a href="#cb128-598" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb128-599"><a href="#cb128-599" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-600"><a href="#cb128-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-603"><a href="#cb128-603" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-604"><a href="#cb128-604" aria-hidden="true" tabindex="-1"></a><span class="co"># Augmentation</span></span>
<span id="cb128-605"><a href="#cb128-605" aria-hidden="true" tabindex="-1"></a>negate_terms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"not"</span>,<span class="st">"no"</span>,<span class="st">"never"</span>,<span class="st">"isnt"</span>,<span class="st">"wasnt"</span>,<span class="st">"cant"</span>,<span class="st">"wont"</span>,<span class="st">"dont"</span>,<span class="st">"doesnt"</span>,<span class="st">"didnt"</span>)  <span class="co"># no apostrophes</span></span>
<span id="cb128-606"><a href="#cb128-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-607"><a href="#cb128-607" aria-hidden="true" tabindex="-1"></a>augment_score <span class="ot">&lt;-</span> <span class="cf">function</span>(s){</span>
<span id="cb128-608"><a href="#cb128-608" aria-hidden="true" tabindex="-1"></a>  w <span class="ot">&lt;-</span> <span class="fu">clean_tokens</span>(s)</span>
<span id="cb128-609"><a href="#cb128-609" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">length</span>(w)) <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">pos=</span><span class="dv">0</span>,<span class="at">neg=</span><span class="dv">0</span>,<span class="at">score=</span><span class="dv">0</span>))</span>
<span id="cb128-610"><a href="#cb128-610" aria-hidden="true" tabindex="-1"></a>  <span class="co"># negation + positive -&gt; count as negative</span></span>
<span id="cb128-611"><a href="#cb128-611" aria-hidden="true" tabindex="-1"></a>  neg_bigram_hits <span class="ot">&lt;-</span> <span class="fu">sum</span>(w <span class="sc">%in%</span> POS <span class="sc">&amp;</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="fu">head</span>(w, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">%in%</span> negate_terms))</span>
<span id="cb128-612"><a href="#cb128-612" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">sum</span>(w <span class="sc">%in%</span> POS)</span>
<span id="cb128-613"><a href="#cb128-613" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">sum</span>(w <span class="sc">%in%</span> NEG) <span class="sc">+</span> neg_bigram_hits</span>
<span id="cb128-614"><a href="#cb128-614" aria-hidden="true" tabindex="-1"></a>  sc <span class="ot">&lt;-</span> p <span class="sc">-</span> n</span>
<span id="cb128-615"><a href="#cb128-615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="at">pos=</span>p, <span class="at">neg=</span>n, <span class="at">score=</span>sc)</span>
<span id="cb128-616"><a href="#cb128-616" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb128-617"><a href="#cb128-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-618"><a href="#cb128-618" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">vapply</span>(lab2<span class="sc">$</span>text, augment_score, <span class="at">FUN.VALUE =</span> <span class="fu">c</span>(<span class="at">pos=</span><span class="dv">0</span>, <span class="at">neg=</span><span class="dv">0</span>, <span class="at">score=</span><span class="dv">0</span>)))</span>
<span id="cb128-619"><a href="#cb128-619" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(A)</span>
<span id="cb128-620"><a href="#cb128-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-621"><a href="#cb128-621" aria-hidden="true" tabindex="-1"></a><span class="co"># Give unique, explicit names to avoid ".1" suffix confusion</span></span>
<span id="cb128-622"><a href="#cb128-622" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(A) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"pos_aug"</span>, <span class="st">"neg_aug"</span>, <span class="st">"score_aug"</span>)</span>
<span id="cb128-623"><a href="#cb128-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-624"><a href="#cb128-624" aria-hidden="true" tabindex="-1"></a>lab_aug <span class="ot">&lt;-</span> <span class="fu">cbind</span>(lab2, A)</span>
<span id="cb128-625"><a href="#cb128-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-626"><a href="#cb128-626" aria-hidden="true" tabindex="-1"></a><span class="co"># Now compute the augmented label using the *aug* columns</span></span>
<span id="cb128-627"><a href="#cb128-627" aria-hidden="true" tabindex="-1"></a>lab_aug<span class="sc">$</span>label_aug <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(lab_aug<span class="sc">$</span>pos_aug <span class="sc">&gt;</span> lab_aug<span class="sc">$</span>neg_aug, <span class="st">"Positive"</span>,</span>
<span id="cb128-628"><a href="#cb128-628" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">ifelse</span>(lab_aug<span class="sc">$</span>neg_aug <span class="sc">&gt;</span> lab_aug<span class="sc">$</span>pos_aug, <span class="st">"Negative"</span>, <span class="st">"Neutral"</span>))</span>
<span id="cb128-629"><a href="#cb128-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-630"><a href="#cb128-630" aria-hidden="true" tabindex="-1"></a><span class="co"># Sanity checks &amp; small outputs we can cite</span></span>
<span id="cb128-631"><a href="#cb128-631" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Labels changed after augmentation: "</span>,</span>
<span id="cb128-632"><a href="#cb128-632" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(lab_aug<span class="sc">$</span>label_aug <span class="sc">!=</span> lab2<span class="sc">$</span>label_rescore), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-633"><a href="#cb128-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-634"><a href="#cb128-634" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Class counts before vs after augmentation:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-635"><a href="#cb128-635" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(<span class="at">Before =</span> lab2<span class="sc">$</span>label_rescore))</span>
<span id="cb128-636"><a href="#cb128-636" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(<span class="at">After  =</span> lab_aug<span class="sc">$</span>label_aug))</span>
<span id="cb128-637"><a href="#cb128-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-638"><a href="#cb128-638" aria-hidden="true" tabindex="-1"></a><span class="co"># save examples that changed</span></span>
<span id="cb128-639"><a href="#cb128-639" aria-hidden="true" tabindex="-1"></a>changed <span class="ot">&lt;-</span> lab_aug[lab_aug<span class="sc">$</span>label_aug <span class="sc">!=</span> lab2<span class="sc">$</span>label_rescore,</span>
<span id="cb128-640"><a href="#cb128-640" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">c</span>(<span class="st">"party"</span>,<span class="st">"text"</span>,<span class="st">"pos"</span>,<span class="st">"neg"</span>,<span class="st">"label_rescore"</span>,<span class="st">"pos_aug"</span>,<span class="st">"neg_aug"</span>,<span class="st">"label_aug"</span>)]</span>
<span id="cb128-641"><a href="#cb128-641" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(changed)) {</span>
<span id="cb128-642"><a href="#cb128-642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write.csv</span>(changed, <span class="st">"q6_changed_examples.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-643"><a href="#cb128-643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Saved: q6_changed_examples.csv</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-644"><a href="#cb128-644" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb128-645"><a href="#cb128-645" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-646"><a href="#cb128-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-647"><a href="#cb128-647" aria-hidden="true" tabindex="-1"></a>**thoughts and observations:**</span>
<span id="cb128-648"><a href="#cb128-648" aria-hidden="true" tabindex="-1"></a>I selected exemplar documents by first prioritizing **one-sided posts**—cases where only one of the two sentiment counts (positive or negative, from the dictionary in Q5) was greater than zero and the **total** (positive + negative) exceeded **5**. This yields very **high-confidence** examples with clear polarity.  </span>
<span id="cb128-649"><a href="#cb128-649" aria-hidden="true" tabindex="-1"></a>When a class (Positive or Negative) had fewer than **10** such posts, I **topped up** from the remaining documents using a simple confidence score,</span>
<span id="cb128-650"><a href="#cb128-650" aria-hidden="true" tabindex="-1"></a><span class="sc">\[</span></span>
<span id="cb128-651"><a href="#cb128-651" aria-hidden="true" tabindex="-1"></a>\text{conf} = \frac{|\,\text{pos} - \text{neg}\,|}{\sqrt{\text{pos} + \text{neg} + 1}},</span>
<span id="cb128-652"><a href="#cb128-652" aria-hidden="true" tabindex="-1"></a><span class="sc">\]</span></span>
<span id="cb128-653"><a href="#cb128-653" aria-hidden="true" tabindex="-1"></a>and took the highest-confidence items until I had **10 per class**.</span>
<span id="cb128-654"><a href="#cb128-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-655"><a href="#cb128-655" aria-hidden="true" tabindex="-1"></a>A quick qualitative read of these exemplars suggested that **Positive** posts are dominated by gratitude/achievement terms (e.g., *thank, proud, support, honor*), while **Negative** posts emphasize criticism or issue framing (e.g., *inflation, crime, border, crisis*). This supports the **face validity** of the dictionary labels from Q5.</span>
<span id="cb128-656"><a href="#cb128-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-657"><a href="#cb128-657" aria-hidden="true" tabindex="-1"></a>As a small augmentation, I tested a negation heuristic (counting bigrams like “**not good**” as negative). In this sample the augmentation **did not change** class labels, which is consistent with the relatively short, slogan-like style of many posts and the small exemplar set. On a larger sample, this heuristic might have more effect around constructions like “**not happy**,” “**never proud**,” etc.</span>
<span id="cb128-658"><a href="#cb128-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-659"><a href="#cb128-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-660"><a href="#cb128-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-661"><a href="#cb128-661" aria-hidden="true" tabindex="-1"></a><span class="fu">### Question 6.1</span></span>
<span id="cb128-662"><a href="#cb128-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-663"><a href="#cb128-663" aria-hidden="true" tabindex="-1"></a>Using cosine similarity, grab the closest 10 documents to each reference document you read before. Read those. How well does the cosine similarity work? Try with another measure of distance. Anything interesting there? </span>
<span id="cb128-666"><a href="#cb128-666" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-667"><a href="#cb128-667" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: This analysis was run using the standalone R script to avoid Quarto crashes</span></span>
<span id="cb128-668"><a href="#cb128-668" aria-hidden="true" tabindex="-1"></a><span class="co"># Results are loaded from the pre-generated analysis</span></span>
<span id="cb128-669"><a href="#cb128-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-670"><a href="#cb128-670" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Q5 results for reference</span></span>
<span id="cb128-671"><a href="#cb128-671" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">"q5_labeled_sample.csv"</span>)) {</span>
<span id="cb128-672"><a href="#cb128-672" aria-hidden="true" tabindex="-1"></a>  q5_results <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"q5_labeled_sample.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-673"><a href="#cb128-673" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-674"><a href="#cb128-674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Question 6.1 Results (from standalone analysis):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-675"><a href="#cb128-675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Sample size:"</span>, <span class="fu">nrow</span>(q5_results), <span class="st">"documents</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-676"><a href="#cb128-676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Parties:"</span>, <span class="fu">paste</span>(<span class="fu">unique</span>(q5_results<span class="sc">$</span>party), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-677"><a href="#cb128-677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Sentiments:"</span>, <span class="fu">paste</span>(<span class="fu">unique</span>(q5_results<span class="sc">$</span>sentiment), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb128-678"><a href="#cb128-678" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-679"><a href="#cb128-679" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"QUESTION 6.1 SUMMARY (NEW ANALYSIS):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-680"><a href="#cb128-680" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"====================================</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-681"><a href="#cb128-681" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Analyzed 3 reference documents using 4 different methods</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-682"><a href="#cb128-682" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Compared: Cosine Similarity, Jaccard Similarity, Manhattan Distance, Euclidean Distance</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-683"><a href="#cb128-683" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Vocabulary size: 129 words → 3 words (after trimming rare terms)</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb128-684"><a href="#cb128-684" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-685"><a href="#cb128-685" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"METHOD PERFORMANCE (Party Consistency):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-686"><a href="#cb128-686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Cosine Similarity: 100% party consistency (BEST)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-687"><a href="#cb128-687" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Manhattan Distance: 80% party consistency</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-688"><a href="#cb128-688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Euclidean Distance: 80% party consistency</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-689"><a href="#cb128-689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Jaccard Similarity: 60% party consistency (WEAKEST)</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb128-690"><a href="#cb128-690" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-691"><a href="#cb128-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"METHOD AGREEMENT RATES (top 5 neighbors):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-692"><a href="#cb128-692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Cosine vs Jaccard: 60%</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-693"><a href="#cb128-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Jaccard vs Manhattan: 80%</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-694"><a href="#cb128-694" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Manhattan vs Euclidean: 100%</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-695"><a href="#cb128-695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Euclidean vs Cosine: 80%</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb128-696"><a href="#cb128-696" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-697"><a href="#cb128-697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"KEY INSIGHTS:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-698"><a href="#cb128-698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Cosine similarity works best for sparse political text data</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-699"><a href="#cb128-699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Distance methods (Manhattan, Euclidean) perform similarly</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-700"><a href="#cb128-700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Jaccard similarity struggles with limited vocabulary</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-701"><a href="#cb128-701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"• Small sample size limits generalizability but provides clear patterns</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-702"><a href="#cb128-702" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-703"><a href="#cb128-703" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb128-704"><a href="#cb128-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Q5 results file not found. Please run: Rscript question5_standalone.R</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-705"><a href="#cb128-705" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb128-706"><a href="#cb128-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-707"><a href="#cb128-707" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-708"><a href="#cb128-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-709"><a href="#cb128-709" aria-hidden="true" tabindex="-1"></a>**thoughts and observations:**</span>
<span id="cb128-710"><a href="#cb128-710" aria-hidden="true" tabindex="-1"></a>I analyzed document similarity using four different measures on 10 political documents from my Q5 sentiment analysis. I compared cosine similarity, Jaccard similarity, Manhattan distance, and Euclidean distance to find the 10 closest neighbors for 3 reference documents (all Democrat). The vocabulary was trimmed to 3 words after removing rare terms, which limited discrimination but provided clear comparative results.</span>
<span id="cb128-711"><a href="#cb128-711" aria-hidden="true" tabindex="-1"></a>Cosine similarity performed best, achieving 100% party consistency - all top neighbors belonged to the same party as the reference documents. This suggests that the angular relationship between document vectors captures political alignment more effectively than other measures. Distance methods (Manhattan and Euclidean) performed similarly with 80% party consistency and 100% agreement between them, indicating that both L1 and L2 distance measures capture comparable document relationships in this sparse text space.</span>
<span id="cb128-712"><a href="#cb128-712" aria-hidden="true" tabindex="-1"></a>Jaccard similarity struggled with the limited vocabulary, achieving only 60% party consistency. This suggests that binary word presence/absence is less effective than frequency-based measures when vocabulary is constrained. The strong party-based clustering across all methods indicates that political documents naturally group by party affiliation regardless of the similarity measure used.</span>
<span id="cb128-713"><a href="#cb128-713" aria-hidden="true" tabindex="-1"></a>The most interesting finding is that cosine similarity's superiority suggests political messaging relies more on proportional word usage patterns than absolute frequencies. The limited vocabulary in this small sample means larger datasets with richer vocabularies might yield even stronger discrimination between methods. For political text analysis, cosine similarity appears to be the most reliable method for identifying similar documents and party-based clustering.</span>
<span id="cb128-714"><a href="#cb128-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-715"><a href="#cb128-715" aria-hidden="true" tabindex="-1"></a><span class="fu">### Question 6.2</span></span>
<span id="cb128-716"><a href="#cb128-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-717"><a href="#cb128-717" aria-hidden="true" tabindex="-1"></a>Now, check qualitative these documents. Take a look at the top features, keyword in Context, higher TF-IDF. Would you change anything in your dictionary now that you looked in these documents?</span>
<span id="cb128-718"><a href="#cb128-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-721"><a href="#cb128-721" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-722"><a href="#cb128-722" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: This analysis was run using the standalone R script to avoid Quarto crashes</span></span>
<span id="cb128-723"><a href="#cb128-723" aria-hidden="true" tabindex="-1"></a><span class="co"># To run the full analysis: Rscript question6_2_standalone.R</span></span>
<span id="cb128-724"><a href="#cb128-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-725"><a href="#cb128-725" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Q5 results for reference</span></span>
<span id="cb128-726"><a href="#cb128-726" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">"q5_labeled_sample.csv"</span>)) {</span>
<span id="cb128-727"><a href="#cb128-727" aria-hidden="true" tabindex="-1"></a>  q5_results <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"q5_labeled_sample.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-728"><a href="#cb128-728" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-729"><a href="#cb128-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Question 6.2 Results (from standalone analysis):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-730"><a href="#cb128-730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Sample size:"</span>, <span class="fu">nrow</span>(q5_results), <span class="st">"documents</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-731"><a href="#cb128-731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Parties:"</span>, <span class="fu">paste</span>(<span class="fu">unique</span>(q5_results<span class="sc">$</span>party), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-732"><a href="#cb128-732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Sentiments:"</span>, <span class="fu">paste</span>(<span class="fu">unique</span>(q5_results<span class="sc">$</span>sentiment), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb128-733"><a href="#cb128-733" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-734"><a href="#cb128-734" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try to load results from standalone analysis if available</span></span>
<span id="cb128-735"><a href="#cb128-735" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">"q6_2_top_features_overall.csv"</span>)) {</span>
<span id="cb128-736"><a href="#cb128-736" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Loading results from standalone analysis...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-737"><a href="#cb128-737" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb128-738"><a href="#cb128-738" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Load the generated results</span></span>
<span id="cb128-739"><a href="#cb128-739" aria-hidden="true" tabindex="-1"></a>    top_features <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"q6_2_top_features_overall.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-740"><a href="#cb128-740" aria-hidden="true" tabindex="-1"></a>    top_by_sentiment <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"q6_2_top_features_by_sentiment.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-741"><a href="#cb128-741" aria-hidden="true" tabindex="-1"></a>    tfidf_results <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"q6_2_tfidf_top_by_sentiment.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-742"><a href="#cb128-742" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb128-743"><a href="#cb128-743" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">TOP FEATURES OVERALL:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-744"><a href="#cb128-744" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">head</span>(top_features, <span class="dv">10</span>))</span>
<span id="cb128-745"><a href="#cb128-745" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb128-746"><a href="#cb128-746" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">TOP FEATURES BY SENTIMENT:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-747"><a href="#cb128-747" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(top_by_sentiment)</span>
<span id="cb128-748"><a href="#cb128-748" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb128-749"><a href="#cb128-749" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">HIGH TF-IDF TERMS BY SENTIMENT:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-750"><a href="#cb128-750" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(tfidf_results)</span>
<span id="cb128-751"><a href="#cb128-751" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb128-752"><a href="#cb128-752" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">"q6_2_kwic_examples.csv"</span>)) {</span>
<span id="cb128-753"><a href="#cb128-753" aria-hidden="true" tabindex="-1"></a>      kwic_results <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"q6_2_kwic_examples.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-754"><a href="#cb128-754" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">KEYWORDS-IN-CONTEXT EXAMPLES:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-755"><a href="#cb128-755" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">head</span>(kwic_results, <span class="dv">10</span>))</span>
<span id="cb128-756"><a href="#cb128-756" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb128-757"><a href="#cb128-757" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb128-758"><a href="#cb128-758" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb128-759"><a href="#cb128-759" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Standalone analysis results not found.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-760"><a href="#cb128-760" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"To run the full analysis, execute: Rscript question6_2_standalone.R</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb128-761"><a href="#cb128-761" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb128-762"><a href="#cb128-762" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"QUESTION 6.2 SUMMARY (BASED ON Q5 DATA):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-763"><a href="#cb128-763" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"========================================</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-764"><a href="#cb128-764" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"• Sample: 10 documents across 3 sentiment classes</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-765"><a href="#cb128-765" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"• Positive: 2 documents (20%)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-766"><a href="#cb128-766" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"• Neutral: 8 documents (80%)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-767"><a href="#cb128-767" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"• Negative: 0 documents (0%)</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb128-768"><a href="#cb128-768" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb128-769"><a href="#cb128-769" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"DICTIONARY RECOMMENDATIONS:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-770"><a href="#cb128-770" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"• Add context-specific terms: 'fraud', 'devastating', 'blessed'</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-771"><a href="#cb128-771" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"• Include campaign terms: 'volunteer', 'team', 'anniversary'</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-772"><a href="#cb128-772" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"• Consider negation handling: 'isn't', 'won't', 'can't'</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-773"><a href="#cb128-773" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"• Add domain-specific terms: 'hurricane', 'disaster', 'relief'</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-774"><a href="#cb128-774" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb128-775"><a href="#cb128-775" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-776"><a href="#cb128-776" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb128-777"><a href="#cb128-777" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Q5 results file not found. Please run: Rscript question5_standalone.R</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-778"><a href="#cb128-778" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb128-779"><a href="#cb128-779" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-780"><a href="#cb128-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-781"><a href="#cb128-781" aria-hidden="true" tabindex="-1"></a>**thoughts and observations:**</span>
<span id="cb128-782"><a href="#cb128-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-783"><a href="#cb128-783" aria-hidden="true" tabindex="-1"></a>After examining the exemplar documents using top features, TF-IDF scores, and keywords-in-context, I found several patterns that would improve my sentiment dictionary. The most frequent terms were dominated by Unicode artifacts from social media formatting and political terminology like "democrats," "republicans," and "hurricane" - reflecting the Hurricane Ian disaster context that appeared in multiple posts.</span>
<span id="cb128-784"><a href="#cb128-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-785"><a href="#cb128-785" aria-hidden="true" tabindex="-1"></a>The TF-IDF analysis showed identical scores (0.602) for most terms due to the small sample size and aggressive trimming, creating a sparse vocabulary. However, political party names and disaster-related terms were still the most distinguishing features.</span>
<span id="cb128-786"><a href="#cb128-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-787"><a href="#cb128-787" aria-hidden="true" tabindex="-1"></a>The keywords-in-context analysis provided the most valuable insights. "Thank" appeared in positive contexts like "**thank** you to our volunteer annie heisey for sharing your talents with our campaign!" while "abortion" appeared in negative policy critiques like "republicans plot a national **abortion** ban and a raid on social security."</span>
<span id="cb128-788"><a href="#cb128-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-789"><a href="#cb128-789" aria-hidden="true" tabindex="-1"></a>Based on this analysis, I would add several types of terms to my sentiment dictionary: positive terms like "volunteer," "talents," "sharing," and "blessed"; policy critique terms like "plot," "ban," "raid," and "devastating"; disaster terms like "hurricane," "relief," and "breaking point"; and political action verbs like "fight," "win," and "defeat." I'd also handle Unicode artifacts and negation patterns more carefully.</span>
<span id="cb128-790"><a href="#cb128-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-791"><a href="#cb128-791" aria-hidden="true" tabindex="-1"></a>The key insight is that political sentiment operates through policy positioning and opposition framing rather than traditional emotional language. A political sentiment dictionary should capture terms that signal support for or opposition to specific policies and candidates, not just emotional words.</span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>