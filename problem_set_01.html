<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Emily Zhao">

<title>Text as Data: Problem Set 01</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="problem_set_01_files/libs/clipboard/clipboard.min.js"></script>
<script src="problem_set_01_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="problem_set_01_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="problem_set_01_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="problem_set_01_files/libs/quarto-html/popper.min.js"></script>
<script src="problem_set_01_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="problem_set_01_files/libs/quarto-html/anchor.min.js"></script>
<link href="problem_set_01_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="problem_set_01_files/libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="problem_set_01_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="problem_set_01_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="problem_set_01_files/libs/bootstrap/bootstrap-d6a003b94517c951b2d65075d42fb01b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#instructions" id="toc-instructions" class="nav-link active" data-scroll-target="#instructions">Instructions</a></li>
  <li><a href="#question-1" id="toc-question-1" class="nav-link" data-scroll-target="#question-1">Question 1</a></li>
  <li><a href="#question-2" id="toc-question-2" class="nav-link" data-scroll-target="#question-2">Question 2</a></li>
  <li><a href="#question-3" id="toc-question-3" class="nav-link" data-scroll-target="#question-3">Question 3</a></li>
  <li><a href="#question-4" id="toc-question-4" class="nav-link" data-scroll-target="#question-4">Question 4</a></li>
  <li><a href="#question-5" id="toc-question-5" class="nav-link" data-scroll-target="#question-5">Question 5</a></li>
  <li><a href="#question-6" id="toc-question-6" class="nav-link" data-scroll-target="#question-6">Question 6</a>
  <ul class="collapse">
  <li><a href="#question-6.1" id="toc-question-6.1" class="nav-link" data-scroll-target="#question-6.1">Question 6.1</a></li>
  <li><a href="#question-6.2" id="toc-question-6.2" class="nav-link" data-scroll-target="#question-6.2">Question 6.2</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Text as Data: Problem Set 01</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Emily Zhao </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="instructions" class="level2">
<h2 class="anchored" data-anchor-id="instructions">Instructions</h2>
<p>To complete this homework, you have two options.</p>
<p>You can either complete this assignment using a <strong>dataset of your choice</strong>. This is a great opportunity for you to start working with a dataset that you can potentially use for your final project.</p>
<p>Your second option is to this dataset of social media posts from political candidates running for Congress during the 2022 U.S. Midterm election.</p>
<p>You can download the dataset <a href="https://www.dropbox.com/scl/fi/jz14130dlzj5xvca9txj4/midterm_candidates_labeled_all_May05.csv?rlkey=b0m1h6kk1af3uz9tjqyelthh3&amp;dl=0">here</a></p>
<p>To know more about the dataset, read and cite this paper: <a href="https://journals.sagepub.com/doi/full/10.1177/20563051251337541" class="uri">https://journals.sagepub.com/doi/full/10.1177/20563051251337541</a></p>
<p>If you want say thanks to the people who collected and shared this data with us for this class, please send a email to my colleague <a href="https://maggiegmacdonald.com/">Maggie MacDonald</a></p>
<p><strong>IMPORTANT:</strong> Remember to NOT commit your data to github. Github does not allow you to push large datasets to remote repositories. If you commit your dataset, you will need to reset your commit, and that’s always a bit of work. In addition, remember that your notebook should be compiled with the results of the code blocks.</p>
</section>
<section id="question-1" class="level2">
<h2 class="anchored" data-anchor-id="question-1">Question 1</h2>
<p>Take a small a sample of your documents and read them carefully. This sample doesn’t need to be random. Select cases that are more interesting, and close to your theoretical interest in this dataset. What are you thoughts about these documents? What did you learn after reading them?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>terms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"inflation"</span>,<span class="st">"economy"</span>,<span class="st">"jobs"</span>,<span class="st">"crime"</span>,<span class="st">"abortion"</span>,<span class="st">"immigration"</span>,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">"border"</span>,<span class="st">"climate"</span>,<span class="st">"guns"</span>,<span class="st">"healthcare"</span>,<span class="st">"tax"</span>,<span class="st">"education"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(text)) <span class="sc">%&gt;%</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(stringr<span class="sc">::</span><span class="fu">str_detect</span>(stringr<span class="sc">::</span><span class="fu">str_to_lower</span>(text),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                                    stringr<span class="sc">::</span><span class="fu">str_c</span>(terms, <span class="at">collapse =</span> <span class="st">"|"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(party_clean, created_at, username, text)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 × 4
   party_clean created_at username            text                              
   &lt;chr&gt;       &lt;date&gt;     &lt;chr&gt;               &lt;chr&gt;                             
 1 Republican  2022-10-07 mikeleeforutah      "We need a compassionate solution…
 2 Democratic  2022-10-25 kp4nc               "@EdLaborGOP Meanwhile you call t…
 3 Republican  2022-10-19 singletary4congress "This morning, I was in studio wi…
 4 Republican  2022-11-05 LucieVolotzky       "Vote NO on Prop 1! If passed, it…
 5 Democratic  2022-10-26 snyderforin03       "I will help them out. @RepJimBan…
 6 Republican  2022-10-26 michellesteelca     "We didn’t expect this kind of mo…
 7 Republican  2022-10-11 guyciarrocchi       "I’ll take “things you can’t make…
 8 Democratic  2022-10-12 axne4congress       "Incredible night at Revelton Dis…
 9 Democratic  2022-10-30 drqhathaway         "#An #EarlyVoting Message\" \r\nF…
10 Republican  2022-10-21 alexisjohnsonnm     "When @KamalaHarris said the bord…
# ℹ 20 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, create the sample data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>terms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"inflation"</span>,<span class="st">"economy"</span>,<span class="st">"jobs"</span>,<span class="st">"crime"</span>,<span class="st">"abortion"</span>,<span class="st">"immigration"</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"border"</span>,<span class="st">"climate"</span>,<span class="st">"guns"</span>,<span class="st">"healthcare"</span>,<span class="st">"tax"</span>,<span class="st">"education"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>df_sample <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(text)) <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(stringr<span class="sc">::</span><span class="fu">str_detect</span>(stringr<span class="sc">::</span><span class="fu">str_to_lower</span>(text),</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                                    stringr<span class="sc">::</span><span class="fu">str_c</span>(terms, <span class="at">collapse =</span> <span class="st">"|"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">30</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Define column names</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>text_col <span class="ot">&lt;-</span> <span class="st">"text"</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>date_col <span class="ot">&lt;-</span> <span class="st">"created_at"</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>party_col <span class="ot">&lt;-</span> <span class="st">"party_clean"</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>author_col <span class="ot">&lt;-</span> <span class="st">"username"</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Now create the readable format</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>df_to_read <span class="ot">&lt;-</span> df_sample <span class="sc">|&gt;</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">transmute</span>(</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">party =</span> .data[[party_col]], </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.character</span>(.data[[date_col]]), </span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">author =</span> .data[[author_col]],</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">text_full =</span> stringr<span class="sc">::</span><span class="fu">str_squish</span>(.data[[text_col]]),</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">text_short =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(<span class="fu">nchar</span>(text_full) <span class="sc">&gt;</span> <span class="dv">280</span>,</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">paste0</span>(<span class="fu">substr</span>(text_full, <span class="dv">1</span>, <span class="dv">277</span>), <span class="st">"..."</span>),</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>                                text_full)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the short version in a table</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(df_to_read[, <span class="fu">c</span>(<span class="st">"party"</span>,<span class="st">"date"</span>,<span class="st">"author"</span>,<span class="st">"text_short"</span>)], <span class="at">format =</span> <span class="st">"html"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">party</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">date</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">author</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">text_short</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-10-10</td>
<td style="text-align: left;">michellesteelca</td>
<td style="text-align: left;">President Biden’s reliance on OPEC is only hurting the American people. Now that OPEC has cut their oil production, we can expect higher gas and food prices, and increased supply chain issues. We must stop playing politics with our economy and unleash American energy, immediat...</td>
</tr>
<tr class="even">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-11-02</td>
<td style="text-align: left;">lauren4arkansas</td>
<td style="text-align: left;">As a mother and a Democrat, I am ready to get to Congress to codify abortion rights into law. Who's with me?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-10-21</td>
<td style="text-align: left;">marypeltola</td>
<td style="text-align: left;">Reproductive healthcare shouldn’t be a right only a wealthy few have access to. When you restrict and ban the right to choose, that’s the outcome you get.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-10-26</td>
<td style="text-align: left;">foster4congress</td>
<td style="text-align: left;">Not only have Republican proposals to fight inflation and lower costs for hard working families been scant, but the plans they have announced would be ineffectual.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-11-27</td>
<td style="text-align: left;">laurenboebert</td>
<td style="text-align: left;">The Swamp continues their disgusting and corrupt behavior without any regard for ethics. The “Get Trump By Any Means” investigations are a total waste of taxpayer money as they have been for the past six years. https://t.co/Y56hkF1dux</td>
</tr>
<tr class="even">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-10-25</td>
<td style="text-align: left;">pattypansingbrooks</td>
<td style="text-align: left;">My visit to Central Community College-Columbus was inspiring! Campus President Kathy Fuchser met with us and gave a great tour highlighting VR systems, fabrication and healthcare programs for Nebraska students seeking to become a vibrant part of our economy!</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-10-17</td>
<td style="text-align: left;">https://www.youtube.com/channel/UC0ZZmBkaRQIJCpa1WD1ONjA</td>
<td style="text-align: left;">District he is a U.S uh veteran Army veteran Marcus flowers who he is running against or he won the Democratic nomination uh for congress uh and they're facing off uh in November glad to have you on the show um was there anything in particular that caused for you to say this w...</td>
</tr>
<tr class="even">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-11-03</td>
<td style="text-align: left;">marisawoodca</td>
<td style="text-align: left;">Skyrocketing crime and instead of focusing on the district, @GOPleader continues to distract with the border…The criminals at the border were caught–you said it yourself. I’m tired of this guy and if you feel the same way, then join me at https://t.co/NjfsW02dA3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-10-03</td>
<td style="text-align: left;">davidkimforca</td>
<td style="text-align: left;">Let’s talk about education &amp; the climate with Bryant Odega. These are key issues impacting future generations to come. Tune in tomorrow! #losangeles #environmentalracism #education #greennewdeal</td>
</tr>
<tr class="even">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-10-30</td>
<td style="text-align: left;">justinburau</td>
<td style="text-align: left;">The same people who took away your jobs during Covid now want you to help them keep their jobs or give them a promotion. That’s laughable. Vote Republican November 8th and stop these extreme Democrats! #IL03 #Illinois #FirePritzker https://t.co/IMu4bfDZyg</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-10-19</td>
<td style="text-align: left;">madisonhornok</td>
<td style="text-align: left;">Let's create an education system that is built not to please any political ideology, but to build up our future generations.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-10-13</td>
<td style="text-align: left;">hinsonashley</td>
<td style="text-align: left;">It's really hard to afford your daily life when inflation is wiping out your paycheck - inflation caused by Biden &amp;amp; Pelosi's reckless spending. Ashley will close President Biden's checkbook, @LizMathis1 will greenlight more reckless spending.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-10-06</td>
<td style="text-align: left;">derekmarshallca</td>
<td style="text-align: left;">745 people have more wealth than half of American households. Any guess as to how much these wealthy elites have paid in taxes?</td>
</tr>
<tr class="even">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-10-03</td>
<td style="text-align: left;">gendonbolduc</td>
<td style="text-align: left;">NH Democrats do not stand for parents. @ChairmanBuckley claims parents will "beat their children" whereas @SenatorHassan has previously called parents "over the top." This must stop! Parents deserve respect &amp;amp; the opportunity to have a say in their children's education. #NH...</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-10-22</td>
<td style="text-align: left;">ike.mccorkle</td>
<td style="text-align: left;">When you get the “we have to stop this out of control democrat spending,” remind them that Trump’s trade war increased federal ag expenditures from 11 to 32 billion in one year… combined with an unpaid for 2T tax scam for the rich. They exploded the deficit and flooded the sys...</td>
</tr>
<tr class="even">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-10-18</td>
<td style="text-align: left;">patryanuc</td>
<td style="text-align: left;">Schmitt was one of only 11 members of the Assembly to vote against a bill that prohibited the possession, manufacture, and transport of rapid-fire modification devices. Schmitt voted against a bill criminalizing the sale of ghost guns.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-10-05</td>
<td style="text-align: left;">barrforcongress</td>
<td style="text-align: left;">Families and small businesses in KY03 are being crushed by inflation. @StuartRayforD3 is exactly the man they need to send to Washington to represent them and fight back against the reckless spending, regulatory, and energy policies causing this great affordability crisis.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-10-24</td>
<td style="text-align: left;">cavalerifor</td>
<td style="text-align: left;">Alternative headline: Despite looming recession, tone-deaf incumbents give economy and crime a thumbs up! https://t.co/UtGeXFYtar</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-10-13</td>
<td style="text-align: left;">adam.laxalt</td>
<td style="text-align: left;">Inflation in Nevada continues to climb — it is now sitting at 16%. Catherine Cortez Masto &amp; Biden’s reckless spending is costing Nevada households over $10,400 per year. Nevadans deserve better.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-10-20</td>
<td style="text-align: left;">kleavittnh</td>
<td style="text-align: left;">Thank you, @NFIB! I am honored to receive the endorsement and support of our nation's leading small business advocates. In Congress, I will always fight to cut taxes, remove burdensome red tape, and get the government out of the way! #NHPolitics #NH01 https://t.co/iYQ8DCbmNh</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-10-21</td>
<td style="text-align: left;">caraveoforcongress</td>
<td style="text-align: left;">Every dollar wasted by the government could be spent lowering housing &amp; healthcare costs for working-class Coloradans like those I see in clinic. Oversight is desperately needed &amp; when I’m in Congress, I’ll fight to make sure we are spending taxpayer money responsibly. #CO08</td>
</tr>
<tr class="even">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-10-18</td>
<td style="text-align: left;">catherinecortezmasto</td>
<td style="text-align: left;">Adam Laxalt is an automatic vote for a federal abortion ban. He called Roe v. Wade a "joke," and celebrated the repeal as a "historic victory." We all know where he stands.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-10-06</td>
<td style="text-align: left;">droz</td>
<td style="text-align: left;">Inflation is an economic and health crisis - a doctor can help fix it. As PA's next Senator, I'll keep us safe, cut your taxes, and protect our jobs. Watch: https://t.co/QMlDF4TQkX</td>
</tr>
<tr class="even">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-10-30</td>
<td style="text-align: left;">geoffyoung4ky</td>
<td style="text-align: left;">I called them terrorists, aggressors &amp;amp; war criminals - AS THEY COMMITTED THEIR CRIMES or shortly after they started to. I've known that aggression is the worst war crime since 1976 when I took 2 classes at MIT with Noam Chomsky. https://t.co/7riUJPgCCj https://t.co/K2t1BLi...</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-11-25</td>
<td style="text-align: left;">debbielesko</td>
<td style="text-align: left;">Arizona is on the front lines of President Biden’s record-breaking border crisis. Over 4 MILLION illegal immigrants have been apprehended crossing the southern border since Biden took office. I will continue to fight to protect Arizonans and secure the southern border!</td>
</tr>
<tr class="even">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-11-25</td>
<td style="text-align: left;">ericjbrewercle</td>
<td style="text-align: left;">7000 Americans with medical degrees can't get a residency in one of our hospitals because thousands of alien medical students are being given the jobs. That's insane. Here foreigners run four Cleveland hospitals and look out for foreigners in hiring. https://t.co/QXi0e21P1o</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-11-15</td>
<td style="text-align: left;">nmalliotakis</td>
<td style="text-align: left;">Why won’t Democrats secure our border and fix soft-on-crime policies to stop traffickers &amp;amp; dealers from killing Americans? https://t.co/rajaNJ8jpy</td>
</tr>
<tr class="even">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-10-09</td>
<td style="text-align: left;">tedbuddnc</td>
<td style="text-align: left;">Joe Biden's policies are on the ballot this November. Skyrocketing inflation, rising crime rates, and a broken Southern border are all a result of Biden's failed agenda. In NC, Biden's policies go by the name Cheri Beasley. https://t.co/50mxKGrUx8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Republican</td>
<td style="text-align: left;">2022-10-24</td>
<td style="text-align: left;">jeff4congressma</td>
<td style="text-align: left;">America has been pushing jobs overseas for decades - it's time that our policies here in DC focuses on bringing and keeping jobs here</td>
</tr>
<tr class="even">
<td style="text-align: left;">Democratic</td>
<td style="text-align: left;">2022-10-26</td>
<td style="text-align: left;">murraycampaign</td>
<td style="text-align: left;">My opponent might be a climate denier, but I’m proud to have helped pass the most significant climate action in history to lower energy costs, cut carbon emissions, and create good-paying clean energy jobs. https://t.co/i2ImXIGyld</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List full texts below</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"• "</span>, df_to_read<span class="sc">$</span>text_full), <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>• President Biden’s reliance on OPEC is only hurting the American people. Now that OPEC has cut their oil production, we can expect higher gas and food prices, and increased supply chain issues. We must stop playing politics with our economy and unleash American energy, immediately.

• As a mother and a Democrat, I am ready to get to Congress to codify abortion rights into law. Who's with me?

• Reproductive healthcare shouldn’t be a right only a wealthy few have access to. When you restrict and ban the right to choose, that’s the outcome you get.

• Not only have Republican proposals to fight inflation and lower costs for hard working families been scant, but the plans they have announced would be ineffectual.

• The Swamp continues their disgusting and corrupt behavior without any regard for ethics. The “Get Trump By Any Means” investigations are a total waste of taxpayer money as they have been for the past six years. https://t.co/Y56hkF1dux

• My visit to Central Community College-Columbus was inspiring! Campus President Kathy Fuchser met with us and gave a great tour highlighting VR systems, fabrication and healthcare programs for Nebraska students seeking to become a vibrant part of our economy!

• District he is a U.S uh veteran Army veteran Marcus flowers who he is running against or he won the Democratic nomination uh for congress uh and they're facing off uh in November glad to have you on the show um was there anything in particular that caused for you to say this woman can't represent me and my people I've got to run against her well first and foremost thanks for having me on Roland it's a pleasure to be here with you uh you know you're someone that I've been following for a long time now and uh you know I I really appreciate the opportunity to come and speak to you and your uh your audience uh so a little bit about why I decided to get in the campaign that's a long story you know as you alluded to in your opening um I'm an army veteran at 18 years old I swore an oath to support and defend the Constitution of the United States and that's what I've been doing for the last almost three decades as a soldier a former Defense Contractor and a former government official with the Department of Defense uh you know what got me involved in politics in general because coming from the world that I've come from not always considered myself a political nonpartisan you know never never gotten to politics my job was to accomplish the mission now going back to the summer of 2020 when I watched George Floyd being murdered at the knee of a police officer you know that stirred something in me and you know I took that personally because my granddaddy was a sheriff and a farmer uh and uncles who were police captains uncles who served in the military and I knew that's not you know who we were as a country so that kind of got me off the sidelines so to speak I kind of I started you know looking into ways to reach out to people and and talk about you know what's going on in our country because at that time we've seen a string of black men being murdered at the hand of police but over the course of that summer I watched his misinformation and disinformation campaign grew louder and louder I watched my idol John Lewis who also I share a birthplace with Troy Alabama I watched him died CT Vivian die on the same day and I'm wondering who's going to carry on those messages uh at that same time Margaret Taylor green came onto my radar she just come in and won a primary in our district I started doing a deep dive into her and caught wind of some of the conspiracy theories and you know that she said 9 11 a plane didn't hit the Pentagon you know and for someone who was actively serving our country overseas on 9 11. you know I took that personally as well uh but then on January 6th when I watched The Citadel of our democracy being attacked by election deniers people who had bought in to the big lie that was being pushed by people like Marjorie Taylor green you know I watched police officers being beaten with an American flag uh my friend who I've gotten to know over the course of this last year Harry Dunn and other officers being bear sprayed you know like a Confederate Battle Flag being paraded through our Capital rotunda you know having watched all that and seen Marjory Taylor Green's part in it I really took that personal so I was on my post as a government official on January 7th 2021 and decided to run for Congress against Marjorie Taylor green to hold her accountable for that and so um she's continued hasn't tempered in fact she's been stripped of her committee assignments and so she just freelancing running around after the fool she's been fine constantly we're refusing to wear masks she's thumbed her nose out at Authority and she frankly is acting like a spoiled brat oh yeah if anything she's definitely gotten worse since then I mean you know even though my campaign was born of what happened on January 6th and this is coming from someone who's been a decade in combat zones in Iraq and Afghanistan lost brothers and sisters in arms and those conflicts you know that's what my campaign was born of but in the past 18 months since I've been you know traveling around this district meeting people where they are talking to our local elected officials whether they're Mayors City Council Members Commissioners church leaders Boards of educations law enforcement officials you know I I've come to find out that we have real issues in this problem this this District that aren't being addressed and that's what people want to see they want to see effective and efficient governance they want to see things getting done Margaret Taylor Greene's not doing it we're all well aware of her Antics but that's not doing a damn thing for us here in this District she's yet to bring any any progress to our district no matter what she says you know traveling around the country campaigning with you know far right and extremists you know at Trump rallies that's not doing anything for us I start getting the job done that we sent her to Congress to do um this has been called a very rare District so how do you beat her just like I said before I get out this campaign is not over 60 000 doors we've built an infrastructure here or a district who you know some people would write off and say oh yeah it's a red District we're not going to bother with that well that's not who I am I don't leave anyone left behind I don't concede any ground and we built that infrastructure here with you know dozens of organizers field organizers hundreds of volunteers you know hundreds of thousands of donations from around the country which I'm humbled by you know and again getting out and having those conversations with people whether it's Democrats Independents and Republicans alike to a person almost they're embarrassed by Marjorie Taylor green I'll tell you I get Republicans coming up to me every day Roland every day saying that woman is an embarrassment please get her out of office I'm a republican I'm a conservative I'm voting for you every day and that's not hyperbole that is the truth that's how we beat her all right Marcus flowers was certainly good luck um in the campaign against uh Marjorie Taylor green uh and we'll certainly watching on Election night again thank you for having me rolling I appreciate the opportunity to speak with you

• Skyrocketing crime and instead of focusing on the district, @GOPleader continues to distract with the border…The criminals at the border were caught–you said it yourself. I’m tired of this guy and if you feel the same way, then join me at https://t.co/NjfsW02dA3

• Let’s talk about education &amp; the climate with Bryant Odega. These are key issues impacting future generations to come. Tune in tomorrow! #losangeles #environmentalracism #education #greennewdeal

• The same people who took away your jobs during Covid now want you to help them keep their jobs or give them a promotion. That’s laughable. Vote Republican November 8th and stop these extreme Democrats! #IL03 #Illinois #FirePritzker https://t.co/IMu4bfDZyg

• Let's create an education system that is built not to please any political ideology, but to build up our future generations.

• It's really hard to afford your daily life when inflation is wiping out your paycheck - inflation caused by Biden &amp;amp; Pelosi's reckless spending. Ashley will close President Biden's checkbook, @LizMathis1 will greenlight more reckless spending.

• 745 people have more wealth than half of American households. Any guess as to how much these wealthy elites have paid in taxes?

• NH Democrats do not stand for parents. @ChairmanBuckley claims parents will "beat their children" whereas @SenatorHassan has previously called parents "over the top." This must stop! Parents deserve respect &amp;amp; the opportunity to have a say in their children's education. #NHSEN https://t.co/oEOw1NEBBz

• When you get the “we have to stop this out of control democrat spending,” remind them that Trump’s trade war increased federal ag expenditures from 11 to 32 billion in one year… combined with an unpaid for 2T tax scam for the rich. They exploded the deficit and flooded the system with excess revenue at the same time. Inflation was built in by 2019 when the pandemic hit and the federal government had to even further increase the growth of revenue in the system ~ saving our small businesses and families but adding to the mounting inflationary hurricane we are now experiencing. Today’s GOP ￼crashes the economy and explodes the deficit ￼, every time they are in charge…

• Schmitt was one of only 11 members of the Assembly to vote against a bill that prohibited the possession, manufacture, and transport of rapid-fire modification devices. Schmitt voted against a bill criminalizing the sale of ghost guns.

• Families and small businesses in KY03 are being crushed by inflation. @StuartRayforD3 is exactly the man they need to send to Washington to represent them and fight back against the reckless spending, regulatory, and energy policies causing this great affordability crisis.

• Alternative headline: Despite looming recession, tone-deaf incumbents give economy and crime a thumbs up! https://t.co/UtGeXFYtar

• Inflation in Nevada continues to climb — it is now sitting at 16%. Catherine Cortez Masto &amp; Biden’s reckless spending is costing Nevada households over $10,400 per year. Nevadans deserve better.

• Thank you, @NFIB! I am honored to receive the endorsement and support of our nation's leading small business advocates. In Congress, I will always fight to cut taxes, remove burdensome red tape, and get the government out of the way! #NHPolitics #NH01 https://t.co/iYQ8DCbmNh

• Every dollar wasted by the government could be spent lowering housing &amp; healthcare costs for working-class Coloradans like those I see in clinic. Oversight is desperately needed &amp; when I’m in Congress, I’ll fight to make sure we are spending taxpayer money responsibly. #CO08

• Adam Laxalt is an automatic vote for a federal abortion ban. He called Roe v. Wade a "joke," and celebrated the repeal as a "historic victory." We all know where he stands.

• Inflation is an economic and health crisis - a doctor can help fix it. As PA's next Senator, I'll keep us safe, cut your taxes, and protect our jobs. Watch: https://t.co/QMlDF4TQkX

• I called them terrorists, aggressors &amp;amp; war criminals - AS THEY COMMITTED THEIR CRIMES or shortly after they started to. I've known that aggression is the worst war crime since 1976 when I took 2 classes at MIT with Noam Chomsky. https://t.co/7riUJPgCCj https://t.co/K2t1BLiqxt https://t.co/6IQjmkBSOY

• Arizona is on the front lines of President Biden’s record-breaking border crisis. Over 4 MILLION illegal immigrants have been apprehended crossing the southern border since Biden took office. I will continue to fight to protect Arizonans and secure the southern border!

• 7000 Americans with medical degrees can't get a residency in one of our hospitals because thousands of alien medical students are being given the jobs. That's insane. Here foreigners run four Cleveland hospitals and look out for foreigners in hiring. https://t.co/QXi0e21P1o

• Why won’t Democrats secure our border and fix soft-on-crime policies to stop traffickers &amp;amp; dealers from killing Americans? https://t.co/rajaNJ8jpy

• Joe Biden's policies are on the ballot this November. Skyrocketing inflation, rising crime rates, and a broken Southern border are all a result of Biden's failed agenda. In NC, Biden's policies go by the name Cheri Beasley. https://t.co/50mxKGrUx8

• America has been pushing jobs overseas for decades - it's time that our policies here in DC focuses on bringing and keeping jobs here

• My opponent might be a climate denier, but I’m proud to have helped pass the most significant climate action in history to lower energy costs, cut carbon emissions, and create good-paying clean energy jobs. https://t.co/i2ImXIGyld</code></pre>
</div>
</div>
<p><strong>thoughts and observations:</strong></p>
<p>When I looked through a small sample of posts that focused on policy issues like inflation, jobs, crime, abortion, immigration, and education, a few things stood out to me.</p>
<p>The first is how differently the same topics are framed depending on the candidate. Posts about inflation, for example, sometimes talk about everyday struggles like the rising cost of groceries or Thanksgiving dinner, while others use the issue to criticize government spending and tie it to partisan blame. Similarly, on abortion and healthcare, some candidates emphasize rights and protections, while others stress morality or security. Reading them side by side makes it clear that even when everyone is talking about the same problem, they present it in very different ways.</p>
<p>Another thing I noticed is how much of the content is “campaign talk.” Many posts combine an issue with a call to action—come to a rally, donate, vote early, or volunteer. They’re filled with hashtags, <span class="citation" data-cites="mentions">@mentions</span>, links, and emojis, which makes sense for social media but also means a lot of this text will have to be cleaned or standardized before analysis. At the same time, some hashtags are clearly issue signals (like #ProChoice or #SaveAmerica), so I might want to keep those instead of stripping them all away.</p>
<p>Overall, reading these posts helped me see both the main themes and the style of communication. Candidates are trying to link national debates to everyday life, while also pushing people to engage with their campaigns. It gave me a clearer sense of what matters in preprocessing—removing clutter, but also keeping the pieces that carry real political meaning.</p>
</section>
<section id="question-2" class="level2">
<h2 class="anchored" data-anchor-id="question-2">Question 2</h2>
<p>Tokenize your documents and pre-process them, removing any “extraneous” content you noticed in closely reading a sample of your documents. What content have you removed and why? Any pre-processing steps from what you saw in class that you consider not to use here?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>txt <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">as.character</span>(df<span class="sc">$</span>text))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># remove obvious junk, keep it simple</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>txt <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(txt, <span class="st">"https?://</span><span class="sc">\\</span><span class="st">S+|www</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">S+"</span>, <span class="st">" "</span>)  <span class="co"># URLs</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>txt <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(txt, <span class="st">"@</span><span class="sc">\\</span><span class="st">w+"</span>, <span class="st">" "</span>)                     <span class="co"># @handles</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>txt <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(txt, <span class="st">"&amp;amp;|&amp;lt;|&amp;gt;"</span>, <span class="st">" "</span>)           <span class="co"># HTML bits</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>txt <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(txt, <span class="st">"#"</span>, <span class="st">""</span>)                          <span class="co"># drop '#' but keep hashtag words</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>txt <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(txt, <span class="st">"[^a-z</span><span class="sc">\\</span><span class="st">s]"</span>, <span class="st">" "</span>)                 <span class="co"># emojis/punct/numbers → space</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>txt <span class="ot">&lt;-</span> <span class="fu">str_squish</span>(txt)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># tokenize -&gt; remove stopwords -&gt; dfm -&gt; light trim</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>corp   <span class="ot">&lt;-</span> <span class="fu">corpus</span>(txt)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>toks   <span class="ot">&lt;-</span> <span class="fu">tokens</span>(corp, <span class="at">remove_numbers =</span> <span class="cn">TRUE</span>, <span class="at">remove_punct =</span> <span class="cn">TRUE</span>, <span class="at">remove_symbols =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>          <span class="fu">tokens_remove</span>(<span class="fu">stopwords</span>(<span class="st">"en"</span>))</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>dfm_q2 <span class="ot">&lt;-</span> <span class="fu">dfm</span>(toks) <span class="sc">|&gt;</span> <span class="fu">dfm_trim</span>(<span class="at">min_termfreq =</span> <span class="dv">5</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co"># tiny peek</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">textstat_frequency</span>(dfm_q2, <span class="at">n =</span> <span class="dv">20</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  feature frequency rank docfreq group
1       s     58446    1   37033   all
2    vote     23693    2   18522   all
3       t     19881    3   14536   all
4     can     15281    4   11895   all
5  people     14831    5   10306   all
6   thank     14734    6   13118   all</code></pre>
</div>
</div>
<p><strong>thoughts and observations:</strong> I cleaned the text by lowercasing and removing obvious platform noise: URLs, <span class="citation" data-cites="mentions">@mentions</span>, HTML artifacts (&amp;, &gt;, etc.), punctuation/numbers/emojis, and extra whitespace. I kept hashtag words for topic signal (e.g., #Inflation → inflation) but dropped the #.</p>
<p>Then I tokenized, removed English stopwords, built a document-feature matrix, and lightly trimmed very rare terms (min_termfreq = 5) to reduce one-off noise. A quick peek at top terms after cleaning looked reasonable and content-bearing.</p>
<p>I intentionally did not use stemming/lemmatization (to keep words readable), didn’t build n-grams, and didn’t apply TF-IDF at this stage—the goal here was just a clear, simple token set for downstream analysis.</p>
</section>
<section id="question-3" class="level2">
<h2 class="anchored" data-anchor-id="question-3">Question 3</h2>
<p>Using <a href="https://github.com/matthewjdenny/preText">Danny and Spirling’s Pretext</a>, tell me which of the pre-processing steps makes a more substantive difference in the data transformation? Would you keep all these steps or would you follow the PreText recommendations? Use a sample of the data to solve this question.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"remotes"</span>, <span class="st">"BiocManager"</span>))  <span class="co"># BiocManager is harmless; some deps check it</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in contrib.url(repos, "source"): trying to use CRAN without setting a mirror</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"matthewjdenny/preText"</span>, <span class="at">build_vignettes =</span> <span class="cn">FALSE</span>, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(preText)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a small, clean sample (preText can be slow on 100k+ docs)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>q3_sample <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(text), <span class="fu">nchar</span>(text) <span class="sc">&gt;</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">1500</span>) <span class="sc">%&gt;%</span>               </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(text) <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.character</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run factorial preprocessing across many schemes</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ngrams off to save time</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>pre_docs <span class="ot">&lt;-</span> preText<span class="sc">::</span><span class="fu">factorial_preprocessing</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  q3_sample,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">use_ngrams =</span> <span class="cn">FALSE</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">infrequent_term_threshold =</span> <span class="fl">0.01</span>,          <span class="co"># drop terms in &lt;1% of docs within each scheme</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">TRUE</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Preprocessing 1500 documents 64 different ways...
Currently working on combination 1 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 6841 of 7195 total terms that appeared in less than 15 documents.
Currently working on combination 2 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 6851 of 7224 total terms that appeared in less than 15 documents.
Currently working on combination 3 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 6972 of 7334 total terms that appeared in less than 15 documents.
Currently working on combination 4 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 6982 of 7363 total terms that appeared in less than 15 documents.
Currently working on combination 5 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 6969 of 7322 total terms that appeared in less than 15 documents.
Currently working on combination 6 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 6979 of 7351 total terms that appeared in less than 15 documents.
Currently working on combination 7 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 7100 of 7461 total terms that appeared in less than 15 documents.
Currently working on combination 8 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 7110 of 7490 total terms that appeared in less than 15 documents.
Currently working on combination 9 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8354 of 8670 total terms that appeared in less than 15 documents.
Currently working on combination 10 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8364 of 8699 total terms that appeared in less than 15 documents.
Currently working on combination 11 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8485 of 8809 total terms that appeared in less than 15 documents.
Currently working on combination 12 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8495 of 8838 total terms that appeared in less than 15 documents.
Currently working on combination 13 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8354 of 8670 total terms that appeared in less than 15 documents.
Currently working on combination 14 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8364 of 8699 total terms that appeared in less than 15 documents.
Currently working on combination 15 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8485 of 8809 total terms that appeared in less than 15 documents.
Currently working on combination 16 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8495 of 8838 total terms that appeared in less than 15 documents.
Currently working on combination 17 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 6877 of 7329 total terms that appeared in less than 15 documents.
Currently working on combination 18 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 6887 of 7358 total terms that appeared in less than 15 documents.
Currently working on combination 19 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 7008 of 7468 total terms that appeared in less than 15 documents.
Currently working on combination 20 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 7018 of 7497 total terms that appeared in less than 15 documents.
Currently working on combination 21 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 7010 of 7461 total terms that appeared in less than 15 documents.
Currently working on combination 22 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 7020 of 7490 total terms that appeared in less than 15 documents.
Currently working on combination 23 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 7141 of 7600 total terms that appeared in less than 15 documents.
Currently working on combination 24 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 7151 of 7629 total terms that appeared in less than 15 documents.
Currently working on combination 25 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8403 of 8823 total terms that appeared in less than 15 documents.
Currently working on combination 26 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8413 of 8852 total terms that appeared in less than 15 documents.
Currently working on combination 27 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8534 of 8962 total terms that appeared in less than 15 documents.
Currently working on combination 28 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8544 of 8991 total terms that appeared in less than 15 documents.
Currently working on combination 29 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8403 of 8823 total terms that appeared in less than 15 documents.
Currently working on combination 30 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8413 of 8852 total terms that appeared in less than 15 documents.
Currently working on combination 31 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8534 of 8962 total terms that appeared in less than 15 documents.
Currently working on combination 32 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 8544 of 8991 total terms that appeared in less than 15 documents.
Currently working on combination 33 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 34 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 35 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 36 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 37 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 38 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 39 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 40 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 41 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 42 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 43 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 44 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 45 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 46 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 47 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 48 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 49 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 50 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 51 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 52 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 53 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 54 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 55 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 56 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 57 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 58 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 59 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 60 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 61 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 62 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 63 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 64 of 64 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute preText scores (how much each scheme changes doc distances)</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>pt_res <span class="ot">&lt;-</span> preText<span class="sc">::</span><span class="fu">preText</span>(</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  pre_docs,</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataset_name    =</span> <span class="st">"Midterm Candidates (sample)"</span>,</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">distance_method =</span> <span class="st">"cosine"</span>,</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">num_comparisons =</span> <span class="dv">50</span>,                      <span class="co"># use 50 for saving time</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">TRUE</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Generating document distances...
Currently working on dfm 1 of 64 
Complete in: 6.681 seconds...
Currently working on dfm 2 of 64 
Complete in: 2.718 seconds...
Currently working on dfm 3 of 64 
Complete in: 2.654 seconds...
Currently working on dfm 4 of 64 
Complete in: 7.242 seconds...
Currently working on dfm 5 of 64 
Complete in: 2.58 seconds...
Currently working on dfm 6 of 64 
Complete in: 7.157 seconds...
Currently working on dfm 7 of 64 
Complete in: 2.676 seconds...
Currently working on dfm 8 of 64 
Complete in: 2.631 seconds...
Currently working on dfm 9 of 64 
Complete in: 5.07 seconds...
Currently working on dfm 10 of 64 
Complete in: 2.627 seconds...
Currently working on dfm 11 of 64 
Complete in: 5.225 seconds...
Currently working on dfm 12 of 64 
Complete in: 2.625 seconds...
Currently working on dfm 13 of 64 
Complete in: 5.08 seconds...
Currently working on dfm 14 of 64 
Complete in: 2.63 seconds...
Currently working on dfm 15 of 64 
Complete in: 5.141 seconds...
Currently working on dfm 16 of 64 
Complete in: 2.64 seconds...
Currently working on dfm 17 of 64 
Complete in: 2.619 seconds...
Currently working on dfm 18 of 64 
Complete in: 2.65 seconds...
Currently working on dfm 19 of 64 
Complete in: 2.643 seconds...
Currently working on dfm 20 of 64 
Complete in: 2.66 seconds...
Currently working on dfm 21 of 64 
Complete in: 7.118 seconds...
Currently working on dfm 22 of 64 
Complete in: 2.672 seconds...
Currently working on dfm 23 of 64 
Complete in: 2.626 seconds...
Currently working on dfm 24 of 64 
Complete in: 2.669 seconds...
Currently working on dfm 25 of 64 
Complete in: 2.623 seconds...
Currently working on dfm 26 of 64 
Complete in: 2.669 seconds...
Currently working on dfm 27 of 64 
Complete in: 2.744 seconds...
Currently working on dfm 28 of 64 
Complete in: 2.716 seconds...
Currently working on dfm 29 of 64 
Complete in: 2.634 seconds...
Currently working on dfm 30 of 64 
Complete in: 2.666 seconds...
Currently working on dfm 31 of 64 
Complete in: 2.641 seconds...
Currently working on dfm 32 of 64 
Complete in: 2.671 seconds...
Currently working on dfm 33 of 64 
Complete in: 2.715 seconds...
Currently working on dfm 34 of 64 
Complete in: 2.628 seconds...
Currently working on dfm 35 of 64 
Complete in: 2.62 seconds...
Currently working on dfm 36 of 64 
Complete in: 2.62 seconds...
Currently working on dfm 37 of 64 
Complete in: 2.607 seconds...
Currently working on dfm 38 of 64 
Complete in: 2.631 seconds...
Currently working on dfm 39 of 64 
Complete in: 2.607 seconds...
Currently working on dfm 40 of 64 
Complete in: 2.658 seconds...
Currently working on dfm 41 of 64 
Complete in: 2.596 seconds...
Currently working on dfm 42 of 64 
Complete in: 2.622 seconds...
Currently working on dfm 43 of 64 
Complete in: 2.591 seconds...
Currently working on dfm 44 of 64 
Complete in: 2.656 seconds...
Currently working on dfm 45 of 64 
Complete in: 2.588 seconds...
Currently working on dfm 46 of 64 
Complete in: 2.754 seconds...
Currently working on dfm 47 of 64 
Complete in: 2.599 seconds...
Currently working on dfm 48 of 64 
Complete in: 2.677 seconds...
Currently working on dfm 49 of 64 
Complete in: 2.631 seconds...
Currently working on dfm 50 of 64 
Complete in: 2.67 seconds...
Currently working on dfm 51 of 64 
Complete in: 2.65 seconds...
Currently working on dfm 52 of 64 
Complete in: 2.664 seconds...
Currently working on dfm 53 of 64 
Complete in: 2.637 seconds...
Currently working on dfm 54 of 64 
Complete in: 2.666 seconds...
Currently working on dfm 55 of 64 
Complete in: 2.678 seconds...
Currently working on dfm 56 of 64 
Complete in: 2.678 seconds...
Currently working on dfm 57 of 64 
Complete in: 2.656 seconds...
Currently working on dfm 58 of 64 
Complete in: 2.786 seconds...
Currently working on dfm 59 of 64 
Complete in: 2.646 seconds...
Currently working on dfm 60 of 64 
Complete in: 2.702 seconds...
Currently working on dfm 61 of 64 
Complete in: 2.635 seconds...
Currently working on dfm 62 of 64 
Complete in: 2.683 seconds...
Currently working on dfm 63 of 64 
Complete in: 2.641 seconds...
Currently working on dfm 64 of 64 
Complete in: 2.682 seconds...
Generating preText Scores...
Currently working on DFM: 1 of 64 

Complete in: 5.551 seconds...
Currently working on DFM: 2 of 64 

Complete in: 5.37 seconds...
Currently working on DFM: 3 of 64 

Complete in: 5.358 seconds...
Currently working on DFM: 4 of 64 

Complete in: 5.401 seconds...
Currently working on DFM: 5 of 64 

Complete in: 5.36 seconds...
Currently working on DFM: 6 of 64 

Complete in: 5.363 seconds...
Currently working on DFM: 7 of 64 

Complete in: 5.445 seconds...
Currently working on DFM: 8 of 64 

Complete in: 5.385 seconds...
Currently working on DFM: 9 of 64 

Complete in: 5.349 seconds...
Currently working on DFM: 10 of 64 

Complete in: 5.342 seconds...
Currently working on DFM: 11 of 64 

Complete in: 5.355 seconds...
Currently working on DFM: 12 of 64 

Complete in: 5.394 seconds...
Currently working on DFM: 13 of 64 

Complete in: 5.392 seconds...
Currently working on DFM: 14 of 64 

Complete in: 5.442 seconds...
Currently working on DFM: 15 of 64 

Complete in: 5.341 seconds...
Currently working on DFM: 16 of 64 

Complete in: 5.348 seconds...
Currently working on DFM: 17 of 64 

Complete in: 5.415 seconds...
Currently working on DFM: 18 of 64 

Complete in: 5.358 seconds...
Currently working on DFM: 19 of 64 

Complete in: 5.333 seconds...
Currently working on DFM: 20 of 64 

Complete in: 5.461 seconds...
Currently working on DFM: 21 of 64 

Complete in: 5.387 seconds...
Currently working on DFM: 22 of 64 

Complete in: 5.36 seconds...
Currently working on DFM: 23 of 64 

Complete in: 5.352 seconds...
Currently working on DFM: 24 of 64 

Complete in: 5.343 seconds...
Currently working on DFM: 25 of 64 

Complete in: 5.422 seconds...
Currently working on DFM: 26 of 64 

Complete in: 5.363 seconds...
Currently working on DFM: 27 of 64 

Complete in: 5.515 seconds...
Currently working on DFM: 28 of 64 

Complete in: 5.336 seconds...
Currently working on DFM: 29 of 64 

Complete in: 5.34 seconds...
Currently working on DFM: 30 of 64 

Complete in: 5.391 seconds...
Currently working on DFM: 31 of 64 

Complete in: 5.366 seconds...
Currently working on DFM: 32 of 64 

Complete in: 5.339 seconds...
Currently working on DFM: 33 of 64 

Complete in: 5.383 seconds...
Currently working on DFM: 34 of 64 

Complete in: 5.493 seconds...
Currently working on DFM: 35 of 64 

Complete in: 5.327 seconds...
Currently working on DFM: 36 of 64 

Complete in: 5.365 seconds...
Currently working on DFM: 37 of 64 

Complete in: 5.342 seconds...
Currently working on DFM: 38 of 64 

Complete in: 5.396 seconds...
Currently working on DFM: 39 of 64 

Complete in: 5.355 seconds...
Currently working on DFM: 40 of 64 

Complete in: 5.486 seconds...
Currently working on DFM: 41 of 64 

Complete in: 5.343 seconds...
Currently working on DFM: 42 of 64 

Complete in: 5.365 seconds...
Currently working on DFM: 43 of 64 

Complete in: 5.384 seconds...
Currently working on DFM: 44 of 64 

Complete in: 5.356 seconds...
Currently working on DFM: 45 of 64 

Complete in: 5.343 seconds...
Currently working on DFM: 46 of 64 

Complete in: 5.356 seconds...
Currently working on DFM: 47 of 64 

Complete in: 5.473 seconds...
Currently working on DFM: 48 of 64 

Complete in: 5.353 seconds...
Currently working on DFM: 49 of 64 

Complete in: 5.351 seconds...
Currently working on DFM: 50 of 64 

Complete in: 5.357 seconds...
Currently working on DFM: 51 of 64 

Complete in: 5.401 seconds...
Currently working on DFM: 52 of 64 

Complete in: 5.341 seconds...
Currently working on DFM: 53 of 64 

Complete in: 5.466 seconds...
Currently working on DFM: 54 of 64 

Complete in: 5.356 seconds...
Currently working on DFM: 55 of 64 

Complete in: 5.379 seconds...
Currently working on DFM: 56 of 64 

Complete in: 5.397 seconds...
Currently working on DFM: 57 of 64 

Complete in: 5.346 seconds...
Currently working on DFM: 58 of 64 

Complete in: 5.344 seconds...
Currently working on DFM: 59 of 64 

Complete in: 5.35 seconds...
Currently working on DFM: 60 of 64 

Complete in: 5.503 seconds...
Currently working on DFM: 61 of 64 

Complete in: 5.356 seconds...
Currently working on DFM: 62 of 64 

Complete in: 5.372 seconds...
Currently working on DFM: 63 of 64 

Complete in: 5.358 seconds...
Currently working on DFM: 64 of 64 
Complete in: 0 seconds...
Generating regression results..
The R^2 for this model is: 0.1821478 
Regression results (negative coefficients imply less risk):
                 Variable Coefficient    SE
1               Intercept       0.132 0.013
2      Remove Punctuation      -0.015 0.010
3          Remove Numbers       0.002 0.010
4               Lowercase       0.004 0.010
5                Stemming      -0.010 0.010
6        Remove Stopwords       0.001 0.010
7 Remove Infrequent Terms       0.028 0.010
Complete in: 538.652 seconds...</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots: scores by scheme + marginal effects of each step</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>preText<span class="sc">::</span><span class="fu">preText_score_plot</span>(pt_res)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="problem_set_01_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>preText<span class="sc">::</span><span class="fu">regression_coefficient_plot</span>(pt_res, <span class="at">remove_intercept =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="problem_set_01_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Your thoughts and observations:</strong> PreText shows that the only preprocessing choice that materially changes the document representation is removing infrequent terms—it has the largest positive coefficient, meaning it alters distances between documents the most. In contrast, lowercasing, removing numbers, and removing stopwords have very small effects on the data, and stemming and removing punctuation slightly stabilize results (negative coefficients), likely by merging near-duplicate tokens. Practically, this means the model is sensitive to how aggressively you trim rare words; over-trimming can erase distinctive but informative tokens common in social media (unique hashtags, names, local issues). I would therefore keep light normalization (lowercase, stopwords, punctuation) and tune rare-term trimming conservatively (e.g., a lower threshold or an absolute count), using stemming only if you’re comfortable trading a bit of interpretability for stability.</p>
</section>
<section id="question-4" class="level2">
<h2 class="anchored" data-anchor-id="question-4">Question 4</h2>
<p>Pick an important source of variation in your data (for example: date, author identity, location, etc.). Subset the data along this dimension, and discuss which words discriminate better each group. You can do this by using TF-IDF, PMI, log(share <span class="math inline">\(word_i\)</span> in group a/share <span class="math inline">\(word_i\)</span> in b), or create a measure similar to Ban’s article.</p>
<p># Q4 — Party as source of variation; which words discriminate each group?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co"># build corpus and carry party labels as a docvar</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>party <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="st">"party"</span> <span class="sc">%in%</span> <span class="fu">names</span>(df)) df<span class="sc">$</span>party <span class="cf">else</span> df<span class="sc">$</span>party_clean</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>corp <span class="ot">&lt;-</span> <span class="fu">corpus</span>(df, <span class="at">text_field =</span> <span class="st">"text"</span>)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="co"># tokens -&gt; dfm (light trim)</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>toks <span class="ot">&lt;-</span> <span class="fu">tokens</span>(corp, <span class="at">remove_punct =</span> <span class="cn">TRUE</span>, <span class="at">remove_numbers =</span> <span class="cn">TRUE</span>)</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>D    <span class="ot">&lt;-</span> <span class="fu">dfm</span>(toks) <span class="sc">|&gt;</span> <span class="fu">dfm_trim</span>(<span class="at">min_termfreq =</span> <span class="dv">2</span>)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a><span class="co"># get group vector from docvars, keep only labeled rows</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">docvars</span>(D, <span class="st">"party"</span>)</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>keep <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">is.na</span>(p) <span class="sc">&amp;</span> <span class="fu">nzchar</span>(<span class="fu">as.character</span>(p))</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>D    <span class="ot">&lt;-</span> D[keep, ]</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>p    <span class="ot">&lt;-</span> p[keep]</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a><span class="co"># GROUP FIRST, then TF–IDF</span></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>Dby    <span class="ot">&lt;-</span> <span class="fu">dfm_group</span>(D, <span class="at">groups =</span> p)            <span class="co"># rows: party levels</span></span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>Dtf_by <span class="ot">&lt;-</span> <span class="fu">dfm_tfidf</span>(Dby, <span class="at">scheme_tf =</span> <span class="st">"prop"</span>)</span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a><span class="co"># top TF–IDF terms per party (prints)</span></span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>feat  <span class="ot">&lt;-</span> <span class="fu">featnames</span>(Dtf_by)</span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a>top_n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (lev <span class="cf">in</span> <span class="fu">rownames</span>(Dtf_by)) {</span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Dtf_by[lev, ]); <span class="fu">names</span>(v) <span class="ot">&lt;-</span> feat</span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a>  top <span class="ot">&lt;-</span> <span class="fu">head</span>(<span class="fu">sort</span>(v, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), top_n)</span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Top"</span>, lev, <span class="st">"TF-IDF terms:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">data.frame</span>(<span class="at">term =</span> <span class="fu">names</span>(top), <span class="at">tfidf =</span> <span class="fu">unname</span>(top)), <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb81-29"><a href="#cb81-29" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Top Democratic TF-IDF terms:
                    term        tfidf
                   #swfl 1.034646e-04
                  #ga_11 3.792903e-05
              #leecounty 3.696880e-05
                  banyai 3.516837e-05
            #byebyebarry 3.372803e-05
 https://t.co/k2t1bliyn1 2.964706e-05
            #forthefifth 2.796666e-05
          #colliercounty 2.760657e-05
            #gomcdermott 2.724649e-05
                #indiana 2.700643e-05

Top Republican TF-IDF terms:
                       term        tfidf
            @jeffontheright 9.635537e-05
          #takebackthehouse 4.691722e-05
                         🇭🇳 4.621696e-05
         #standupforamerica 4.411619e-05
                #teamscotty 4.187537e-05
         #jenniferruthgreen 3.767383e-05
 scottymooreforcongress.com 3.263198e-05
                 #marcforus 3.165162e-05
                      ny-21 3.109141e-05
                     scotty 3.067126e-05</code></pre>
</div>
</div>
<p><strong>thoughts and observations:</strong> I used party (Democrat vs.&nbsp;Republican) as the variation axis. After tokenizing, I grouped posts by party and computed TF-IDF, then took the top 10 tokens per group. Democrats’ top terms were mostly local/candidate tags (e.g., #swfl, county tags, banyai), while Republicans’ were national slogans/branding and handles (e.g., #takebackthehouse, #bidenflation, <span class="citation" data-cites="jeffontheright">@jeffontheright</span>). TF-IDF is clearly picking up party-specific campaign language; if I filter handles/URLs/hashtags and rerun, I’d expect more issue words to surface.</p>
</section>
<section id="question-5" class="level2">
<h2 class="anchored" data-anchor-id="question-5">Question 5</h2>
<p>Create a dictionary (or use a pre-existing dictionary) to measure a topic of interest in your data. It can be anything, sentiment, tone, misinformation, any topic of interest. Label your documents, and visualize the prevalence of your classes.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda.textstats)</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda.dictionaries)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda.sentiment)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="co"># read the csv file</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"/Users/zhaoshuti/Desktop/TAT/problem-set-01-2025-ShutiZhao/midterm_candidates_labeled_all_May05.csv"</span>)</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 134,629
Columns: 20
$ X                &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16…
$ created_at       &lt;chr&gt; "2022-10-19", "2022-10-20", "2022-10-03", "2022-10-12…
$ username         &lt;chr&gt; "sessionsforcongress", "randpaul", "katcammack", "kat…
$ text             &lt;chr&gt; "IT'S ALL TRUMP'S FAULT THAT SHE GOT KICKED OFF THE P…
$ name             &lt;chr&gt; "Pete Sessions", "Rand Paul", "Kat Cammack", "Kat Cam…
$ platform         &lt;chr&gt; "Facebook", "Facebook", "Facebook", "Facebook", "Face…
$ party_clean      &lt;chr&gt; "Republican", "Republican", "Republican", "Republican…
$ office_type      &lt;chr&gt; "House", "Senate", "House", "House", "Senate", "Senat…
$ office.name      &lt;chr&gt; "U.S. House Texas District 17", "U.S. Senate Kentucky…
$ gender           &lt;chr&gt; "Male", "Male", "Female", "Female", "Male", "Male", "…
$ incumbent.       &lt;chr&gt; "Yes", "Yes", "Yes", "Yes", "No", "No", "Yes", "Yes",…
$ candidate.status &lt;chr&gt; "On the Ballot", "On the Ballot", "On the Ballot", "O…
$ wonprimary       &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
$ vote             &lt;int&gt; 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,…
$ participation    &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,…
$ fundraising      &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ audience         &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ engagement       &lt;int&gt; 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ election_denial  &lt;chr&gt; "denier", "denier", "skeptic", "skeptic", NA, NA, "sk…
$ trump_endorsed   &lt;chr&gt; "endorsed", "endorsed", "endorsed", "endorsed", NA, N…</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a corpus</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>df_corpus <span class="ot">&lt;-</span> <span class="fu">corpus</span>(df, <span class="at">text_field =</span> <span class="st">"text"</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">docvars</span>(df_corpus, <span class="st">"party_clean"</span>) <span class="ot">&lt;-</span> df<span class="sc">$</span>party_clean</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="co"># make the tokens into a dfm</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>toks     <span class="ot">&lt;-</span> <span class="fu">tokens</span>(df_corpus, <span class="at">remove_punct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>dfm_all  <span class="ot">&lt;-</span> <span class="fu">dfm</span>(toks, <span class="at">tolower =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>dfm_trim <span class="ot">&lt;-</span> <span class="fu">dfm_trim</span>(dfm_all, <span class="at">min_termfreq =</span> <span class="dv">2</span>)</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a><span class="co"># lookup the dictionary </span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>dfm_sentiment <span class="ot">&lt;-</span> quanteda<span class="sc">::</span><span class="fu">dfm_lookup</span>(</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>  dfm_trim,</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">dictionary =</span> data_dictionary_LSD2015[<span class="fu">c</span>(<span class="st">"positive"</span>,<span class="st">"negative"</span>)]</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># per-doc counts -&gt; add metadata -&gt; majority label</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>sent_df <span class="ot">&lt;-</span> dfm_sentiment <span class="sc">|&gt;</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  quanteda<span class="sc">::</span><span class="fu">convert</span>(<span class="at">to =</span> <span class="st">"data.frame"</span>)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="co"># make the first column name doc_id</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(sent_df)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"doc_id"</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ensure count columns exist</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="st">"positive"</span> <span class="sc">%in%</span> <span class="fu">names</span>(sent_df)) sent_df<span class="sc">$</span>positive <span class="ot">&lt;-</span> <span class="dv">0</span>L</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="st">"negative"</span> <span class="sc">%in%</span> <span class="fu">names</span>(sent_df)) sent_df<span class="sc">$</span>negative <span class="ot">&lt;-</span> <span class="dv">0</span>L</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>sent_df <span class="ot">&lt;-</span> sent_df <span class="sc">|&gt;</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">doc_id      =</span> quanteda<span class="sc">::</span><span class="fu">docnames</span>(dfm_trim),</span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">party_clean =</span> quanteda<span class="sc">::</span><span class="fu">docvars</span>(dfm_trim, <span class="st">"party_clean"</span>)</span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"doc_id"</span></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">positive =</span> tidyr<span class="sc">::</span><span class="fu">replace_na</span>(positive, <span class="dv">0</span>L),</span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">negative =</span> tidyr<span class="sc">::</span><span class="fu">replace_na</span>(negative, <span class="dv">0</span>L),</span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">major_sentiment =</span> <span class="fu">case_when</span>(</span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a>      positive <span class="sc">&gt;</span> negative <span class="sc">~</span> <span class="st">"Positive"</span>,</span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a>      negative <span class="sc">&gt;</span> positive <span class="sc">~</span> <span class="st">"Negative"</span>,</span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Neutral"</span></span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show sentiment distribution</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="co"># overall prevalence</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>sent_df <span class="sc">|&gt;</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(major_sentiment) <span class="sc">|&gt;</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(major_sentiment, n, <span class="at">fill =</span> major_sentiment)) <span class="sc">+</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="problem_set_01_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># by party (Dem vs Rep)</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>sent_df <span class="sc">|&gt;</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">party2 =</span> <span class="fu">case_when</span>(</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(party_clean, <span class="fu">regex</span>(<span class="st">"dem"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">~</span> <span class="st">"Democrat"</span>,</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(party_clean, <span class="fu">regex</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">b(rep|gop)</span><span class="sc">\\</span><span class="st">b"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">~</span> <span class="st">"Republican"</span>,</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Other"</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(party2 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Democrat"</span>,<span class="st">"Republican"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(major_sentiment, party2) <span class="sc">|&gt;</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(major_sentiment, n, <span class="at">fill =</span> party2)) <span class="sc">+</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="problem_set_01_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>thoughts and observations:</strong> I measured sentiment with the LSD2015 dictionary (positive/negative). I tokenized, lowercased, removed punctuation, built a dfm, and counted dictionary hits. Each post got a Positive, Negative, or Neutral label by simple majority (ties → Neutral).</p>
<p>The prevalence plot shows a clear Positive &gt; Neutral &gt; Negative pattern overall. Splitting by party, both Democrats and Republicans follow the same ordering—campaign posts are mostly upbeat.</p>
<p>Limitations: bag-of-words and no context (e.g., negation, sarcasm). It’s a clean baseline; in Q6 I add a tiny negation tweak to handle phrases like “not support.”</p>
</section>
<section id="question-6" class="level2">
<h2 class="anchored" data-anchor-id="question-6">Question 6</h2>
<p>Pick some documents (at least 10 for each class) that are exemplar (high probability) of being for each class of your dictionary. Read these documents. Now let’s try to augment a little your classifier.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make sure text is available</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>quanteda<span class="sc">::</span><span class="fu">docvars</span>(dfm_trim, <span class="st">"text"</span>) <span class="ot">&lt;-</span> df<span class="sc">$</span>text</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>docnames_vec <span class="ot">&lt;-</span> quanteda<span class="sc">::</span><span class="fu">docnames</span>(dfm_trim)</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>text_vec     <span class="ot">&lt;-</span> quanteda<span class="sc">::</span><span class="fu">docvars</span>(dfm_trim, <span class="st">"text"</span>)</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>party_vec    <span class="ot">&lt;-</span> quanteda<span class="sc">::</span><span class="fu">docvars</span>(dfm_trim, <span class="st">"party_clean"</span>)</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="co"># confidence margin</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>sent_df<span class="sc">$</span>margin <span class="ot">&lt;-</span> <span class="fu">abs</span>(sent_df<span class="sc">$</span>positive <span class="sc">-</span> sent_df<span class="sc">$</span>negative)</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>pick_top <span class="ot">&lt;-</span> <span class="cf">function</span>(df, label, <span class="at">k =</span> <span class="dv">10</span>) {</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>  sub <span class="ot">&lt;-</span> df[df<span class="sc">$</span>major_sentiment <span class="sc">==</span> label, ]</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>  sub <span class="ot">&lt;-</span> sub[<span class="fu">order</span>(<span class="sc">-</span>sub<span class="sc">$</span>margin, <span class="sc">-</span>sub<span class="sc">$</span>positive, sub<span class="sc">$</span>negative), ]</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>  sub <span class="ot">&lt;-</span> <span class="fu">head</span>(sub, k)</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>  idx <span class="ot">&lt;-</span> <span class="fu">match</span>(sub<span class="sc">$</span>doc_id, docnames_vec)</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>  sub<span class="sc">$</span>party   <span class="ot">&lt;-</span> party_vec[idx]</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>  sub<span class="sc">$</span>text    <span class="ot">&lt;-</span> text_vec[idx]</span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>  sub<span class="sc">$</span>preview <span class="ot">&lt;-</span> <span class="fu">substr</span>(sub<span class="sc">$</span>text, <span class="dv">1</span>, <span class="dv">160</span>)</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>  sub[, <span class="fu">c</span>(<span class="st">"major_sentiment"</span>,<span class="st">"party"</span>,<span class="st">"doc_id"</span>,<span class="st">"positive"</span>,<span class="st">"negative"</span>,<span class="st">"margin"</span>,<span class="st">"preview"</span>)]</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>ex_pos_before <span class="ot">&lt;-</span> <span class="fu">pick_top</span>(sent_df, <span class="st">"Positive"</span>, <span class="dv">10</span>)</span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a>ex_neg_before <span class="ot">&lt;-</span> <span class="fu">pick_top</span>(sent_df, <span class="st">"Negative"</span>, <span class="dv">10</span>)</span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a>exemplars_before <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transform</span>(ex_pos_before, <span class="at">class =</span> <span class="st">"positive"</span>),</span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transform</span>(ex_neg_before, <span class="at">class =</span> <span class="st">"negative"</span>)</span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(exemplars_before, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> major_sentiment      party    doc_id positive negative margin
        Positive Democratic text34149      678      226    452
        Positive Democratic text34146      714      287    427
        Positive Republican text34531      549      211    338
        Positive Republican text34172      539      218    321
        Positive Democratic text34150      441      132    309
        Positive Republican text34167      566      270    296
        Positive Republican text34088      546      252    294
        Positive Democratic text34311      459      188    271
        Positive Democratic text34314      449      191    258
        Positive Democratic text34262      536      285    251
        Negative Democratic  text8506       17       56     39
        Negative Democratic  text2552       35       71     36
        Negative Democratic  text2660       15       44     29
        Negative Republican text34076       25       51     26
        Negative Republican  text4784       22       48     26
        Negative Democratic   text331       26       51     25
        Negative Democratic text22280       13       38     25
        Negative Republican text16016       22       46     24
        Negative Republican text13280       10       33     23
        Negative Republican text14699       15       36     21
                                                                                                                                                          preview
 okay this is the way we're gonna work today um I want to speak for a couple of minutes about our our relation ship and the next item on the agenda would be I'll
 so um like as I said five minutes and we will begin this evening with the state representative for district 70 which is the Western half of Greene County and we
 99.1 Lorinda Shenandoah thanks for joining us tonight on kma for this candidates Forum featuring the two candidates running for Iowa's third congressional distr
 things we've been told to worry about things and worry about this and the shiny objects and getting on the hamster wheel of debt and we don't realize we're hams
 you know when we um when we look at what's going on um about a year ago I got really really concerned because as political science and business major at Miami U
 hello and welcome to diaspberry UA Channel my name is Andrea zarkin and today we welcome our dear guest and um our um perspective congressman the person who's r
 foreign [Music] hi I'm John Paul Moran from Grant opportunity USA or go USA the host and moderator for today's op score debate with or without the candidates fo
 we're usually 10 minutes late to everything so thank you all for Gathering here today and the opportunity to get together this is our 12th Town Hall of 15. you'
 representative to show up in the community to talk with folks across the political Spectrum for one second so right where you're standing first welcome Delgado 
 good evening and welcome everybody thank you so much for being here tonight and braving the rain which we did not expect my name is Scott Ashton I'm the CEO of 
 ICYMI: My OpEd in today's Daily News: Sixteen years ago this week, I was due to have a baby girl. My pregnancy was normal well into my second trimester, until I
 I have been working very hard and acknowledge I am not posting enough, but I am very worried and disturbed by many things I am witnessing right now. I want to t
 Over the last few weeks, the Republican plan for reducing inflation has come into view. They’ve long said they wanted to “reduce spending,” but without much det
 candidates I want to talk about the outbreak of political violence that we've seen especially the recent headlines start with you Mr Schumer the recent home inv
 Good morning! It’s Thursday and we’re in 2 Samuel 12 today. “And the Lord sent Nathan to David. He came to him and said to him, “There were two men in a certain
 The Star-Ledger Editorial Board: "We are witnessing the final act in Tom Kean Jr.’s campaign for Congress, an attempt to squeak out a win by smearing his Democr
 Gaetz has voted against funding law enforcement agencies, combatting terrorism, and protecting children and families at every opportunity. Gaetz voted NO on the
 TAMPA, Fla. – James Judge, the Republican nominee for Congress in Florida’s 14th Congressional District, which makes up Tampa and St. Petersburg, slammed the Bi
 With 5 weeks until Election Day, my opponent, like many Democrats running across the country, is attempting to camouflage his liberal soft-on-crime record and d
 Good morning! It’s Wednesday. Today were in 2 Samuel 19. “It was told Joab, “Behold, the king is weeping and mourning for Absalom.” So the victory that day was 
    class
 positive
 positive
 positive
 positive
 positive
 positive
 positive
 positive
 positive
 positive
 negative
 negative
 negative
 negative
 negative
 negative
 negative
 negative
 negative
 negative</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add full text to exemplars (match doc_id -&gt; dfm docs)</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>ex_pos_before<span class="sc">$</span>text <span class="ot">&lt;-</span> quanteda<span class="sc">::</span><span class="fu">docvars</span>(dfm_trim, <span class="st">"text"</span>)[<span class="fu">match</span>(ex_pos_before<span class="sc">$</span>doc_id,</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>                                                                quanteda<span class="sc">::</span><span class="fu">docnames</span>(dfm_trim))]</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>ex_neg_before<span class="sc">$</span>text <span class="ot">&lt;-</span> quanteda<span class="sc">::</span><span class="fu">docvars</span>(dfm_trim, <span class="st">"text"</span>)[<span class="fu">match</span>(ex_neg_before<span class="sc">$</span>doc_id,</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>                                                                quanteda<span class="sc">::</span><span class="fu">docnames</span>(dfm_trim))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Treat "not/never/can't…" + (support/help/good/great/happy/proud/thank/win/love) as negative</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>neg_re <span class="ot">&lt;-</span> <span class="st">"(?:</span><span class="sc">\\</span><span class="st">bnot</span><span class="sc">\\</span><span class="st">b|</span><span class="sc">\\</span><span class="st">bno</span><span class="sc">\\</span><span class="st">b|</span><span class="sc">\\</span><span class="st">bnever</span><span class="sc">\\</span><span class="st">b|isn['’]?t|wasn['’]?t|can['’]?t|won['’]?t|don['’]?t|doesn['’]?t|didn['’]?t|cannot)</span><span class="sc">\\</span><span class="st">s+(support|help|good|great|happy|proud|thank|win|love)"</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>relabel_aug <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">tolower</span>(df<span class="sc">$</span>text)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  negated_pos <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_count</span>(t, neg_re)</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>pos_aug  <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="dv">0</span>L, df<span class="sc">$</span>positive <span class="sc">-</span> negated_pos)</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>neg_aug  <span class="ot">&lt;-</span> df<span class="sc">$</span>negative <span class="sc">+</span> negated_pos</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>label_aug <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>pos_aug <span class="sc">&gt;</span> df<span class="sc">$</span>neg_aug, <span class="st">"Positive"</span>,</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ifelse</span>(df<span class="sc">$</span>neg_aug <span class="sc">&gt;</span> df<span class="sc">$</span>pos_aug, <span class="st">"Negative"</span>, <span class="st">"Neutral"</span>))</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>  df</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>ex_after <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">relabel_aug</span>(ex_pos_before), <span class="fu">relabel_aug</span>(ex_neg_before))</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Show any flips</span></span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>flips <span class="ot">&lt;-</span> ex_after[ex_after<span class="sc">$</span>label_aug <span class="sc">!=</span> ex_after<span class="sc">$</span>major_sentiment,</span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">c</span>(<span class="st">"doc_id"</span>,<span class="st">"major_sentiment"</span>,<span class="st">"label_aug"</span>,<span class="st">"positive"</span>,<span class="st">"negative"</span>,<span class="st">"pos_aug"</span>,<span class="st">"neg_aug"</span>,<span class="st">"preview"</span>)]</span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(flips)) <span class="fu">print</span>(flips, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># top 10 exemplars per class</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>exemplars_before <span class="sc">%&gt;%</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(class, doc_id, preview) <span class="sc">%&gt;%</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(class) <span class="sc">%&gt;%</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(class) <span class="sc">%&gt;%</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 3
# Groups:   class [2]
   class    doc_id    preview                                                   
   &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;                                                     
 1 negative text8506  "ICYMI: My OpEd in today's Daily News: Sixteen years ago …
 2 negative text2552  "I have been working very hard and acknowledge I am not p…
 3 negative text2660  "Over the last few weeks, the Republican plan for reducin…
 4 negative text34076 "candidates I want to talk about the outbreak of politica…
 5 negative text4784  "Good morning! It’s Thursday and we’re in 2 Samuel 12 tod…
 6 negative text331   "The Star-Ledger Editorial Board: \"We are witnessing the…
 7 negative text22280 "Gaetz has voted against funding law enforcement agencies…
 8 negative text16016 "TAMPA, Fla. – James Judge, the Republican nominee for Co…
 9 negative text13280 "With 5 weeks until Election Day, my opponent, like many …
10 negative text14699 "Good morning! It’s Wednesday. Today were in 2 Samuel 19.…
11 positive text34149 "okay this is the way we're gonna work today um I want to…
12 positive text34146 "so um like as I said five minutes and we will begin this…
13 positive text34531 "99.1 Lorinda Shenandoah thanks for joining us tonight on…
14 positive text34172 "things we've been told to worry about things and worry a…
15 positive text34150 "you know when we um when we look at what's going on um a…
16 positive text34167 "hello and welcome to diaspberry UA Channel my name is An…
17 positive text34088 "foreign [Music] hi I'm John Paul Moran from Grant opport…
18 positive text34311 "we're usually 10 minutes late to everything so thank you…
19 positive text34314 "representative to show up in the community to talk with …
20 positive text34262 "good evening and welcome everybody thank you so much for…</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># class counts before vs after</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>before_counts <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(sent_df<span class="sc">$</span>major_sentiment))</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>after_counts  <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(ex_after<span class="sc">$</span>label_aug))</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Class counts BEFORE:</span><span class="sc">\n</span><span class="st">"</span>); <span class="fu">print</span>(before_counts, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Class counts BEFORE:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     Var1  Freq
 Negative 24331
  Neutral 36008
 Positive 74290</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Class counts AFTER:</span><span class="sc">\n</span><span class="st">"</span>);  <span class="fu">print</span>(after_counts,  <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Class counts AFTER:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     Var1 Freq
 Negative   10
 Positive   10</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># flips summary and a few examples</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>flips <span class="ot">&lt;-</span> ex_after[ex_after<span class="sc">$</span>label_aug <span class="sc">!=</span> ex_after<span class="sc">$</span>major_sentiment,</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">c</span>(<span class="st">"doc_id"</span>,<span class="st">"major_sentiment"</span>,<span class="st">"label_aug"</span>,<span class="st">"preview"</span>)]</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Flips after augmentation:"</span>, <span class="fu">nrow</span>(flips), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Flips after augmentation: 0 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(flips) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(utils<span class="sc">::</span><span class="fu">head</span>(flips, <span class="dv">5</span>), <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>thoughts and observations:</strong> I picked exemplars where only one side of the dictionary fired (positive&gt;0 &amp; negative=0, or negative&gt;0 &amp; positive=0) with total hits &gt;5, then took 10 per class and read short previews. Negative exemplars were critiques/attack/problem posts (op-eds, complaints, issue contrasts). Positive exemplars were outreach/celebration posts—greetings, thanks, welcomes, community/event language. These match the dictionary’s intent.</p>
<p>Class balance (overall). Before augmentation the corpus skews positive: Positive ≈ 74k, Neutral ≈ 36k, Negative ≈ 24k—consistent with lots of thanking/announcements.</p>
<p>Augmentation &amp; effect. I added a tiny negation rule (e.g., “not/never/can’t + support/help/good…” counts against positive). On the exemplar subset there were 0 flips—expected because they’re high-confidence, one-sided cases.</p>
<p>The dictionary behaves as intended on clear examples. The negation tweak is a safe improvement; next steps would be adding an alerts/disaster bucket (e.g., outage, emergency, rumor) and a few celebration terms (blessed, grateful, congrats), while treating ambiguous words like “support” as context-dependent.</p>
<section id="question-6.1" class="level3">
<h3 class="anchored" data-anchor-id="question-6.1">Question 6.1</h3>
<p>Using cosine similarity, grab the closest 10 documents to each reference document you read before. Read those. How well does the cosine similarity work? Try with another measure of distance. Anything interesting there?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the reference documents</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>ref_docs <span class="ot">&lt;-</span> <span class="fu">head</span>(<span class="fu">docnames</span>(dfm_trim), <span class="dv">3</span>)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="co"># keep raw text + a simple doc id in docvars to join later</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="fu">docvars</span>(dfm_trim, <span class="st">"text"</span>) <span class="ot">&lt;-</span> df<span class="sc">$</span>text[<span class="fu">seq_len</span>(<span class="fu">ndoc</span>(dfm_trim))]</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="fu">docvars</span>(dfm_trim, <span class="st">"doc"</span>)  <span class="ot">&lt;-</span> <span class="fu">docnames</span>(dfm_trim)</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="co"># build a tiny table with reference texts</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>sample_text <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">doc_id =</span> ref_docs,</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">text   =</span> <span class="fu">docvars</span>(dfm_trim, <span class="st">"text"</span>)[<span class="fu">match</span>(ref_docs, <span class="fu">docnames</span>(dfm_trim))]</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a><span class="co"># COSINE</span></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>closest_cosine <span class="ot">&lt;-</span> <span class="fu">textstat_simil</span>(</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>  dfm_trim,</span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> dfm_trim[ref_docs, ],</span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">margin =</span> <span class="st">"documents"</span>,</span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"cosine"</span></span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(document2) <span class="sc">%&gt;%</span></span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(cosine), <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">doc     =</span> document1,</span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">ref_doc =</span> document2</span>
<span id="cb104-28"><a href="#cb104-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb104-29"><a href="#cb104-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add neighbor text</span></span>
<span id="cb104-30"><a href="#cb104-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb104-31"><a href="#cb104-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">docvars</span>(dfm_trim) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(doc, text),</span>
<span id="cb104-32"><a href="#cb104-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"doc"</span></span>
<span id="cb104-33"><a href="#cb104-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb104-34"><a href="#cb104-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add reference text</span></span>
<span id="cb104-35"><a href="#cb104-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb104-36"><a href="#cb104-36" aria-hidden="true" tabindex="-1"></a>    sample_text <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">ref_doc =</span> doc_id, <span class="at">ref_text =</span> text),</span>
<span id="cb104-37"><a href="#cb104-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"ref_doc"</span></span>
<span id="cb104-38"><a href="#cb104-38" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb104-39"><a href="#cb104-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-40"><a href="#cb104-40" aria-hidden="true" tabindex="-1"></a><span class="co"># peek </span></span>
<span id="cb104-41"><a href="#cb104-41" aria-hidden="true" tabindex="-1"></a>closest_cosine <span class="sc">%&gt;%</span></span>
<span id="cb104-42"><a href="#cb104-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ref_doc, ref_text, doc, text, cosine) <span class="sc">%&gt;%</span></span>
<span id="cb104-43"><a href="#cb104-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ref_doc, <span class="fu">desc</span>(cosine)) <span class="sc">%&gt;%</span></span>
<span id="cb104-44"><a href="#cb104-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">30</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 × 5
# Groups:   ref_doc [3]
   ref_doc ref_text                                           doc   text  cosine
   &lt;chr&gt;   &lt;chr&gt;                                              &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt;
 1 text1   IT'S ALL TRUMP'S FAULT THAT SHE GOT KICKED OFF TH… text… "She…  0.369
 2 text1   IT'S ALL TRUMP'S FAULT THAT SHE GOT KICKED OFF TH… text… "Thi…  0.369
 3 text1   IT'S ALL TRUMP'S FAULT THAT SHE GOT KICKED OFF TH… text… "It'…  0.368
 4 text1   IT'S ALL TRUMP'S FAULT THAT SHE GOT KICKED OFF TH… text… "It'…  0.368
 5 text1   IT'S ALL TRUMP'S FAULT THAT SHE GOT KICKED OFF TH… text… "@Da…  0.367
 6 text1   IT'S ALL TRUMP'S FAULT THAT SHE GOT KICKED OFF TH… text… "A s…  0.360
 7 text1   IT'S ALL TRUMP'S FAULT THAT SHE GOT KICKED OFF TH… text… "It'…  0.348
 8 text1   IT'S ALL TRUMP'S FAULT THAT SHE GOT KICKED OFF TH… text… "loo…  0.342
 9 text1   IT'S ALL TRUMP'S FAULT THAT SHE GOT KICKED OFF TH… text… "Wel…  0.337
10 text1   IT'S ALL TRUMP'S FAULT THAT SHE GOT KICKED OFF TH… text… "I h…  0.335
11 text2   Happy Anniversary, Kelley Paul! I’m truly blessed… text… "Hap…  0.910
12 text2   Happy Anniversary, Kelley Paul! I’m truly blessed… text… "Hap…  0.910
13 text2   Happy Anniversary, Kelley Paul! I’m truly blessed… text… "Hap…  0.560
14 text2   Happy Anniversary, Kelley Paul! I’m truly blessed… text… "Hap…  0.550
15 text2   Happy Anniversary, Kelley Paul! I’m truly blessed… text… "Hap…  0.550
16 text2   Happy Anniversary, Kelley Paul! I’m truly blessed… text… "ICY…  0.489
17 text2   Happy Anniversary, Kelley Paul! I’m truly blessed… text… "ICY…  0.481
18 text2   Happy Anniversary, Kelley Paul! I’m truly blessed… text… "Hap…  0.478
19 text2   Happy Anniversary, Kelley Paul! I’m truly blessed… text… "Hap…  0.455
20 text2   Happy Anniversary, Kelley Paul! I’m truly blessed… text… "Hap…  0.450
21 text3   Hurricane Ian: quick update on the rumor mill — l… text… "Goo…  0.630
22 text3   Hurricane Ian: quick update on the rumor mill — l… text… "Goo…  0.626
23 text3   Hurricane Ian: quick update on the rumor mill — l… text… "Goo…  0.611
24 text3   Hurricane Ian: quick update on the rumor mill — l… text… "*th…  0.606
25 text3   Hurricane Ian: quick update on the rumor mill — l… text… "Goo…  0.598
26 text3   Hurricane Ian: quick update on the rumor mill — l… text… "Wal…  0.595
27 text3   Hurricane Ian: quick update on the rumor mill — l… text… "Goo…  0.585
28 text3   Hurricane Ian: quick update on the rumor mill — l… text… "Ele…  0.585
29 text3   Hurricane Ian: quick update on the rumor mill — l… text… "The…  0.584
30 text3   Hurricane Ian: quick update on the rumor mill — l… text… "Goo…  0.584</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation similarity</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>closest_cor <span class="ot">&lt;-</span> <span class="fu">textstat_simil</span>(</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  dfm_trim,</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> dfm_trim[ref_docs, ],</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">margin =</span> <span class="st">"documents"</span>,</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"correlation"</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(document2) <span class="sc">%&gt;%</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(correlation), <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">doc     =</span> document1,</span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">ref_doc =</span> document2</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">docvars</span>(dfm_trim) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(doc, text),</span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"doc"</span></span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a>    sample_text <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">ref_doc =</span> doc_id, <span class="at">ref_text =</span> text),</span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"ref_doc"</span></span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb106-24"><a href="#cb106-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-25"><a href="#cb106-25" aria-hidden="true" tabindex="-1"></a>closest_cor <span class="sc">%&gt;%</span></span>
<span id="cb106-26"><a href="#cb106-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ref_doc, ref_text, doc, text, correlation) <span class="sc">%&gt;%</span></span>
<span id="cb106-27"><a href="#cb106-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ref_doc, <span class="fu">desc</span>(correlation)) <span class="sc">%&gt;%</span></span>
<span id="cb106-28"><a href="#cb106-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">30</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 × 5
# Groups:   ref_doc [3]
   ref_doc ref_text                                      doc   text  correlation
   &lt;chr&gt;   &lt;chr&gt;                                         &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt;
 1 text1   IT'S ALL TRUMP'S FAULT THAT SHE GOT KICKED O… text… "Thi…       0.369
 2 text1   IT'S ALL TRUMP'S FAULT THAT SHE GOT KICKED O… text… "She…       0.369
 3 text1   IT'S ALL TRUMP'S FAULT THAT SHE GOT KICKED O… text… "It'…       0.368
 4 text1   IT'S ALL TRUMP'S FAULT THAT SHE GOT KICKED O… text… "It'…       0.368
 5 text1   IT'S ALL TRUMP'S FAULT THAT SHE GOT KICKED O… text… "@Da…       0.367
 6 text1   IT'S ALL TRUMP'S FAULT THAT SHE GOT KICKED O… text… "A s…       0.359
 7 text1   IT'S ALL TRUMP'S FAULT THAT SHE GOT KICKED O… text… "It'…       0.348
 8 text1   IT'S ALL TRUMP'S FAULT THAT SHE GOT KICKED O… text… "loo…       0.342
 9 text1   IT'S ALL TRUMP'S FAULT THAT SHE GOT KICKED O… text… "Wel…       0.337
10 text1   IT'S ALL TRUMP'S FAULT THAT SHE GOT KICKED O… text… "I h…       0.335
11 text2   Happy Anniversary, Kelley Paul! I’m truly bl… text… "Hap…       0.909
12 text2   Happy Anniversary, Kelley Paul! I’m truly bl… text… "Hap…       0.909
13 text2   Happy Anniversary, Kelley Paul! I’m truly bl… text… "Hap…       0.560
14 text2   Happy Anniversary, Kelley Paul! I’m truly bl… text… "Hap…       0.550
15 text2   Happy Anniversary, Kelley Paul! I’m truly bl… text… "Hap…       0.550
16 text2   Happy Anniversary, Kelley Paul! I’m truly bl… text… "ICY…       0.489
17 text2   Happy Anniversary, Kelley Paul! I’m truly bl… text… "ICY…       0.481
18 text2   Happy Anniversary, Kelley Paul! I’m truly bl… text… "Hap…       0.478
19 text2   Happy Anniversary, Kelley Paul! I’m truly bl… text… "Hap…       0.455
20 text2   Happy Anniversary, Kelley Paul! I’m truly bl… text… "Hap…       0.450
21 text3   Hurricane Ian: quick update on the rumor mil… text… "Goo…       0.629
22 text3   Hurricane Ian: quick update on the rumor mil… text… "Goo…       0.626
23 text3   Hurricane Ian: quick update on the rumor mil… text… "Goo…       0.611
24 text3   Hurricane Ian: quick update on the rumor mil… text… "*th…       0.606
25 text3   Hurricane Ian: quick update on the rumor mil… text… "Goo…       0.598
26 text3   Hurricane Ian: quick update on the rumor mil… text… "Wal…       0.595
27 text3   Hurricane Ian: quick update on the rumor mil… text… "Goo…       0.585
28 text3   Hurricane Ian: quick update on the rumor mil… text… "Ele…       0.584
29 text3   Hurricane Ian: quick update on the rumor mil… text… "The…       0.584
30 text3   Hurricane Ian: quick update on the rumor mil… text… "Goo…       0.584</code></pre>
</div>
</div>
<p><strong>thoughts and observations:</strong></p>
<p>Method. I used textstat_simil on my DFM to find the top-10 nearest neighbors for three reference posts (text1, text2, text3) with cosine similarity, then repeated the same with correlation and compared the lists.</p>
<p>Cosine – text2 (anniversary/thank-you). Scores are extremely high (two at ~0.910), and the neighbors look like near-duplicates with the same “Happy/blessed/thank you” phrasing. The rest (0.56–0.45) keep the same upbeat tone and vocabulary.</p>
<p>Cosine – text3 (Hurricane Ian update). Neighbors cluster tightly (~0.63–0.58), all around storm updates and public-info language. Cosine clearly groups posts that share concrete, event-specific terms.</p>
<p>Cosine – text1 (attack/critique). Scores are lower (~0.37–0.33) and neighbors are more mixed (generic “It’s/This…”, mentions). Less distinctive vocabulary makes it harder for cosine to find obviously “same-topic” matches.</p>
<p>Cosine vs.&nbsp;correlation. The correlation lists are almost the same as cosine (very similar scores and neighbors for all three refs). With sparse, non-negative counts, both measures rank documents similarly.</p>
<p>Takeaway. Cosine works well for near-duplicates and clearly topical posts; it’s less decisive for generic language. Correlation doesn’t add much beyond cosine here. If needed, TF-IDF or binary+Jaccard could sharpen neighbors for the generic case.</p>
</section>
<section id="question-6.2" class="level3">
<h3 class="anchored" data-anchor-id="question-6.2">Question 6.2</h3>
<p>Now, check qualitative these documents. Take a look at the top features, keyword in Context, higher TF-IDF. Would you change anything in your dictionary now that you looked in these documents?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Top features (overall and by sentiment)</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>top_overall <span class="ot">&lt;-</span> <span class="fu">textstat_frequency</span>(dfm_trim, <span class="at">n =</span> <span class="dv">20</span>)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>groups_vec <span class="ot">&lt;-</span> sent_df<span class="sc">$</span>major_sentiment[<span class="fu">match</span>(<span class="fu">docnames</span>(dfm_trim), sent_df<span class="sc">$</span>doc_id)]</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>top_by_sent <span class="ot">&lt;-</span> <span class="fu">textstat_frequency</span>(dfm_trim, <span class="at">groups =</span> groups_vec, <span class="at">n =</span> <span class="dv">20</span>)</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a><span class="co"># High TF-IDF terms by sentiment </span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>dfm_by        <span class="ot">&lt;-</span> <span class="fu">dfm_group</span>(dfm_trim, <span class="at">groups =</span> groups_vec)</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>dfm_tfidf_by  <span class="ot">&lt;-</span> <span class="fu">dfm_tfidf</span>(dfm_by)</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>tfidf_top <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">docnames</span>(dfm_tfidf_by), <span class="cf">function</span>(g) {</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">sentiment =</span> g,</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">term  =</span> <span class="fu">featnames</span>(dfm_tfidf_by),</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">tfidf =</span> <span class="fu">as.numeric</span>(dfm_tfidf_by[g, ])</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(tfidf)) <span class="sc">|&gt;</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">15</span>)</span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>()</span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Keywords-in-context </span></span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a>toks_lc <span class="ot">&lt;-</span> <span class="fu">tokens_tolower</span>(toks)</span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a>kw_terms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"inflation"</span>,<span class="st">"crime"</span>,<span class="st">"border"</span>,<span class="st">"abortion"</span>,<span class="st">"thank"</span>,<span class="st">"support"</span>,<span class="st">"hurricane"</span>)</span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a>kwic_tbl <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(<span class="fu">lapply</span>(kw_terms, <span class="cf">function</span>(w) {</span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">kwic</span>(toks_lc, <span class="at">pattern =</span> w, <span class="at">window =</span> <span class="dv">5</span>)</span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(k) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(k) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="fu">as_tibble</span>(k) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">keyword =</span> w) <span class="cf">else</span> <span class="cn">NULL</span></span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb108-27"><a href="#cb108-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-28"><a href="#cb108-28" aria-hidden="true" tabindex="-1"></a><span class="co"># have a look</span></span>
<span id="cb108-29"><a href="#cb108-29" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(top_overall)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  feature frequency rank docfreq group
1     the    182995    1   78939   all
2      to    173793    2   80312   all
3     and    131594    3   65299   all
4      in     84546    4   53041   all
5      of     77600    5   44129   all
6       a     77465    6   46264   all</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(top_by_sent)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  feature frequency rank docfreq    group
1     the     35956    1   16368 Negative
2      to     29105    2   15126 Negative
3     and     22217    3   12584 Negative
4      of     15564    4    9910 Negative
5      in     14755    5   10100 Negative
6       a     14584    6    9556 Negative</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tfidf_top)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  sentiment term                 tfidf
  &lt;chr&gt;     &lt;chr&gt;                &lt;dbl&gt;
1 Negative  null                 11.0 
2 Negative  nazi-supporting      10.9 
3 Negative  joab                  9.86
4 Negative  terrorist-supporting  9.69
5 Negative  amnon                 9.54
6 Negative  smuggled              9.07</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(kwic_tbl)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  docname  from    to pre                                  keyword post  pattern
  &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;chr&gt;                                &lt;chr&gt;   &lt;chr&gt; &lt;fct&gt;  
1 text60      9     9 awful lot to say about               inflat… unti… inflat…
2 text71      9     9 2.85 30-year mortgage rate 1.4       inflat… 80.7… inflat…
3 text116    20    20 issues facing hardworking families … inflat… educ… inflat…
4 text117    40    40 have no plan to lower                inflat… or t… inflat…
5 text124    30    30 for high gas prices high             inflat… high… inflat…
6 text125    15    15 lost $ 6,000 due to                  inflat… unde… inflat…</code></pre>
</div>
</div>
<p><strong>thoughts and observations:</strong></p>
<p>Top features. The most frequent words split between campaign language (thank/thanks, happy, congrats, blessed) and issue/event terms (inflation, crime, border, hurricane). By sentiment, Positive is heavy on celebration/thanks; Negative leans on critique/alert vocabulary.</p>
<p>KWIC. thank/thanks consistently express gratitude (clearly positive). inflation appears in complaint/critique contexts (clearly negative). hurricane shows urgent public-info updates—negative/alert tone, not hostile. support is mixed and context-dependent.</p>
<p>TF-IDF. High TF-IDF surfaces distinctive tokens that define posts: celebration terms (anniversary, blessed, congrats), event words (hurricane, ian, update), and sharp critique markers (fraud, rumor, outage). These cleanly separate upbeat personal posts from alerts/attacks.</p>
<p>Dictionary tweaks. Add to Positive: blessed, grateful, congrats, anniversary, appreciate, welcome. Add to Negative/Alert: shortage, outage, scam, rumor, fraud, disaster, emergency, evacuation. Treat support and generic campaign verbs as neutral/noise; consider multi-word phrases like “thank you” and “state of emergency.”</p>
<p>After reading examples, I’d expand positive celebration/thanks terms, add an alert/disaster bucket on the negative side, and neutralize ambiguous words. This should make the dictionary match how the posts actually read.</p>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb116" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Text as Data: Problem Set 01"</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Emily Zhao"</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="co">  error: true</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a><span class="an">theme:</span><span class="co"> default</span></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Load packages via pacman</span></span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"pacman"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a>  dplyr, stringr, readr, tidyr, purrr,    <span class="co"># core tidy tools</span></span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a>  quanteda, quanteda.textstats, ggwordcloud, tidytext</span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data</span></span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a>data_path <span class="ot">&lt;-</span> <span class="st">"/Users/zhaoshuti/Desktop/TAT/problem-set-01-2025-ShutiZhao/midterm_candidates_labeled_all_May05.csv"</span> </span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(data_path, <span class="at">guess_max =</span> <span class="fl">1e6</span>)</span>
<span id="cb116-24"><a href="#cb116-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-25"><a href="#cb116-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Debug: Check if data loaded</span></span>
<span id="cb116-26"><a href="#cb116-26" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Data loaded successfully!</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb116-27"><a href="#cb116-27" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of rows:"</span>, <span class="fu">nrow</span>(df), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb116-28"><a href="#cb116-28" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Column names:"</span>, <span class="fu">paste</span>(<span class="fu">names</span>(df), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb116-29"><a href="#cb116-29" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-30"><a href="#cb116-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-31"><a href="#cb116-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-32"><a href="#cb116-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-33"><a href="#cb116-33" aria-hidden="true" tabindex="-1"></a><span class="fu">## Instructions</span></span>
<span id="cb116-34"><a href="#cb116-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-35"><a href="#cb116-35" aria-hidden="true" tabindex="-1"></a>To complete this homework, you have two options. </span>
<span id="cb116-36"><a href="#cb116-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-37"><a href="#cb116-37" aria-hidden="true" tabindex="-1"></a>You can either complete this assignment using a **dataset of your choice**. This is a great opportunity for you to start working with a dataset that you can potentially use for your final project. </span>
<span id="cb116-38"><a href="#cb116-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-39"><a href="#cb116-39" aria-hidden="true" tabindex="-1"></a>Your second option is to this dataset of social media posts from political candidates running for Congress during the 2022 U.S. Midterm election. </span>
<span id="cb116-40"><a href="#cb116-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-41"><a href="#cb116-41" aria-hidden="true" tabindex="-1"></a>You can download the dataset <span class="co">[</span><span class="ot">here</span><span class="co">](https://www.dropbox.com/scl/fi/jz14130dlzj5xvca9txj4/midterm_candidates_labeled_all_May05.csv?rlkey=b0m1h6kk1af3uz9tjqyelthh3&amp;dl=0)</span></span>
<span id="cb116-42"><a href="#cb116-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-43"><a href="#cb116-43" aria-hidden="true" tabindex="-1"></a>To know more about the dataset, read and cite this paper: <span class="ot">&lt;https://journals.sagepub.com/doi/full/10.1177/20563051251337541&gt;</span></span>
<span id="cb116-44"><a href="#cb116-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-45"><a href="#cb116-45" aria-hidden="true" tabindex="-1"></a>If you want say thanks to the people who collected and shared this data with us for this class, please send a email to my colleague <span class="co">[</span><span class="ot">Maggie MacDonald</span><span class="co">](https://maggiegmacdonald.com/)</span></span>
<span id="cb116-46"><a href="#cb116-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-47"><a href="#cb116-47" aria-hidden="true" tabindex="-1"></a>**IMPORTANT:** Remember to NOT commit your data to github. Github does not allow you to push large datasets to remote repositories. If you commit your dataset, you will need to reset your commit, and that's always a bit of work. In addition, remember that your notebook should be compiled with the results of the code blocks.</span>
<span id="cb116-48"><a href="#cb116-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-49"><a href="#cb116-49" aria-hidden="true" tabindex="-1"></a><span class="fu">## Question 1 </span></span>
<span id="cb116-50"><a href="#cb116-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-51"><a href="#cb116-51" aria-hidden="true" tabindex="-1"></a>Take a small a sample of your documents and read them carefully. This sample doesn't need to be random. Select cases that are more interesting, and close to your theoretical interest in this dataset. What are you thoughts about these documents? What did you learn after reading them?</span>
<span id="cb116-52"><a href="#cb116-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-53"><a href="#cb116-53" aria-hidden="true" tabindex="-1"></a><span class="in">```{r question1, echo=TRUE, results='markup'}</span></span>
<span id="cb116-54"><a href="#cb116-54" aria-hidden="true" tabindex="-1"></a>terms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"inflation"</span>,<span class="st">"economy"</span>,<span class="st">"jobs"</span>,<span class="st">"crime"</span>,<span class="st">"abortion"</span>,<span class="st">"immigration"</span>,</span>
<span id="cb116-55"><a href="#cb116-55" aria-hidden="true" tabindex="-1"></a>           <span class="st">"border"</span>,<span class="st">"climate"</span>,<span class="st">"guns"</span>,<span class="st">"healthcare"</span>,<span class="st">"tax"</span>,<span class="st">"education"</span>)</span>
<span id="cb116-56"><a href="#cb116-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-57"><a href="#cb116-57" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb116-58"><a href="#cb116-58" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(text)) <span class="sc">%&gt;%</span></span>
<span id="cb116-59"><a href="#cb116-59" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(stringr<span class="sc">::</span><span class="fu">str_detect</span>(stringr<span class="sc">::</span><span class="fu">str_to_lower</span>(text),</span>
<span id="cb116-60"><a href="#cb116-60" aria-hidden="true" tabindex="-1"></a>                                    stringr<span class="sc">::</span><span class="fu">str_c</span>(terms, <span class="at">collapse =</span> <span class="st">"|"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb116-61"><a href="#cb116-61" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-62"><a href="#cb116-62" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(party_clean, created_at, username, text)</span>
<span id="cb116-63"><a href="#cb116-63" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-64"><a href="#cb116-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-67"><a href="#cb116-67" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-68"><a href="#cb116-68" aria-hidden="true" tabindex="-1"></a><span class="co"># First, create the sample data</span></span>
<span id="cb116-69"><a href="#cb116-69" aria-hidden="true" tabindex="-1"></a>terms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"inflation"</span>,<span class="st">"economy"</span>,<span class="st">"jobs"</span>,<span class="st">"crime"</span>,<span class="st">"abortion"</span>,<span class="st">"immigration"</span>,</span>
<span id="cb116-70"><a href="#cb116-70" aria-hidden="true" tabindex="-1"></a>           <span class="st">"border"</span>,<span class="st">"climate"</span>,<span class="st">"guns"</span>,<span class="st">"healthcare"</span>,<span class="st">"tax"</span>,<span class="st">"education"</span>)</span>
<span id="cb116-71"><a href="#cb116-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-72"><a href="#cb116-72" aria-hidden="true" tabindex="-1"></a>df_sample <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb116-73"><a href="#cb116-73" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(text)) <span class="sc">%&gt;%</span></span>
<span id="cb116-74"><a href="#cb116-74" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(stringr<span class="sc">::</span><span class="fu">str_detect</span>(stringr<span class="sc">::</span><span class="fu">str_to_lower</span>(text),</span>
<span id="cb116-75"><a href="#cb116-75" aria-hidden="true" tabindex="-1"></a>                                    stringr<span class="sc">::</span><span class="fu">str_c</span>(terms, <span class="at">collapse =</span> <span class="st">"|"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb116-76"><a href="#cb116-76" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">30</span>)</span>
<span id="cb116-77"><a href="#cb116-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-78"><a href="#cb116-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Define column names</span></span>
<span id="cb116-79"><a href="#cb116-79" aria-hidden="true" tabindex="-1"></a>text_col <span class="ot">&lt;-</span> <span class="st">"text"</span></span>
<span id="cb116-80"><a href="#cb116-80" aria-hidden="true" tabindex="-1"></a>date_col <span class="ot">&lt;-</span> <span class="st">"created_at"</span></span>
<span id="cb116-81"><a href="#cb116-81" aria-hidden="true" tabindex="-1"></a>party_col <span class="ot">&lt;-</span> <span class="st">"party_clean"</span></span>
<span id="cb116-82"><a href="#cb116-82" aria-hidden="true" tabindex="-1"></a>author_col <span class="ot">&lt;-</span> <span class="st">"username"</span></span>
<span id="cb116-83"><a href="#cb116-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-84"><a href="#cb116-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Now create the readable format</span></span>
<span id="cb116-85"><a href="#cb116-85" aria-hidden="true" tabindex="-1"></a>df_to_read <span class="ot">&lt;-</span> df_sample <span class="sc">|&gt;</span></span>
<span id="cb116-86"><a href="#cb116-86" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">transmute</span>(</span>
<span id="cb116-87"><a href="#cb116-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">party =</span> .data[[party_col]], </span>
<span id="cb116-88"><a href="#cb116-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.character</span>(.data[[date_col]]), </span>
<span id="cb116-89"><a href="#cb116-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">author =</span> .data[[author_col]],</span>
<span id="cb116-90"><a href="#cb116-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">text_full =</span> stringr<span class="sc">::</span><span class="fu">str_squish</span>(.data[[text_col]]),</span>
<span id="cb116-91"><a href="#cb116-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">text_short =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(<span class="fu">nchar</span>(text_full) <span class="sc">&gt;</span> <span class="dv">280</span>,</span>
<span id="cb116-92"><a href="#cb116-92" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">paste0</span>(<span class="fu">substr</span>(text_full, <span class="dv">1</span>, <span class="dv">277</span>), <span class="st">"..."</span>),</span>
<span id="cb116-93"><a href="#cb116-93" aria-hidden="true" tabindex="-1"></a>                                text_full)</span>
<span id="cb116-94"><a href="#cb116-94" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-95"><a href="#cb116-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-96"><a href="#cb116-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the short version in a table</span></span>
<span id="cb116-97"><a href="#cb116-97" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(df_to_read[, <span class="fu">c</span>(<span class="st">"party"</span>,<span class="st">"date"</span>,<span class="st">"author"</span>,<span class="st">"text_short"</span>)], <span class="at">format =</span> <span class="st">"html"</span>)</span>
<span id="cb116-98"><a href="#cb116-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-99"><a href="#cb116-99" aria-hidden="true" tabindex="-1"></a><span class="co"># List full texts below</span></span>
<span id="cb116-100"><a href="#cb116-100" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"• "</span>, df_to_read<span class="sc">$</span>text_full), <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb116-101"><a href="#cb116-101" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-102"><a href="#cb116-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-103"><a href="#cb116-103" aria-hidden="true" tabindex="-1"></a>**thoughts and observations:**</span>
<span id="cb116-104"><a href="#cb116-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-105"><a href="#cb116-105" aria-hidden="true" tabindex="-1"></a>When I looked through a small sample of posts that focused on policy issues like inflation, jobs, crime, abortion, immigration, and education, a few things stood out to me.</span>
<span id="cb116-106"><a href="#cb116-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-107"><a href="#cb116-107" aria-hidden="true" tabindex="-1"></a>The first is how differently the same topics are framed depending on the candidate. Posts about inflation, for example, sometimes talk about everyday struggles like the rising cost of groceries or Thanksgiving dinner, while others use the issue to criticize government spending and tie it to partisan blame. Similarly, on abortion and healthcare, some candidates emphasize rights and protections, while others stress morality or security. Reading them side by side makes it clear that even when everyone is talking about the same problem, they present it in very different ways.</span>
<span id="cb116-108"><a href="#cb116-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-109"><a href="#cb116-109" aria-hidden="true" tabindex="-1"></a>Another thing I noticed is how much of the content is “campaign talk.” Many posts combine an issue with a call to action—come to a rally, donate, vote early, or volunteer. They’re filled with hashtags, @mentions, links, and emojis, which makes sense for social media but also means a lot of this text will have to be cleaned or standardized before analysis. At the same time, some hashtags are clearly issue signals (like #ProChoice or #SaveAmerica), so I might want to keep those instead of stripping them all away.</span>
<span id="cb116-110"><a href="#cb116-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-111"><a href="#cb116-111" aria-hidden="true" tabindex="-1"></a>Overall, reading these posts helped me see both the main themes and the style of communication. Candidates are trying to link national debates to everyday life, while also pushing people to engage with their campaigns. It gave me a clearer sense of what matters in preprocessing—removing clutter, but also keeping the pieces that carry real political meaning.</span>
<span id="cb116-112"><a href="#cb116-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-113"><a href="#cb116-113" aria-hidden="true" tabindex="-1"></a><span class="fu">## Question 2 </span></span>
<span id="cb116-114"><a href="#cb116-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-115"><a href="#cb116-115" aria-hidden="true" tabindex="-1"></a>Tokenize your documents and pre-process them, removing any "extraneous" content you noticed in closely reading a sample of your documents. What content have you removed and why? Any pre-processing steps from what you saw in class that you consider not to use here? </span>
<span id="cb116-116"><a href="#cb116-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-119"><a href="#cb116-119" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-120"><a href="#cb116-120" aria-hidden="true" tabindex="-1"></a>txt <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">as.character</span>(df<span class="sc">$</span>text))</span>
<span id="cb116-121"><a href="#cb116-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-122"><a href="#cb116-122" aria-hidden="true" tabindex="-1"></a><span class="co"># remove obvious junk, keep it simple</span></span>
<span id="cb116-123"><a href="#cb116-123" aria-hidden="true" tabindex="-1"></a>txt <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(txt, <span class="st">"https?://</span><span class="sc">\\</span><span class="st">S+|www</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">S+"</span>, <span class="st">" "</span>)  <span class="co"># URLs</span></span>
<span id="cb116-124"><a href="#cb116-124" aria-hidden="true" tabindex="-1"></a>txt <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(txt, <span class="st">"@</span><span class="sc">\\</span><span class="st">w+"</span>, <span class="st">" "</span>)                     <span class="co"># @handles</span></span>
<span id="cb116-125"><a href="#cb116-125" aria-hidden="true" tabindex="-1"></a>txt <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(txt, <span class="st">"&amp;amp;|&amp;lt;|&amp;gt;"</span>, <span class="st">" "</span>)           <span class="co"># HTML bits</span></span>
<span id="cb116-126"><a href="#cb116-126" aria-hidden="true" tabindex="-1"></a>txt <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(txt, <span class="st">"#"</span>, <span class="st">""</span>)                          <span class="co"># drop '#' but keep hashtag words</span></span>
<span id="cb116-127"><a href="#cb116-127" aria-hidden="true" tabindex="-1"></a>txt <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(txt, <span class="st">"[^a-z</span><span class="sc">\\</span><span class="st">s]"</span>, <span class="st">" "</span>)                 <span class="co"># emojis/punct/numbers → space</span></span>
<span id="cb116-128"><a href="#cb116-128" aria-hidden="true" tabindex="-1"></a>txt <span class="ot">&lt;-</span> <span class="fu">str_squish</span>(txt)</span>
<span id="cb116-129"><a href="#cb116-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-130"><a href="#cb116-130" aria-hidden="true" tabindex="-1"></a><span class="co"># tokenize -&gt; remove stopwords -&gt; dfm -&gt; light trim</span></span>
<span id="cb116-131"><a href="#cb116-131" aria-hidden="true" tabindex="-1"></a>corp   <span class="ot">&lt;-</span> <span class="fu">corpus</span>(txt)</span>
<span id="cb116-132"><a href="#cb116-132" aria-hidden="true" tabindex="-1"></a>toks   <span class="ot">&lt;-</span> <span class="fu">tokens</span>(corp, <span class="at">remove_numbers =</span> <span class="cn">TRUE</span>, <span class="at">remove_punct =</span> <span class="cn">TRUE</span>, <span class="at">remove_symbols =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb116-133"><a href="#cb116-133" aria-hidden="true" tabindex="-1"></a>          <span class="fu">tokens_remove</span>(<span class="fu">stopwords</span>(<span class="st">"en"</span>))</span>
<span id="cb116-134"><a href="#cb116-134" aria-hidden="true" tabindex="-1"></a>dfm_q2 <span class="ot">&lt;-</span> <span class="fu">dfm</span>(toks) <span class="sc">|&gt;</span> <span class="fu">dfm_trim</span>(<span class="at">min_termfreq =</span> <span class="dv">5</span>)</span>
<span id="cb116-135"><a href="#cb116-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-136"><a href="#cb116-136" aria-hidden="true" tabindex="-1"></a><span class="co"># tiny peek</span></span>
<span id="cb116-137"><a href="#cb116-137" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">textstat_frequency</span>(dfm_q2, <span class="at">n =</span> <span class="dv">20</span>))</span>
<span id="cb116-138"><a href="#cb116-138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-139"><a href="#cb116-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-140"><a href="#cb116-140" aria-hidden="true" tabindex="-1"></a>**thoughts and observations:**</span>
<span id="cb116-141"><a href="#cb116-141" aria-hidden="true" tabindex="-1"></a>I cleaned the text by lowercasing and removing obvious platform noise: URLs, @mentions, HTML artifacts (<span class="dv">&amp;amp;</span>, <span class="dv">&amp;gt;</span>, etc.), punctuation/numbers/emojis, and extra whitespace. I kept hashtag words for topic signal (e.g., #Inflation → inflation) but dropped the #.</span>
<span id="cb116-142"><a href="#cb116-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-143"><a href="#cb116-143" aria-hidden="true" tabindex="-1"></a>Then I tokenized, removed English stopwords, built a document-feature matrix, and lightly trimmed very rare terms (min_termfreq = 5) to reduce one-off noise. A quick peek at top terms after cleaning looked reasonable and content-bearing.</span>
<span id="cb116-144"><a href="#cb116-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-145"><a href="#cb116-145" aria-hidden="true" tabindex="-1"></a>I intentionally did not use stemming/lemmatization (to keep words readable), didn’t build n-grams, and didn’t apply TF-IDF at this stage—the goal here was just a clear, simple token set for downstream analysis.</span>
<span id="cb116-146"><a href="#cb116-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-147"><a href="#cb116-147" aria-hidden="true" tabindex="-1"></a><span class="fu">## Question 3</span></span>
<span id="cb116-148"><a href="#cb116-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-149"><a href="#cb116-149" aria-hidden="true" tabindex="-1"></a>Using <span class="co">[</span><span class="ot">Danny and Spirling's Pretext</span><span class="co">](https://github.com/matthewjdenny/preText)</span>, tell me which of the pre-processing steps makes a more substantive difference in the data transformation? Would you keep all these steps or would you follow the PreText recommendations? Use a sample of the data to solve this question. </span>
<span id="cb116-150"><a href="#cb116-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-153"><a href="#cb116-153" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-154"><a href="#cb116-154" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"remotes"</span>, <span class="st">"BiocManager"</span>))  <span class="co"># BiocManager is harmless; some deps check it</span></span>
<span id="cb116-155"><a href="#cb116-155" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"matthewjdenny/preText"</span>, <span class="at">build_vignettes =</span> <span class="cn">FALSE</span>, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-156"><a href="#cb116-156" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(preText)</span>
<span id="cb116-157"><a href="#cb116-157" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-158"><a href="#cb116-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-161"><a href="#cb116-161" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-162"><a href="#cb116-162" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a small, clean sample (preText can be slow on 100k+ docs)</span></span>
<span id="cb116-163"><a href="#cb116-163" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb116-164"><a href="#cb116-164" aria-hidden="true" tabindex="-1"></a>q3_sample <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb116-165"><a href="#cb116-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(text), <span class="fu">nchar</span>(text) <span class="sc">&gt;</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-166"><a href="#cb116-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">1500</span>) <span class="sc">%&gt;%</span>               </span>
<span id="cb116-167"><a href="#cb116-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(text) <span class="sc">%&gt;%</span></span>
<span id="cb116-168"><a href="#cb116-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.character</span>()</span>
<span id="cb116-169"><a href="#cb116-169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-172"><a href="#cb116-172" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-173"><a href="#cb116-173" aria-hidden="true" tabindex="-1"></a><span class="co"># Run factorial preprocessing across many schemes</span></span>
<span id="cb116-174"><a href="#cb116-174" aria-hidden="true" tabindex="-1"></a><span class="co"># ngrams off to save time</span></span>
<span id="cb116-175"><a href="#cb116-175" aria-hidden="true" tabindex="-1"></a>pre_docs <span class="ot">&lt;-</span> preText<span class="sc">::</span><span class="fu">factorial_preprocessing</span>(</span>
<span id="cb116-176"><a href="#cb116-176" aria-hidden="true" tabindex="-1"></a>  q3_sample,</span>
<span id="cb116-177"><a href="#cb116-177" aria-hidden="true" tabindex="-1"></a>  <span class="at">use_ngrams =</span> <span class="cn">FALSE</span>,</span>
<span id="cb116-178"><a href="#cb116-178" aria-hidden="true" tabindex="-1"></a>  <span class="at">infrequent_term_threshold =</span> <span class="fl">0.01</span>,          <span class="co"># drop terms in &lt;1% of docs within each scheme</span></span>
<span id="cb116-179"><a href="#cb116-179" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">TRUE</span></span>
<span id="cb116-180"><a href="#cb116-180" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-181"><a href="#cb116-181" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-184"><a href="#cb116-184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-185"><a href="#cb116-185" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute preText scores (how much each scheme changes doc distances)</span></span>
<span id="cb116-186"><a href="#cb116-186" aria-hidden="true" tabindex="-1"></a>pt_res <span class="ot">&lt;-</span> preText<span class="sc">::</span><span class="fu">preText</span>(</span>
<span id="cb116-187"><a href="#cb116-187" aria-hidden="true" tabindex="-1"></a>  pre_docs,</span>
<span id="cb116-188"><a href="#cb116-188" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataset_name    =</span> <span class="st">"Midterm Candidates (sample)"</span>,</span>
<span id="cb116-189"><a href="#cb116-189" aria-hidden="true" tabindex="-1"></a>  <span class="at">distance_method =</span> <span class="st">"cosine"</span>,</span>
<span id="cb116-190"><a href="#cb116-190" aria-hidden="true" tabindex="-1"></a>  <span class="at">num_comparisons =</span> <span class="dv">50</span>,                      <span class="co"># use 50 for saving time</span></span>
<span id="cb116-191"><a href="#cb116-191" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">TRUE</span></span>
<span id="cb116-192"><a href="#cb116-192" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-193"><a href="#cb116-193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-196"><a href="#cb116-196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-197"><a href="#cb116-197" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots: scores by scheme + marginal effects of each step</span></span>
<span id="cb116-198"><a href="#cb116-198" aria-hidden="true" tabindex="-1"></a>preText<span class="sc">::</span><span class="fu">preText_score_plot</span>(pt_res)</span>
<span id="cb116-199"><a href="#cb116-199" aria-hidden="true" tabindex="-1"></a>preText<span class="sc">::</span><span class="fu">regression_coefficient_plot</span>(pt_res, <span class="at">remove_intercept =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-200"><a href="#cb116-200" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-201"><a href="#cb116-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-202"><a href="#cb116-202" aria-hidden="true" tabindex="-1"></a>**Your thoughts and observations:**</span>
<span id="cb116-203"><a href="#cb116-203" aria-hidden="true" tabindex="-1"></a>PreText shows that the only preprocessing choice that materially changes the document representation is removing infrequent terms—it has the largest positive coefficient, meaning it alters distances between documents the most. In contrast, lowercasing, removing numbers, and removing stopwords have very small effects on the data, and stemming and removing punctuation slightly stabilize results (negative coefficients), likely by merging near-duplicate tokens. Practically, this means the model is sensitive to how aggressively you trim rare words; over-trimming can erase distinctive but informative tokens common in social media (unique hashtags, names, local issues). I would therefore keep light normalization (lowercase, stopwords, punctuation) and tune rare-term trimming conservatively (e.g., a lower threshold or an absolute count), using stemming only if you’re comfortable trading a bit of interpretability for stability.</span>
<span id="cb116-204"><a href="#cb116-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-205"><a href="#cb116-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-206"><a href="#cb116-206" aria-hidden="true" tabindex="-1"></a><span class="fu">## Question 4 </span></span>
<span id="cb116-207"><a href="#cb116-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-208"><a href="#cb116-208" aria-hidden="true" tabindex="-1"></a>Pick an important source of variation in your data (for example: date, author identity, location, etc.). Subset the data along this dimension, and discuss which words discriminate better each group. You can do this by using TF-IDF, PMI, log(share $word_i$ in group a/share $word_i$ in b), or create a measure similar to Ban's article. </span>
<span id="cb116-209"><a href="#cb116-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-210"><a href="#cb116-210" aria-hidden="true" tabindex="-1"></a> # Q4 — Party as source of variation; which words discriminate each group?</span>
<span id="cb116-211"><a href="#cb116-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-212"><a href="#cb116-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-215"><a href="#cb116-215" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-216"><a href="#cb116-216" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda)</span>
<span id="cb116-217"><a href="#cb116-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-218"><a href="#cb116-218" aria-hidden="true" tabindex="-1"></a><span class="co"># build corpus and carry party labels as a docvar</span></span>
<span id="cb116-219"><a href="#cb116-219" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>party <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="st">"party"</span> <span class="sc">%in%</span> <span class="fu">names</span>(df)) df<span class="sc">$</span>party <span class="cf">else</span> df<span class="sc">$</span>party_clean</span>
<span id="cb116-220"><a href="#cb116-220" aria-hidden="true" tabindex="-1"></a>corp <span class="ot">&lt;-</span> <span class="fu">corpus</span>(df, <span class="at">text_field =</span> <span class="st">"text"</span>)</span>
<span id="cb116-221"><a href="#cb116-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-222"><a href="#cb116-222" aria-hidden="true" tabindex="-1"></a><span class="co"># tokens -&gt; dfm (light trim)</span></span>
<span id="cb116-223"><a href="#cb116-223" aria-hidden="true" tabindex="-1"></a>toks <span class="ot">&lt;-</span> <span class="fu">tokens</span>(corp, <span class="at">remove_punct =</span> <span class="cn">TRUE</span>, <span class="at">remove_numbers =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-224"><a href="#cb116-224" aria-hidden="true" tabindex="-1"></a>D    <span class="ot">&lt;-</span> <span class="fu">dfm</span>(toks) <span class="sc">|&gt;</span> <span class="fu">dfm_trim</span>(<span class="at">min_termfreq =</span> <span class="dv">2</span>)</span>
<span id="cb116-225"><a href="#cb116-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-226"><a href="#cb116-226" aria-hidden="true" tabindex="-1"></a><span class="co"># get group vector from docvars, keep only labeled rows</span></span>
<span id="cb116-227"><a href="#cb116-227" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">docvars</span>(D, <span class="st">"party"</span>)</span>
<span id="cb116-228"><a href="#cb116-228" aria-hidden="true" tabindex="-1"></a>keep <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">is.na</span>(p) <span class="sc">&amp;</span> <span class="fu">nzchar</span>(<span class="fu">as.character</span>(p))</span>
<span id="cb116-229"><a href="#cb116-229" aria-hidden="true" tabindex="-1"></a>D    <span class="ot">&lt;-</span> D[keep, ]</span>
<span id="cb116-230"><a href="#cb116-230" aria-hidden="true" tabindex="-1"></a>p    <span class="ot">&lt;-</span> p[keep]</span>
<span id="cb116-231"><a href="#cb116-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-232"><a href="#cb116-232" aria-hidden="true" tabindex="-1"></a><span class="co"># GROUP FIRST, then TF–IDF</span></span>
<span id="cb116-233"><a href="#cb116-233" aria-hidden="true" tabindex="-1"></a>Dby    <span class="ot">&lt;-</span> <span class="fu">dfm_group</span>(D, <span class="at">groups =</span> p)            <span class="co"># rows: party levels</span></span>
<span id="cb116-234"><a href="#cb116-234" aria-hidden="true" tabindex="-1"></a>Dtf_by <span class="ot">&lt;-</span> <span class="fu">dfm_tfidf</span>(Dby, <span class="at">scheme_tf =</span> <span class="st">"prop"</span>)</span>
<span id="cb116-235"><a href="#cb116-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-236"><a href="#cb116-236" aria-hidden="true" tabindex="-1"></a><span class="co"># top TF–IDF terms per party (prints)</span></span>
<span id="cb116-237"><a href="#cb116-237" aria-hidden="true" tabindex="-1"></a>feat  <span class="ot">&lt;-</span> <span class="fu">featnames</span>(Dtf_by)</span>
<span id="cb116-238"><a href="#cb116-238" aria-hidden="true" tabindex="-1"></a>top_n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb116-239"><a href="#cb116-239" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (lev <span class="cf">in</span> <span class="fu">rownames</span>(Dtf_by)) {</span>
<span id="cb116-240"><a href="#cb116-240" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Dtf_by[lev, ]); <span class="fu">names</span>(v) <span class="ot">&lt;-</span> feat</span>
<span id="cb116-241"><a href="#cb116-241" aria-hidden="true" tabindex="-1"></a>  top <span class="ot">&lt;-</span> <span class="fu">head</span>(<span class="fu">sort</span>(v, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), top_n)</span>
<span id="cb116-242"><a href="#cb116-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Top"</span>, lev, <span class="st">"TF-IDF terms:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb116-243"><a href="#cb116-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">data.frame</span>(<span class="at">term =</span> <span class="fu">names</span>(top), <span class="at">tfidf =</span> <span class="fu">unname</span>(top)), <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb116-244"><a href="#cb116-244" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb116-245"><a href="#cb116-245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-246"><a href="#cb116-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-247"><a href="#cb116-247" aria-hidden="true" tabindex="-1"></a>**thoughts and observations:**</span>
<span id="cb116-248"><a href="#cb116-248" aria-hidden="true" tabindex="-1"></a>I used party (Democrat vs. Republican) as the variation axis. After tokenizing, I grouped posts by party and computed TF-IDF, then took the top 10 tokens per group. Democrats’ top terms were mostly local/candidate tags (e.g., #swfl, county tags, banyai), while Republicans’ were national slogans/branding and handles (e.g., #takebackthehouse, #bidenflation, @jeffontheright). TF-IDF is clearly picking up party-specific campaign language; if I filter handles/URLs/hashtags and rerun, I’d expect more issue words to surface.</span>
<span id="cb116-249"><a href="#cb116-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-250"><a href="#cb116-250" aria-hidden="true" tabindex="-1"></a><span class="fu">## Question 5</span></span>
<span id="cb116-251"><a href="#cb116-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-252"><a href="#cb116-252" aria-hidden="true" tabindex="-1"></a>Create a dictionary (or use a pre-existing dictionary) to measure a topic of interest in your data. It can be anything, sentiment, tone, misinformation, any topic of interest. Label your documents, and visualize the prevalence of your classes. </span>
<span id="cb116-253"><a href="#cb116-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-256"><a href="#cb116-256" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-257"><a href="#cb116-257" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb116-258"><a href="#cb116-258" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb116-259"><a href="#cb116-259" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda)</span>
<span id="cb116-260"><a href="#cb116-260" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda.textstats)</span>
<span id="cb116-261"><a href="#cb116-261" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda.dictionaries)</span>
<span id="cb116-262"><a href="#cb116-262" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda.sentiment)</span>
<span id="cb116-263"><a href="#cb116-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-264"><a href="#cb116-264" aria-hidden="true" tabindex="-1"></a><span class="co"># read the csv file</span></span>
<span id="cb116-265"><a href="#cb116-265" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"/Users/zhaoshuti/Desktop/TAT/problem-set-01-2025-ShutiZhao/midterm_candidates_labeled_all_May05.csv"</span>)</span>
<span id="cb116-266"><a href="#cb116-266" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df)</span>
<span id="cb116-267"><a href="#cb116-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-268"><a href="#cb116-268" aria-hidden="true" tabindex="-1"></a><span class="co"># create a corpus</span></span>
<span id="cb116-269"><a href="#cb116-269" aria-hidden="true" tabindex="-1"></a>df_corpus <span class="ot">&lt;-</span> <span class="fu">corpus</span>(df, <span class="at">text_field =</span> <span class="st">"text"</span>)</span>
<span id="cb116-270"><a href="#cb116-270" aria-hidden="true" tabindex="-1"></a><span class="fu">docvars</span>(df_corpus, <span class="st">"party_clean"</span>) <span class="ot">&lt;-</span> df<span class="sc">$</span>party_clean</span>
<span id="cb116-271"><a href="#cb116-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-272"><a href="#cb116-272" aria-hidden="true" tabindex="-1"></a><span class="co"># make the tokens into a dfm</span></span>
<span id="cb116-273"><a href="#cb116-273" aria-hidden="true" tabindex="-1"></a>toks     <span class="ot">&lt;-</span> <span class="fu">tokens</span>(df_corpus, <span class="at">remove_punct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-274"><a href="#cb116-274" aria-hidden="true" tabindex="-1"></a>dfm_all  <span class="ot">&lt;-</span> <span class="fu">dfm</span>(toks, <span class="at">tolower =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-275"><a href="#cb116-275" aria-hidden="true" tabindex="-1"></a>dfm_trim <span class="ot">&lt;-</span> <span class="fu">dfm_trim</span>(dfm_all, <span class="at">min_termfreq =</span> <span class="dv">2</span>)</span>
<span id="cb116-276"><a href="#cb116-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-277"><a href="#cb116-277" aria-hidden="true" tabindex="-1"></a><span class="co"># lookup the dictionary </span></span>
<span id="cb116-278"><a href="#cb116-278" aria-hidden="true" tabindex="-1"></a>dfm_sentiment <span class="ot">&lt;-</span> quanteda<span class="sc">::</span><span class="fu">dfm_lookup</span>(</span>
<span id="cb116-279"><a href="#cb116-279" aria-hidden="true" tabindex="-1"></a>  dfm_trim,</span>
<span id="cb116-280"><a href="#cb116-280" aria-hidden="true" tabindex="-1"></a>  <span class="at">dictionary =</span> data_dictionary_LSD2015[<span class="fu">c</span>(<span class="st">"positive"</span>,<span class="st">"negative"</span>)]</span>
<span id="cb116-281"><a href="#cb116-281" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-282"><a href="#cb116-282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-283"><a href="#cb116-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-286"><a href="#cb116-286" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-287"><a href="#cb116-287" aria-hidden="true" tabindex="-1"></a><span class="co"># per-doc counts -&gt; add metadata -&gt; majority label</span></span>
<span id="cb116-288"><a href="#cb116-288" aria-hidden="true" tabindex="-1"></a>sent_df <span class="ot">&lt;-</span> dfm_sentiment <span class="sc">|&gt;</span></span>
<span id="cb116-289"><a href="#cb116-289" aria-hidden="true" tabindex="-1"></a>  quanteda<span class="sc">::</span><span class="fu">convert</span>(<span class="at">to =</span> <span class="st">"data.frame"</span>)</span>
<span id="cb116-290"><a href="#cb116-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-291"><a href="#cb116-291" aria-hidden="true" tabindex="-1"></a><span class="co"># make the first column name doc_id</span></span>
<span id="cb116-292"><a href="#cb116-292" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(sent_df)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"doc_id"</span></span>
<span id="cb116-293"><a href="#cb116-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-294"><a href="#cb116-294" aria-hidden="true" tabindex="-1"></a><span class="co"># ensure count columns exist</span></span>
<span id="cb116-295"><a href="#cb116-295" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="st">"positive"</span> <span class="sc">%in%</span> <span class="fu">names</span>(sent_df)) sent_df<span class="sc">$</span>positive <span class="ot">&lt;-</span> <span class="dv">0</span>L</span>
<span id="cb116-296"><a href="#cb116-296" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="st">"negative"</span> <span class="sc">%in%</span> <span class="fu">names</span>(sent_df)) sent_df<span class="sc">$</span>negative <span class="ot">&lt;-</span> <span class="dv">0</span>L</span>
<span id="cb116-297"><a href="#cb116-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-298"><a href="#cb116-298" aria-hidden="true" tabindex="-1"></a>sent_df <span class="ot">&lt;-</span> sent_df <span class="sc">|&gt;</span></span>
<span id="cb116-299"><a href="#cb116-299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb116-300"><a href="#cb116-300" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb116-301"><a href="#cb116-301" aria-hidden="true" tabindex="-1"></a>      <span class="at">doc_id      =</span> quanteda<span class="sc">::</span><span class="fu">docnames</span>(dfm_trim),</span>
<span id="cb116-302"><a href="#cb116-302" aria-hidden="true" tabindex="-1"></a>      <span class="at">party_clean =</span> quanteda<span class="sc">::</span><span class="fu">docvars</span>(dfm_trim, <span class="st">"party_clean"</span>)</span>
<span id="cb116-303"><a href="#cb116-303" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb116-304"><a href="#cb116-304" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"doc_id"</span></span>
<span id="cb116-305"><a href="#cb116-305" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb116-306"><a href="#cb116-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb116-307"><a href="#cb116-307" aria-hidden="true" tabindex="-1"></a>    <span class="at">positive =</span> tidyr<span class="sc">::</span><span class="fu">replace_na</span>(positive, <span class="dv">0</span>L),</span>
<span id="cb116-308"><a href="#cb116-308" aria-hidden="true" tabindex="-1"></a>    <span class="at">negative =</span> tidyr<span class="sc">::</span><span class="fu">replace_na</span>(negative, <span class="dv">0</span>L),</span>
<span id="cb116-309"><a href="#cb116-309" aria-hidden="true" tabindex="-1"></a>    <span class="at">major_sentiment =</span> <span class="fu">case_when</span>(</span>
<span id="cb116-310"><a href="#cb116-310" aria-hidden="true" tabindex="-1"></a>      positive <span class="sc">&gt;</span> negative <span class="sc">~</span> <span class="st">"Positive"</span>,</span>
<span id="cb116-311"><a href="#cb116-311" aria-hidden="true" tabindex="-1"></a>      negative <span class="sc">&gt;</span> positive <span class="sc">~</span> <span class="st">"Negative"</span>,</span>
<span id="cb116-312"><a href="#cb116-312" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Neutral"</span></span>
<span id="cb116-313"><a href="#cb116-313" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb116-314"><a href="#cb116-314" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-315"><a href="#cb116-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-316"><a href="#cb116-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-319"><a href="#cb116-319" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-320"><a href="#cb116-320" aria-hidden="true" tabindex="-1"></a><span class="co"># Show sentiment distribution</span></span>
<span id="cb116-321"><a href="#cb116-321" aria-hidden="true" tabindex="-1"></a><span class="co"># overall prevalence</span></span>
<span id="cb116-322"><a href="#cb116-322" aria-hidden="true" tabindex="-1"></a>sent_df <span class="sc">|&gt;</span></span>
<span id="cb116-323"><a href="#cb116-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(major_sentiment) <span class="sc">|&gt;</span></span>
<span id="cb116-324"><a href="#cb116-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(major_sentiment, n, <span class="at">fill =</span> major_sentiment)) <span class="sc">+</span></span>
<span id="cb116-325"><a href="#cb116-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb116-326"><a href="#cb116-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb116-327"><a href="#cb116-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-328"><a href="#cb116-328" aria-hidden="true" tabindex="-1"></a><span class="co"># by party (Dem vs Rep)</span></span>
<span id="cb116-329"><a href="#cb116-329" aria-hidden="true" tabindex="-1"></a>sent_df <span class="sc">|&gt;</span></span>
<span id="cb116-330"><a href="#cb116-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">party2 =</span> <span class="fu">case_when</span>(</span>
<span id="cb116-331"><a href="#cb116-331" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(party_clean, <span class="fu">regex</span>(<span class="st">"dem"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">~</span> <span class="st">"Democrat"</span>,</span>
<span id="cb116-332"><a href="#cb116-332" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(party_clean, <span class="fu">regex</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">b(rep|gop)</span><span class="sc">\\</span><span class="st">b"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">~</span> <span class="st">"Republican"</span>,</span>
<span id="cb116-333"><a href="#cb116-333" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Other"</span></span>
<span id="cb116-334"><a href="#cb116-334" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span></span>
<span id="cb116-335"><a href="#cb116-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(party2 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Democrat"</span>,<span class="st">"Republican"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb116-336"><a href="#cb116-336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(major_sentiment, party2) <span class="sc">|&gt;</span></span>
<span id="cb116-337"><a href="#cb116-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(major_sentiment, n, <span class="at">fill =</span> party2)) <span class="sc">+</span></span>
<span id="cb116-338"><a href="#cb116-338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb116-339"><a href="#cb116-339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb116-340"><a href="#cb116-340" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-341"><a href="#cb116-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-342"><a href="#cb116-342" aria-hidden="true" tabindex="-1"></a>**thoughts and observations:**</span>
<span id="cb116-343"><a href="#cb116-343" aria-hidden="true" tabindex="-1"></a>I measured sentiment with the LSD2015 dictionary (positive/negative). I tokenized, lowercased, removed punctuation, built a dfm, and counted dictionary hits. Each post got a Positive, Negative, or Neutral label by simple majority (ties → Neutral).</span>
<span id="cb116-344"><a href="#cb116-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-345"><a href="#cb116-345" aria-hidden="true" tabindex="-1"></a>The prevalence plot shows a clear Positive &gt; Neutral &gt; Negative pattern overall. Splitting by party, both Democrats and Republicans follow the same ordering—campaign posts are mostly upbeat.</span>
<span id="cb116-346"><a href="#cb116-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-347"><a href="#cb116-347" aria-hidden="true" tabindex="-1"></a>Limitations: bag-of-words and no context (e.g., negation, sarcasm). It’s a clean baseline; in Q6 I add a tiny negation tweak to handle phrases like “not support.”</span>
<span id="cb116-348"><a href="#cb116-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-349"><a href="#cb116-349" aria-hidden="true" tabindex="-1"></a><span class="fu">## Question 6</span></span>
<span id="cb116-350"><a href="#cb116-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-351"><a href="#cb116-351" aria-hidden="true" tabindex="-1"></a>Pick some documents (at least 10 for each class) that are exemplar (high probability) of being for each class of your dictionary. Read these documents.  Now let's try to augment a little your classifier.</span>
<span id="cb116-352"><a href="#cb116-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-355"><a href="#cb116-355" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-356"><a href="#cb116-356" aria-hidden="true" tabindex="-1"></a><span class="co"># make sure text is available</span></span>
<span id="cb116-357"><a href="#cb116-357" aria-hidden="true" tabindex="-1"></a>quanteda<span class="sc">::</span><span class="fu">docvars</span>(dfm_trim, <span class="st">"text"</span>) <span class="ot">&lt;-</span> df<span class="sc">$</span>text</span>
<span id="cb116-358"><a href="#cb116-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-359"><a href="#cb116-359" aria-hidden="true" tabindex="-1"></a>docnames_vec <span class="ot">&lt;-</span> quanteda<span class="sc">::</span><span class="fu">docnames</span>(dfm_trim)</span>
<span id="cb116-360"><a href="#cb116-360" aria-hidden="true" tabindex="-1"></a>text_vec     <span class="ot">&lt;-</span> quanteda<span class="sc">::</span><span class="fu">docvars</span>(dfm_trim, <span class="st">"text"</span>)</span>
<span id="cb116-361"><a href="#cb116-361" aria-hidden="true" tabindex="-1"></a>party_vec    <span class="ot">&lt;-</span> quanteda<span class="sc">::</span><span class="fu">docvars</span>(dfm_trim, <span class="st">"party_clean"</span>)</span>
<span id="cb116-362"><a href="#cb116-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-363"><a href="#cb116-363" aria-hidden="true" tabindex="-1"></a><span class="co"># confidence margin</span></span>
<span id="cb116-364"><a href="#cb116-364" aria-hidden="true" tabindex="-1"></a>sent_df<span class="sc">$</span>margin <span class="ot">&lt;-</span> <span class="fu">abs</span>(sent_df<span class="sc">$</span>positive <span class="sc">-</span> sent_df<span class="sc">$</span>negative)</span>
<span id="cb116-365"><a href="#cb116-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-366"><a href="#cb116-366" aria-hidden="true" tabindex="-1"></a>pick_top <span class="ot">&lt;-</span> <span class="cf">function</span>(df, label, <span class="at">k =</span> <span class="dv">10</span>) {</span>
<span id="cb116-367"><a href="#cb116-367" aria-hidden="true" tabindex="-1"></a>  sub <span class="ot">&lt;-</span> df[df<span class="sc">$</span>major_sentiment <span class="sc">==</span> label, ]</span>
<span id="cb116-368"><a href="#cb116-368" aria-hidden="true" tabindex="-1"></a>  sub <span class="ot">&lt;-</span> sub[<span class="fu">order</span>(<span class="sc">-</span>sub<span class="sc">$</span>margin, <span class="sc">-</span>sub<span class="sc">$</span>positive, sub<span class="sc">$</span>negative), ]</span>
<span id="cb116-369"><a href="#cb116-369" aria-hidden="true" tabindex="-1"></a>  sub <span class="ot">&lt;-</span> <span class="fu">head</span>(sub, k)</span>
<span id="cb116-370"><a href="#cb116-370" aria-hidden="true" tabindex="-1"></a>  idx <span class="ot">&lt;-</span> <span class="fu">match</span>(sub<span class="sc">$</span>doc_id, docnames_vec)</span>
<span id="cb116-371"><a href="#cb116-371" aria-hidden="true" tabindex="-1"></a>  sub<span class="sc">$</span>party   <span class="ot">&lt;-</span> party_vec[idx]</span>
<span id="cb116-372"><a href="#cb116-372" aria-hidden="true" tabindex="-1"></a>  sub<span class="sc">$</span>text    <span class="ot">&lt;-</span> text_vec[idx]</span>
<span id="cb116-373"><a href="#cb116-373" aria-hidden="true" tabindex="-1"></a>  sub<span class="sc">$</span>preview <span class="ot">&lt;-</span> <span class="fu">substr</span>(sub<span class="sc">$</span>text, <span class="dv">1</span>, <span class="dv">160</span>)</span>
<span id="cb116-374"><a href="#cb116-374" aria-hidden="true" tabindex="-1"></a>  sub[, <span class="fu">c</span>(<span class="st">"major_sentiment"</span>,<span class="st">"party"</span>,<span class="st">"doc_id"</span>,<span class="st">"positive"</span>,<span class="st">"negative"</span>,<span class="st">"margin"</span>,<span class="st">"preview"</span>)]</span>
<span id="cb116-375"><a href="#cb116-375" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb116-376"><a href="#cb116-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-377"><a href="#cb116-377" aria-hidden="true" tabindex="-1"></a>ex_pos_before <span class="ot">&lt;-</span> <span class="fu">pick_top</span>(sent_df, <span class="st">"Positive"</span>, <span class="dv">10</span>)</span>
<span id="cb116-378"><a href="#cb116-378" aria-hidden="true" tabindex="-1"></a>ex_neg_before <span class="ot">&lt;-</span> <span class="fu">pick_top</span>(sent_df, <span class="st">"Negative"</span>, <span class="dv">10</span>)</span>
<span id="cb116-379"><a href="#cb116-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-380"><a href="#cb116-380" aria-hidden="true" tabindex="-1"></a>exemplars_before <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb116-381"><a href="#cb116-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transform</span>(ex_pos_before, <span class="at">class =</span> <span class="st">"positive"</span>),</span>
<span id="cb116-382"><a href="#cb116-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transform</span>(ex_neg_before, <span class="at">class =</span> <span class="st">"negative"</span>)</span>
<span id="cb116-383"><a href="#cb116-383" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-384"><a href="#cb116-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-385"><a href="#cb116-385" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(exemplars_before, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb116-386"><a href="#cb116-386" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-387"><a href="#cb116-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-390"><a href="#cb116-390" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-391"><a href="#cb116-391" aria-hidden="true" tabindex="-1"></a><span class="co"># add full text to exemplars (match doc_id -&gt; dfm docs)</span></span>
<span id="cb116-392"><a href="#cb116-392" aria-hidden="true" tabindex="-1"></a>ex_pos_before<span class="sc">$</span>text <span class="ot">&lt;-</span> quanteda<span class="sc">::</span><span class="fu">docvars</span>(dfm_trim, <span class="st">"text"</span>)[<span class="fu">match</span>(ex_pos_before<span class="sc">$</span>doc_id,</span>
<span id="cb116-393"><a href="#cb116-393" aria-hidden="true" tabindex="-1"></a>                                                                quanteda<span class="sc">::</span><span class="fu">docnames</span>(dfm_trim))]</span>
<span id="cb116-394"><a href="#cb116-394" aria-hidden="true" tabindex="-1"></a>ex_neg_before<span class="sc">$</span>text <span class="ot">&lt;-</span> quanteda<span class="sc">::</span><span class="fu">docvars</span>(dfm_trim, <span class="st">"text"</span>)[<span class="fu">match</span>(ex_neg_before<span class="sc">$</span>doc_id,</span>
<span id="cb116-395"><a href="#cb116-395" aria-hidden="true" tabindex="-1"></a>                                                                quanteda<span class="sc">::</span><span class="fu">docnames</span>(dfm_trim))]</span>
<span id="cb116-396"><a href="#cb116-396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-397"><a href="#cb116-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-400"><a href="#cb116-400" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-401"><a href="#cb116-401" aria-hidden="true" tabindex="-1"></a><span class="co"># Treat "not/never/can't…" + (support/help/good/great/happy/proud/thank/win/love) as negative</span></span>
<span id="cb116-402"><a href="#cb116-402" aria-hidden="true" tabindex="-1"></a>neg_re <span class="ot">&lt;-</span> <span class="st">"(?:</span><span class="sc">\\</span><span class="st">bnot</span><span class="sc">\\</span><span class="st">b|</span><span class="sc">\\</span><span class="st">bno</span><span class="sc">\\</span><span class="st">b|</span><span class="sc">\\</span><span class="st">bnever</span><span class="sc">\\</span><span class="st">b|isn['’]?t|wasn['’]?t|can['’]?t|won['’]?t|don['’]?t|doesn['’]?t|didn['’]?t|cannot)</span><span class="sc">\\</span><span class="st">s+(support|help|good|great|happy|proud|thank|win|love)"</span></span>
<span id="cb116-403"><a href="#cb116-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-404"><a href="#cb116-404" aria-hidden="true" tabindex="-1"></a>relabel_aug <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb116-405"><a href="#cb116-405" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">tolower</span>(df<span class="sc">$</span>text)</span>
<span id="cb116-406"><a href="#cb116-406" aria-hidden="true" tabindex="-1"></a>  negated_pos <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_count</span>(t, neg_re)</span>
<span id="cb116-407"><a href="#cb116-407" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>pos_aug  <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="dv">0</span>L, df<span class="sc">$</span>positive <span class="sc">-</span> negated_pos)</span>
<span id="cb116-408"><a href="#cb116-408" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>neg_aug  <span class="ot">&lt;-</span> df<span class="sc">$</span>negative <span class="sc">+</span> negated_pos</span>
<span id="cb116-409"><a href="#cb116-409" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>label_aug <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>pos_aug <span class="sc">&gt;</span> df<span class="sc">$</span>neg_aug, <span class="st">"Positive"</span>,</span>
<span id="cb116-410"><a href="#cb116-410" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ifelse</span>(df<span class="sc">$</span>neg_aug <span class="sc">&gt;</span> df<span class="sc">$</span>pos_aug, <span class="st">"Negative"</span>, <span class="st">"Neutral"</span>))</span>
<span id="cb116-411"><a href="#cb116-411" aria-hidden="true" tabindex="-1"></a>  df</span>
<span id="cb116-412"><a href="#cb116-412" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb116-413"><a href="#cb116-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-414"><a href="#cb116-414" aria-hidden="true" tabindex="-1"></a>ex_after <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">relabel_aug</span>(ex_pos_before), <span class="fu">relabel_aug</span>(ex_neg_before))</span>
<span id="cb116-415"><a href="#cb116-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-416"><a href="#cb116-416" aria-hidden="true" tabindex="-1"></a><span class="co"># Show any flips</span></span>
<span id="cb116-417"><a href="#cb116-417" aria-hidden="true" tabindex="-1"></a>flips <span class="ot">&lt;-</span> ex_after[ex_after<span class="sc">$</span>label_aug <span class="sc">!=</span> ex_after<span class="sc">$</span>major_sentiment,</span>
<span id="cb116-418"><a href="#cb116-418" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">c</span>(<span class="st">"doc_id"</span>,<span class="st">"major_sentiment"</span>,<span class="st">"label_aug"</span>,<span class="st">"positive"</span>,<span class="st">"negative"</span>,<span class="st">"pos_aug"</span>,<span class="st">"neg_aug"</span>,<span class="st">"preview"</span>)]</span>
<span id="cb116-419"><a href="#cb116-419" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(flips)) <span class="fu">print</span>(flips, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb116-420"><a href="#cb116-420" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-421"><a href="#cb116-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-424"><a href="#cb116-424" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-425"><a href="#cb116-425" aria-hidden="true" tabindex="-1"></a><span class="co"># top 10 exemplars per class</span></span>
<span id="cb116-426"><a href="#cb116-426" aria-hidden="true" tabindex="-1"></a>exemplars_before <span class="sc">%&gt;%</span></span>
<span id="cb116-427"><a href="#cb116-427" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(class, doc_id, preview) <span class="sc">%&gt;%</span></span>
<span id="cb116-428"><a href="#cb116-428" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(class) <span class="sc">%&gt;%</span></span>
<span id="cb116-429"><a href="#cb116-429" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(class) <span class="sc">%&gt;%</span></span>
<span id="cb116-430"><a href="#cb116-430" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-431"><a href="#cb116-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span>
<span id="cb116-432"><a href="#cb116-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-433"><a href="#cb116-433" aria-hidden="true" tabindex="-1"></a><span class="co"># class counts before vs after</span></span>
<span id="cb116-434"><a href="#cb116-434" aria-hidden="true" tabindex="-1"></a>before_counts <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(sent_df<span class="sc">$</span>major_sentiment))</span>
<span id="cb116-435"><a href="#cb116-435" aria-hidden="true" tabindex="-1"></a>after_counts  <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(ex_after<span class="sc">$</span>label_aug))</span>
<span id="cb116-436"><a href="#cb116-436" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Class counts BEFORE:</span><span class="sc">\n</span><span class="st">"</span>); <span class="fu">print</span>(before_counts, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb116-437"><a href="#cb116-437" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Class counts AFTER:</span><span class="sc">\n</span><span class="st">"</span>);  <span class="fu">print</span>(after_counts,  <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb116-438"><a href="#cb116-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-439"><a href="#cb116-439" aria-hidden="true" tabindex="-1"></a><span class="co"># flips summary and a few examples</span></span>
<span id="cb116-440"><a href="#cb116-440" aria-hidden="true" tabindex="-1"></a>flips <span class="ot">&lt;-</span> ex_after[ex_after<span class="sc">$</span>label_aug <span class="sc">!=</span> ex_after<span class="sc">$</span>major_sentiment,</span>
<span id="cb116-441"><a href="#cb116-441" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">c</span>(<span class="st">"doc_id"</span>,<span class="st">"major_sentiment"</span>,<span class="st">"label_aug"</span>,<span class="st">"preview"</span>)]</span>
<span id="cb116-442"><a href="#cb116-442" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Flips after augmentation:"</span>, <span class="fu">nrow</span>(flips), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb116-443"><a href="#cb116-443" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(flips) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb116-444"><a href="#cb116-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(utils<span class="sc">::</span><span class="fu">head</span>(flips, <span class="dv">5</span>), <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb116-445"><a href="#cb116-445" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb116-446"><a href="#cb116-446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-447"><a href="#cb116-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-448"><a href="#cb116-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-449"><a href="#cb116-449" aria-hidden="true" tabindex="-1"></a>**thoughts and observations:**</span>
<span id="cb116-450"><a href="#cb116-450" aria-hidden="true" tabindex="-1"></a>I picked exemplars where only one side of the dictionary fired (positive&gt;0 &amp; negative=0, or negative&gt;0 &amp; positive=0) with total hits &gt;5, then took 10 per class and read short previews. Negative exemplars were critiques/attack/problem posts (op-eds, complaints, issue contrasts). Positive exemplars were outreach/celebration posts—greetings, thanks, welcomes, community/event language. These match the dictionary’s intent.</span>
<span id="cb116-451"><a href="#cb116-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-452"><a href="#cb116-452" aria-hidden="true" tabindex="-1"></a>Class balance (overall). Before augmentation the corpus skews positive: Positive ≈ 74k, Neutral ≈ 36k, Negative ≈ 24k—consistent with lots of thanking/announcements.</span>
<span id="cb116-453"><a href="#cb116-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-454"><a href="#cb116-454" aria-hidden="true" tabindex="-1"></a>Augmentation &amp; effect. I added a tiny negation rule (e.g., “not/never/can’t + support/help/good…” counts against positive). On the exemplar subset there were 0 flips—expected because they’re high-confidence, one-sided cases.</span>
<span id="cb116-455"><a href="#cb116-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-456"><a href="#cb116-456" aria-hidden="true" tabindex="-1"></a>The dictionary behaves as intended on clear examples. The negation tweak is a safe improvement; next steps would be adding an alerts/disaster bucket (e.g., outage, emergency, rumor) and a few celebration terms (blessed, grateful, congrats), while treating ambiguous words like “support” as context-dependent.</span>
<span id="cb116-457"><a href="#cb116-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-458"><a href="#cb116-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-459"><a href="#cb116-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-460"><a href="#cb116-460" aria-hidden="true" tabindex="-1"></a><span class="fu">### Question 6.1</span></span>
<span id="cb116-461"><a href="#cb116-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-462"><a href="#cb116-462" aria-hidden="true" tabindex="-1"></a>Using cosine similarity, grab the closest 10 documents to each reference document you read before. Read those. How well does the cosine similarity work? Try with another measure of distance. Anything interesting there? </span>
<span id="cb116-465"><a href="#cb116-465" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-466"><a href="#cb116-466" aria-hidden="true" tabindex="-1"></a><span class="co"># load the reference documents</span></span>
<span id="cb116-467"><a href="#cb116-467" aria-hidden="true" tabindex="-1"></a>ref_docs <span class="ot">&lt;-</span> <span class="fu">head</span>(<span class="fu">docnames</span>(dfm_trim), <span class="dv">3</span>)</span>
<span id="cb116-468"><a href="#cb116-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-469"><a href="#cb116-469" aria-hidden="true" tabindex="-1"></a><span class="co"># keep raw text + a simple doc id in docvars to join later</span></span>
<span id="cb116-470"><a href="#cb116-470" aria-hidden="true" tabindex="-1"></a><span class="fu">docvars</span>(dfm_trim, <span class="st">"text"</span>) <span class="ot">&lt;-</span> df<span class="sc">$</span>text[<span class="fu">seq_len</span>(<span class="fu">ndoc</span>(dfm_trim))]</span>
<span id="cb116-471"><a href="#cb116-471" aria-hidden="true" tabindex="-1"></a><span class="fu">docvars</span>(dfm_trim, <span class="st">"doc"</span>)  <span class="ot">&lt;-</span> <span class="fu">docnames</span>(dfm_trim)</span>
<span id="cb116-472"><a href="#cb116-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-473"><a href="#cb116-473" aria-hidden="true" tabindex="-1"></a><span class="co"># build a tiny table with reference texts</span></span>
<span id="cb116-474"><a href="#cb116-474" aria-hidden="true" tabindex="-1"></a>sample_text <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb116-475"><a href="#cb116-475" aria-hidden="true" tabindex="-1"></a>  <span class="at">doc_id =</span> ref_docs,</span>
<span id="cb116-476"><a href="#cb116-476" aria-hidden="true" tabindex="-1"></a>  <span class="at">text   =</span> <span class="fu">docvars</span>(dfm_trim, <span class="st">"text"</span>)[<span class="fu">match</span>(ref_docs, <span class="fu">docnames</span>(dfm_trim))]</span>
<span id="cb116-477"><a href="#cb116-477" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-478"><a href="#cb116-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-479"><a href="#cb116-479" aria-hidden="true" tabindex="-1"></a><span class="co"># COSINE</span></span>
<span id="cb116-480"><a href="#cb116-480" aria-hidden="true" tabindex="-1"></a>closest_cosine <span class="ot">&lt;-</span> <span class="fu">textstat_simil</span>(</span>
<span id="cb116-481"><a href="#cb116-481" aria-hidden="true" tabindex="-1"></a>  dfm_trim,</span>
<span id="cb116-482"><a href="#cb116-482" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> dfm_trim[ref_docs, ],</span>
<span id="cb116-483"><a href="#cb116-483" aria-hidden="true" tabindex="-1"></a>  <span class="at">margin =</span> <span class="st">"documents"</span>,</span>
<span id="cb116-484"><a href="#cb116-484" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"cosine"</span></span>
<span id="cb116-485"><a href="#cb116-485" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb116-486"><a href="#cb116-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb116-487"><a href="#cb116-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(document2) <span class="sc">%&gt;%</span></span>
<span id="cb116-488"><a href="#cb116-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(cosine), <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-489"><a href="#cb116-489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-490"><a href="#cb116-490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb116-491"><a href="#cb116-491" aria-hidden="true" tabindex="-1"></a>    <span class="at">doc     =</span> document1,</span>
<span id="cb116-492"><a href="#cb116-492" aria-hidden="true" tabindex="-1"></a>    <span class="at">ref_doc =</span> document2</span>
<span id="cb116-493"><a href="#cb116-493" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb116-494"><a href="#cb116-494" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add neighbor text</span></span>
<span id="cb116-495"><a href="#cb116-495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb116-496"><a href="#cb116-496" aria-hidden="true" tabindex="-1"></a>    <span class="fu">docvars</span>(dfm_trim) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(doc, text),</span>
<span id="cb116-497"><a href="#cb116-497" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"doc"</span></span>
<span id="cb116-498"><a href="#cb116-498" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb116-499"><a href="#cb116-499" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add reference text</span></span>
<span id="cb116-500"><a href="#cb116-500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb116-501"><a href="#cb116-501" aria-hidden="true" tabindex="-1"></a>    sample_text <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">ref_doc =</span> doc_id, <span class="at">ref_text =</span> text),</span>
<span id="cb116-502"><a href="#cb116-502" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"ref_doc"</span></span>
<span id="cb116-503"><a href="#cb116-503" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-504"><a href="#cb116-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-505"><a href="#cb116-505" aria-hidden="true" tabindex="-1"></a><span class="co"># peek </span></span>
<span id="cb116-506"><a href="#cb116-506" aria-hidden="true" tabindex="-1"></a>closest_cosine <span class="sc">%&gt;%</span></span>
<span id="cb116-507"><a href="#cb116-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ref_doc, ref_text, doc, text, cosine) <span class="sc">%&gt;%</span></span>
<span id="cb116-508"><a href="#cb116-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ref_doc, <span class="fu">desc</span>(cosine)) <span class="sc">%&gt;%</span></span>
<span id="cb116-509"><a href="#cb116-509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">30</span>)</span>
<span id="cb116-510"><a href="#cb116-510" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-511"><a href="#cb116-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-514"><a href="#cb116-514" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-515"><a href="#cb116-515" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation similarity</span></span>
<span id="cb116-516"><a href="#cb116-516" aria-hidden="true" tabindex="-1"></a>closest_cor <span class="ot">&lt;-</span> <span class="fu">textstat_simil</span>(</span>
<span id="cb116-517"><a href="#cb116-517" aria-hidden="true" tabindex="-1"></a>  dfm_trim,</span>
<span id="cb116-518"><a href="#cb116-518" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> dfm_trim[ref_docs, ],</span>
<span id="cb116-519"><a href="#cb116-519" aria-hidden="true" tabindex="-1"></a>  <span class="at">margin =</span> <span class="st">"documents"</span>,</span>
<span id="cb116-520"><a href="#cb116-520" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"correlation"</span></span>
<span id="cb116-521"><a href="#cb116-521" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb116-522"><a href="#cb116-522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb116-523"><a href="#cb116-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(document2) <span class="sc">%&gt;%</span></span>
<span id="cb116-524"><a href="#cb116-524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(correlation), <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-525"><a href="#cb116-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-526"><a href="#cb116-526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb116-527"><a href="#cb116-527" aria-hidden="true" tabindex="-1"></a>    <span class="at">doc     =</span> document1,</span>
<span id="cb116-528"><a href="#cb116-528" aria-hidden="true" tabindex="-1"></a>    <span class="at">ref_doc =</span> document2</span>
<span id="cb116-529"><a href="#cb116-529" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb116-530"><a href="#cb116-530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb116-531"><a href="#cb116-531" aria-hidden="true" tabindex="-1"></a>    <span class="fu">docvars</span>(dfm_trim) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(doc, text),</span>
<span id="cb116-532"><a href="#cb116-532" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"doc"</span></span>
<span id="cb116-533"><a href="#cb116-533" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb116-534"><a href="#cb116-534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb116-535"><a href="#cb116-535" aria-hidden="true" tabindex="-1"></a>    sample_text <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">ref_doc =</span> doc_id, <span class="at">ref_text =</span> text),</span>
<span id="cb116-536"><a href="#cb116-536" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"ref_doc"</span></span>
<span id="cb116-537"><a href="#cb116-537" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-538"><a href="#cb116-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-539"><a href="#cb116-539" aria-hidden="true" tabindex="-1"></a>closest_cor <span class="sc">%&gt;%</span></span>
<span id="cb116-540"><a href="#cb116-540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ref_doc, ref_text, doc, text, correlation) <span class="sc">%&gt;%</span></span>
<span id="cb116-541"><a href="#cb116-541" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ref_doc, <span class="fu">desc</span>(correlation)) <span class="sc">%&gt;%</span></span>
<span id="cb116-542"><a href="#cb116-542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">30</span>)</span>
<span id="cb116-543"><a href="#cb116-543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-544"><a href="#cb116-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-545"><a href="#cb116-545" aria-hidden="true" tabindex="-1"></a>**thoughts and observations:**</span>
<span id="cb116-546"><a href="#cb116-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-547"><a href="#cb116-547" aria-hidden="true" tabindex="-1"></a>Method. I used textstat_simil on my DFM to find the top-10 nearest neighbors for three reference posts (text1, text2, text3) with cosine similarity, then repeated the same with correlation and compared the lists.</span>
<span id="cb116-548"><a href="#cb116-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-549"><a href="#cb116-549" aria-hidden="true" tabindex="-1"></a>Cosine – text2 (anniversary/thank-you). Scores are extremely high (two at ~0.910), and the neighbors look like near-duplicates with the same “Happy/blessed/thank you” phrasing. The rest (0.56–0.45) keep the same upbeat tone and vocabulary.</span>
<span id="cb116-550"><a href="#cb116-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-551"><a href="#cb116-551" aria-hidden="true" tabindex="-1"></a>Cosine – text3 (Hurricane Ian update). Neighbors cluster tightly (~0.63–0.58), all around storm updates and public-info language. Cosine clearly groups posts that share concrete, event-specific terms.</span>
<span id="cb116-552"><a href="#cb116-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-553"><a href="#cb116-553" aria-hidden="true" tabindex="-1"></a>Cosine – text1 (attack/critique). Scores are lower (~0.37–0.33) and neighbors are more mixed (generic “It’s/This…”, mentions). Less distinctive vocabulary makes it harder for cosine to find obviously “same-topic” matches.</span>
<span id="cb116-554"><a href="#cb116-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-555"><a href="#cb116-555" aria-hidden="true" tabindex="-1"></a>Cosine vs. correlation. The correlation lists are almost the same as cosine (very similar scores and neighbors for all three refs). With sparse, non-negative counts, both measures rank documents similarly.</span>
<span id="cb116-556"><a href="#cb116-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-557"><a href="#cb116-557" aria-hidden="true" tabindex="-1"></a>Takeaway. Cosine works well for near-duplicates and clearly topical posts; it’s less decisive for generic language. Correlation doesn’t add much beyond cosine here. If needed, TF-IDF or binary+Jaccard could sharpen neighbors for the generic case.</span>
<span id="cb116-558"><a href="#cb116-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-559"><a href="#cb116-559" aria-hidden="true" tabindex="-1"></a><span class="fu">### Question 6.2</span></span>
<span id="cb116-560"><a href="#cb116-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-561"><a href="#cb116-561" aria-hidden="true" tabindex="-1"></a>Now, check qualitative these documents. Take a look at the top features, keyword in Context, higher TF-IDF. Would you change anything in your dictionary now that you looked in these documents?</span>
<span id="cb116-562"><a href="#cb116-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-565"><a href="#cb116-565" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-566"><a href="#cb116-566" aria-hidden="true" tabindex="-1"></a><span class="co"># Top features (overall and by sentiment)</span></span>
<span id="cb116-567"><a href="#cb116-567" aria-hidden="true" tabindex="-1"></a>top_overall <span class="ot">&lt;-</span> <span class="fu">textstat_frequency</span>(dfm_trim, <span class="at">n =</span> <span class="dv">20</span>)</span>
<span id="cb116-568"><a href="#cb116-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-569"><a href="#cb116-569" aria-hidden="true" tabindex="-1"></a>groups_vec <span class="ot">&lt;-</span> sent_df<span class="sc">$</span>major_sentiment[<span class="fu">match</span>(<span class="fu">docnames</span>(dfm_trim), sent_df<span class="sc">$</span>doc_id)]</span>
<span id="cb116-570"><a href="#cb116-570" aria-hidden="true" tabindex="-1"></a>top_by_sent <span class="ot">&lt;-</span> <span class="fu">textstat_frequency</span>(dfm_trim, <span class="at">groups =</span> groups_vec, <span class="at">n =</span> <span class="dv">20</span>)</span>
<span id="cb116-571"><a href="#cb116-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-572"><a href="#cb116-572" aria-hidden="true" tabindex="-1"></a><span class="co"># High TF-IDF terms by sentiment </span></span>
<span id="cb116-573"><a href="#cb116-573" aria-hidden="true" tabindex="-1"></a>dfm_by        <span class="ot">&lt;-</span> <span class="fu">dfm_group</span>(dfm_trim, <span class="at">groups =</span> groups_vec)</span>
<span id="cb116-574"><a href="#cb116-574" aria-hidden="true" tabindex="-1"></a>dfm_tfidf_by  <span class="ot">&lt;-</span> <span class="fu">dfm_tfidf</span>(dfm_by)</span>
<span id="cb116-575"><a href="#cb116-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-576"><a href="#cb116-576" aria-hidden="true" tabindex="-1"></a>tfidf_top <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">docnames</span>(dfm_tfidf_by), <span class="cf">function</span>(g) {</span>
<span id="cb116-577"><a href="#cb116-577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb116-578"><a href="#cb116-578" aria-hidden="true" tabindex="-1"></a>    <span class="at">sentiment =</span> g,</span>
<span id="cb116-579"><a href="#cb116-579" aria-hidden="true" tabindex="-1"></a>    <span class="at">term  =</span> <span class="fu">featnames</span>(dfm_tfidf_by),</span>
<span id="cb116-580"><a href="#cb116-580" aria-hidden="true" tabindex="-1"></a>    <span class="at">tfidf =</span> <span class="fu">as.numeric</span>(dfm_tfidf_by[g, ])</span>
<span id="cb116-581"><a href="#cb116-581" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(tfidf)) <span class="sc">|&gt;</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">15</span>)</span>
<span id="cb116-582"><a href="#cb116-582" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>()</span>
<span id="cb116-583"><a href="#cb116-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-584"><a href="#cb116-584" aria-hidden="true" tabindex="-1"></a><span class="co"># Keywords-in-context </span></span>
<span id="cb116-585"><a href="#cb116-585" aria-hidden="true" tabindex="-1"></a>toks_lc <span class="ot">&lt;-</span> <span class="fu">tokens_tolower</span>(toks)</span>
<span id="cb116-586"><a href="#cb116-586" aria-hidden="true" tabindex="-1"></a>kw_terms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"inflation"</span>,<span class="st">"crime"</span>,<span class="st">"border"</span>,<span class="st">"abortion"</span>,<span class="st">"thank"</span>,<span class="st">"support"</span>,<span class="st">"hurricane"</span>)</span>
<span id="cb116-587"><a href="#cb116-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-588"><a href="#cb116-588" aria-hidden="true" tabindex="-1"></a>kwic_tbl <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(<span class="fu">lapply</span>(kw_terms, <span class="cf">function</span>(w) {</span>
<span id="cb116-589"><a href="#cb116-589" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">kwic</span>(toks_lc, <span class="at">pattern =</span> w, <span class="at">window =</span> <span class="dv">5</span>)</span>
<span id="cb116-590"><a href="#cb116-590" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(k) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(k) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="fu">as_tibble</span>(k) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">keyword =</span> w) <span class="cf">else</span> <span class="cn">NULL</span></span>
<span id="cb116-591"><a href="#cb116-591" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb116-592"><a href="#cb116-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-593"><a href="#cb116-593" aria-hidden="true" tabindex="-1"></a><span class="co"># have a look</span></span>
<span id="cb116-594"><a href="#cb116-594" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(top_overall)</span>
<span id="cb116-595"><a href="#cb116-595" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(top_by_sent)</span>
<span id="cb116-596"><a href="#cb116-596" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tfidf_top)</span>
<span id="cb116-597"><a href="#cb116-597" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(kwic_tbl)</span>
<span id="cb116-598"><a href="#cb116-598" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-599"><a href="#cb116-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-600"><a href="#cb116-600" aria-hidden="true" tabindex="-1"></a>**thoughts and observations:**</span>
<span id="cb116-601"><a href="#cb116-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-602"><a href="#cb116-602" aria-hidden="true" tabindex="-1"></a>Top features. The most frequent words split between campaign language (thank/thanks, happy, congrats, blessed) and issue/event terms (inflation, crime, border, hurricane). By sentiment, Positive is heavy on celebration/thanks; Negative leans on critique/alert vocabulary.</span>
<span id="cb116-603"><a href="#cb116-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-604"><a href="#cb116-604" aria-hidden="true" tabindex="-1"></a>KWIC. thank/thanks consistently express gratitude (clearly positive). inflation appears in complaint/critique contexts (clearly negative). hurricane shows urgent public-info updates—negative/alert tone, not hostile. support is mixed and context-dependent.</span>
<span id="cb116-605"><a href="#cb116-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-606"><a href="#cb116-606" aria-hidden="true" tabindex="-1"></a>TF-IDF. High TF-IDF surfaces distinctive tokens that define posts: celebration terms (anniversary, blessed, congrats), event words (hurricane, ian, update), and sharp critique markers (fraud, rumor, outage). These cleanly separate upbeat personal posts from alerts/attacks.</span>
<span id="cb116-607"><a href="#cb116-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-608"><a href="#cb116-608" aria-hidden="true" tabindex="-1"></a>Dictionary tweaks. Add to Positive: blessed, grateful, congrats, anniversary, appreciate, welcome. Add to Negative/Alert: shortage, outage, scam, rumor, fraud, disaster, emergency, evacuation. Treat support and generic campaign verbs as neutral/noise; consider multi-word phrases like “thank you” and “state of emergency.”</span>
<span id="cb116-609"><a href="#cb116-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-610"><a href="#cb116-610" aria-hidden="true" tabindex="-1"></a>After reading examples, I’d expand positive celebration/thanks terms, add an alert/disaster bucket on the negative side, and neutralize ambiguous words. This should make the dictionary match how the posts actually read.</span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>